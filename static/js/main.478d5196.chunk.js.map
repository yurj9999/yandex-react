{"version":3,"sources":["components/modal/modal-overlay/modal-overlay.module.css","pages/empty-page.module.css","pages/ingredients-constructor.module.css","components/app-header/app-header.module.css","components/profile-links/profile-links.module.css","components/burger/burger.module.css","pages/order-info.module.css","services/slices/ingredients.ts","services/slices/constructor.ts","services/slices/user.ts","services/slices/order-tape.ts","services/slices/my-orders.ts","services/slices/modal.ts","services/reducers/index.ts","services/constants.js","services/utils/cookie-helper.ts","services/utils/refresh-token-updater.ts","services/actions/index.ts","services/middlewares/socket-middleware.ts","services/utils/modified-react-hooks.ts","components/app-header/app-header.tsx","components/modal/modal-overlay/modal-overlay.tsx","components/modal/modal.tsx","images/close.png","components/ingredient-details/ingredient-details.tsx","components/order-details/order-details.tsx","components/protected-route/protected-route.tsx","pages/registration.tsx","pages/autorization.tsx","services/utils/recovery-pass.ts","pages/recovery-password.tsx","services/utils/reset-pass.ts","pages/reset-password.tsx","components/profile-links/profile-links.tsx","pages/user-profile.tsx","pages/empty-page-404.tsx","services/utils/get-burger-ingredients.ts","services/utils/get-burger-price.ts","services/utils/get-str-data-created.ts","services/utils/get-burger-status.ts","pages/order-info.tsx","components/burger/burger.tsx","components/order-total/order-total.tsx","services/utils/get-orders-statuses.ts","pages/order-tape.tsx","pages/order-history.tsx","components/burger-ingredients/product/product.tsx","components/burger-ingredients/product-group/product-group.tsx","components/burger-ingredients/burger-ingredients.tsx","components/burger-constructor/burger-filling/burger-filling.tsx","services/utils/get-order-details.ts","components/burger-constructor/confirm-button/confirm-button.tsx","components/burger-constructor/burger-constructor.tsx","pages/ingredients-constructor.tsx","components/app/app.tsx","reportWebVitals.ts","index.tsx","components/ingredient-details/ingredient-details.module.css","components/order-total/order-total.module.css","components/order-details/order-details.module.css","components/burger-constructor/burger-constructor.module.css","pages/order-tape.module.css","components/burger-ingredients/burger-ingredients.module.css","pages/order-history.module.css","pages/input-pages.module.css","components/burger-constructor/confirm-button/confirm-button.module.css","components/app/app.module.css","components/modal/modal.module.css","components/burger-ingredients/product/product.module.css","components/burger-ingredients/product-group/product-group.module.css","components/burger-constructor/burger-filling/burger-filling.module.css"],"names":["module","exports","slice","createSlice","name","initialState","blockedAll","error","ingredients","reducers","setAllIngredientsRequest","state","setAllIngredientsError","actions","payload","setAllIngredientsSuccess","reducer","bun","fillings","setBuns","setFillings","push","updateFillings","deleteIngredient","success","user","email","accessToken","refreshToken","isBlocked","isExit","setUserRequest","setUserError","action","setUserSuccess","setUserClear","setUpdatedTokens","orders","total","totalToday","setOrders","clearOrders","number","status","details","setStartInfo","setEndInfo","rootReducer","combineReducers","ingredientsReducer","constructorIngredients","constructorReducer","userReducer","orderTape","orderTapeReducer","myOrders","myOrdersReducer","modal","modalReducer","URL_UPDATE_USER","URL_UPDATE_TOKEN","getCookie","matches","document","cookie","match","RegExp","replace","decodeURIComponent","undefined","setCookie","value","options","path","expires","Date","toUTCString","updatedCookie","encodeURIComponent","optionKey","optionValue","deleteCookie","refreshTokenUpdater","dispatcher","a","fetch","method","headers","body","JSON","stringify","token","localStorage","getItem","request","ok","Error","json","data","setItem","WS_CONNECT_ORDER_TAPE","WS_DISCONNECT_ORDER_TAPE","WS_CONNECT_USER_ORDERS","WS_DISCONNECT_USER_ORDERS","updateUserData","newUserData","userActions","Headers","set","dispatch","message","setUserFromServer","exitUser","referrerPolicy","removeItem","setUser","userData","typeRequest","socketMiddleware","storeApi","wssAllOrders","wssMyOrders","next","type","WebSocket","url","onmessage","event","send","parse","close","useDispatch","dispatchHook","useSelector","selectorHook","AppHeader","className","appHeaderStyle","headerWrapper","wrapperMenu","flex","exact","to","isActive","location","pathname","indexOf","activeClassName","lightTextColor","feedLink","darkTextColor","logoWrapper","React","memo","ModalOverlay","children","history","useHistory","styles","main","onClick","goBack","getElementById","Modal","useEffect","addEventListener","closeModal","removeEventListener","ReactDOM","createPortal","stopPropagation","wrapper","src","alt","IngredientDetails","id","useParams","ingredient","store","find","item","_id","Object","keys","length","detailsStyle","title","image_large","image","infoWrapper","infoElement","calories","proteins","fat","carbohydrates","OrderDetails","orderStyle","vektorSecond","width","height","viewBox","fill","xmlns","fillRule","clipRule","d","fillOpacity","cx","cy","r","gradientUnits","gradientTransform","stopColor","stopOpacity","offset","vektorThird","vektorFirst","done","ProtectedRoute","protectType","useState","isTokenValid","routeType","routeData","setRouteData","protectedRoutes","nonAuthorized","render","from","authorized","then","result","catch","Registration","passRef","useRef","setName","setEmail","icon","passwordConfig","setPasswordConfig","logo","onSubmit","preventDefault","password","console","log","inputWrapper","placeholder","onChange","target","ref","onIconClick","button","size","footer","footerInfo","footerEnter","Autorization","useLocation","recoveryPass","RecoveryPassword","resetPass","ResetPassword","setToken","ProfileLinks","onExit","menuProfile","itemMenu","link","unchecked","checked","lastItemMenu","exitBtn","footerMenu","UserProfile","storeUserData","setUserData","mainProfileWrapper","profileWrapper","linksWrapper","inputsWrapper","buttonsWrapper","EmptyPage404","empty","getBurgerIngredients","ingredientIds","allIngedients","temp","forEach","count","filter","element","map","price","image_mobile","getBurgerPrice","allIngredients","reduce","prev","curr","getStrDataCreated","createdAt","checkForZeroes","timeCount","agoDate","daysAgo","nowDate","days","Math","round","getTime","lastDaySymbol","parseInt","toString","substr","getDaysInterval","hours","getHours","minutes","getMinutes","gmt","getTimezoneOffset","getBurgerStatus","OrderInfo","showOrders","urlParams","burger","setBurger","orderDetailsWrapper","ingredientWrapper","img","countCostWrapper","cost","footerText","countWrapper","Burger","needStatus","titleWrapper","titleTime","textWrapper","captionBurger","cancelled","inWork","burgerWrapper","ingredientsWrapper","index","imgWrapper","style","zIndex","right","ingredientCount","position","costWrapper","OrderTotal","statusNumbers","orderTotal","numbersWrapper","ready","itemsWrapper","readyColor","getOrdersStatuses","setMaxLength","dataArray","resultArray","i","OrderTape","mainWrapper","mainBlock","burgers","itemWrapper","OrderHistory","reverse","Product","counter","useMemo","useDrag","dragRef","data-qa","productStyle","nameIngredient","ProductGroup","ingredientType","productGroup","info","data-cy","btn","BurgerIngredients","tab","setTab","breadsGroup","saucesGroup","fillingsGroup","ingredientBlock","onTabClick","currentTab","scrollParameter","behavior","current","scrollIntoView","ingredientsStyle","data-testid","tabs","active","onScroll","parentTop","getBoundingClientRect","top","breadTop","saucesTop","breadPos","saucesPos","fillingsPos","menuWrapper","block","BurgerFilling","constructorActions","del","useCallback","moveCard","indexDrag","indexDrop","useDrop","accept","collect","monitor","isTarget","isOver","drop","dragIndex","hoverIndex","hoverBoundingRect","clientOffset","getClientOffset","hoverMiddleY","bottom","hoverClientY","y","dropRef","fillingStyle","fillingIngredient","handleClose","thumbnail","text","isLocked","getOrderDetails","iDs","ConfirmButton","buttonAvailible","setAvailible","openModal","window","order","spinner","loading","BurgerConstructor","totalCost","constructorStyle","DndProvider","backend","HTML5Backend","mainIngredientsWrapper","emptyWrapper","footerWrapper","summWrapper","summText","IngredientsConstructor","App","modalBackground","ingredientsActions","getIngredients","appStyle","appWrapper","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","configureStore","middleware","getDefaultMiddleware","concat","StrictMode"],"mappings":"uGACAA,EAAOC,QAAU,CAAC,KAAO,8B,oBCAzBD,EAAOC,QAAU,CAAC,MAAQ,4B,oBCA1BD,EAAOC,QAAU,CAAC,QAAU,2C,mBCA5BD,EAAOC,QAAU,CAAC,cAAgB,kCAAkC,YAAc,gCAAgC,KAAO,yBAAyB,cAAgB,kCAAkC,eAAiB,mCAAmC,YAAc,gCAAgC,SAAW,6BAA6B,WAAa,iC,mBCA3VD,EAAOC,QAAU,CAAC,YAAc,mCAAmC,SAAW,gCAAgC,WAAa,kCAAkC,aAAe,oCAAoC,KAAO,4BAA4B,UAAY,iCAAiC,QAAU,+BAA+B,QAAU,iC,mBCAnVD,EAAOC,QAAU,CAAC,QAAU,wBAAwB,aAAe,6BAA6B,UAAY,0BAA0B,YAAc,4BAA4B,cAAgB,8BAA8B,UAAY,0BAA0B,OAAS,uBAAuB,cAAgB,8BAA8B,IAAM,oBAAoB,YAAc,4BAA4B,KAAO,qBAAqB,mBAAqB,mCAAmC,gBAAkB,gCAAgC,WAAa,6B,mBCAziBD,EAAOC,QAAU,CAAC,QAAU,4BAA4B,MAAQ,0BAA0B,OAAS,2BAA2B,QAAU,4BAA4B,oBAAsB,wCAAwC,OAAS,2BAA2B,WAAa,+BAA+B,aAAe,iCAAiC,WAAa,+BAA+B,KAAO,yBAAyB,iBAAmB,qCAAqC,kBAAoB,sCAAsC,IAAM,0B,+LCUhiBC,EAAQC,YAAY,CACtBC,KAAM,cACNC,aAR+C,CAC/CC,YAAY,EACZC,MAAO,GACPC,YAAa,IAMbC,SAAU,CACNC,yBADM,SACmBC,GACrBA,EAAML,YAAa,GAEvBM,uBAJM,SAIiBD,EAAOE,GAC1BF,EAAMH,YAAc,GACpBG,EAAMJ,MAAQM,EAAQC,SAE1BC,yBARM,SAQmBJ,EAAOE,GAC5BF,EAAML,YAAa,EACnBK,EAAMH,YAAcK,EAAQC,YAK1BE,EAAoBd,EAApBc,QAASH,EAAWX,EAAXW,QCnBjBX,EAAQC,YAAY,CACtBC,KAAM,cACNC,aAP+C,CAC/CY,IAAK,GACLC,SAAU,IAMVT,SAAU,CACNU,QADM,SACER,EAAOE,GACXF,EAAMM,IAAMJ,EAAQC,SAExBM,YAJM,SAIMT,EAAOE,GACfF,EAAMO,SAASG,KAAKR,EAAQC,UAEhCQ,eAPM,SAOSX,EAAOE,GAClBF,EAAMO,SAAWL,EAAQC,SAE7BS,iBAVM,SAUWZ,EAAOE,GACpBF,EAAMO,SAAWL,EAAQC,YAKvBE,EAAoBd,EAApBc,QAASH,EAAWX,EAAXW,QCLjBX,EAAQC,YAAY,CACtBC,KAAM,OACNC,aAfiC,CACjCmB,SAAS,EACTC,KAAM,CACFC,MAAO,GACPtB,KAAM,IAEVuB,YAAa,GACbC,aAAc,GACdrB,MAAO,GACPsB,WAAW,EACXC,QAAQ,GAMRrB,SAAU,CACNsB,eADM,SACSpB,GACXA,EAAMkB,WAAY,EAClBlB,EAAMmB,QAAS,GAEnBE,aALM,SAKOrB,EAAOsB,GAChBtB,EAAMa,QAAUS,EAAOnB,QAAQU,QAC/Bb,EAAMJ,MAAQ0B,EAAOnB,QAAQP,MAC7BI,EAAMc,KAAKC,MAAQ,GACnBf,EAAMc,KAAKrB,KAAO,GAClBO,EAAMgB,YAAc,GACpBhB,EAAMiB,aAAe,GACrBjB,EAAMkB,WAAY,EAClBlB,EAAMmB,QAAS,GAEnBI,eAfM,SAeSvB,EAAOsB,GAClBtB,EAAMa,QAAUS,EAAOnB,QAAQU,QAC/Bb,EAAMc,KAAOQ,EAAOnB,QAAQW,KAC5Bd,EAAMgB,YAAcM,EAAOnB,QAAQa,YACnChB,EAAMiB,aAAeK,EAAOnB,QAAQc,aACpCjB,EAAMJ,MAAQ,GACdI,EAAMkB,WAAY,EAClBlB,EAAMmB,QAAS,GAEnBK,aAxBM,SAwBOxB,GACTA,EAAMa,SAAU,EAChBb,EAAMc,KAAKC,MAAQ,GACnBf,EAAMc,KAAKrB,KAAO,GAClBO,EAAMgB,YAAc,GACpBhB,EAAMiB,aAAe,GACrBjB,EAAMJ,MAAQ,GACdI,EAAMkB,WAAY,EAClBlB,EAAMmB,QAAS,GAEnBM,iBAlCM,SAkCWzB,EAAOsB,GACpBtB,EAAMgB,YAAcM,EAAOnB,QAAQa,gBAKjCX,EAAoBd,EAApBc,QAASH,EAAWX,EAAXW,QCxDjBX,EAAQC,YAAY,CACtBC,KAAM,aACNC,aAR6B,CAC7BgC,OAAQ,GACRC,MAAO,EACPC,WAAY,GAMZ9B,SAAU,CACN+B,UADM,SACI7B,EAAOsB,GACbtB,EAAM0B,OAASJ,EAAOnB,QAAQuB,OAC9B1B,EAAM2B,MAAQL,EAAOnB,QAAQwB,MAC7B3B,EAAM4B,WAAaN,EAAOnB,QAAQyB,YAEtCE,YANM,SAMM9B,GACRA,EAAM0B,OAAS,GACf1B,EAAM2B,MAAQ,EACd3B,EAAM4B,WAAa,MAKjBvB,EAAoBd,EAApBc,QCnBRd,GDmB4BA,EAAXW,QCnBTV,YAAY,CACtBC,KAAM,YACNC,aANiC,CACjCgC,OAAQ,IAMR5B,SAAU,CACN+B,UADM,SACI7B,EAAOsB,GACbtB,EAAM0B,OAASJ,EAAOnB,QAAQuB,QAElCI,YAJM,SAIM9B,GACRA,EAAM0B,OAAS,QAKbrB,EAAoBd,EAApBc,QCVRd,GDU4BA,EAAXW,QCVTV,YAAY,CACtBC,KAAM,QACNC,aAT8B,CAC9BqC,OAAQ,KACRtC,KAAM,KACNuC,OAAQ,GACRC,QAAS,IAMTnC,SAAU,CACNoC,aADM,SACOlC,GACTA,EAAM+B,OAAS,KACf/B,EAAMP,KAAO,sEACbO,EAAMgC,OAAS,0IACfhC,EAAMiC,QAAU,kPAEpBE,WAPM,SAOKnC,EAAOsB,GACdtB,EAAM+B,OAAST,EAAOnB,QAAQ4B,OAC9B/B,EAAMP,KAAO6B,EAAOnB,QAAQV,KAC5BO,EAAMgC,OAAS,gEACfhC,EAAMiC,QAAU,+GAKd5B,EAAoBd,EAApBc,QCtBD+B,GDsBqB7C,EAAXW,QCtBImC,YAAgB,CACvCxC,YAAayC,EACbC,uBAAwBC,EACxB1B,KAAM2B,EACNC,UAAWC,EACXC,SAAUC,EACVC,MAAOC,K,+BCREC,EAAkB,kDAClBC,EAAmB,mDCHnBC,EAAY,SAACzD,GACxB,IAAI0D,EAAUC,SAASC,OAAOC,MAAM,IAAIC,OACtC,WAAa9D,EAAK+D,QAAQ,+BAAgC,QAAU,aAGtE,OAAOL,EAAUM,mBAAmBN,EAAQ,SAAMO,GAGvCC,EAAY,SAAClE,EAAcmE,GAAoD,IAArCC,EAAoC,uDAAP,IAClFA,EAAO,aACLC,KAAM,KACHD,IAGOE,mBAAmBC,OAC7BH,EAAQE,QAAUF,EAAQE,QAAQE,eAGpC,IAAIC,EAAgBC,mBAAmB1E,GAAQ,IAAM0E,mBAAmBP,GAExE,IAAK,IAAIQ,KAAaP,EAAS,CAC7BK,GAAiB,KAAOE,EACxB,IAAIC,EAAcR,EAAQO,GACrBC,IACHH,GAAiB,IAAMG,GAI3BjB,SAASC,OAASa,GAGPI,EAAe,SAAC7E,GAC3BkE,EAAUlE,EAAM,GAAI,CAAEsE,SAAU,KC3BrBQ,EAAmB,uCAAG,WAAOC,EAAsBlD,GAA7B,iBAAAmD,EAAA,+EAELC,MAAMzB,EAAkB,CAC1C0B,OAAQ,OACRC,QAAS,CACL,eAAgB,kCAEpBC,KAAMC,KAAKC,UAAU,CAACC,MAAOC,aAAaC,QAAQ,0BAP3B,WAErBC,EAFqB,QAUdC,GAVc,sBAWjB,IAAIC,MAAM,uGAXO,uBAcCF,EAAQG,OAdT,cAcrBC,EAdqB,OAgB3B5B,EAAU,oBAAqB4B,EAAKvE,aACpCiE,aAAaO,QAAQ,qBAAsBD,EAAKtE,cAEhDuD,EAAWlD,EAAOiE,IAnBS,kBAqBpBA,GArBoB,wCAuBrB,IAAIF,MAvBiB,0DAAH,wDCenBI,EAAiD,wBACjDC,EAAuD,2BACvDC,EAAmD,yBACnDC,EAAyD,4BAkDzDC,EAA4B,SAA5BA,EAA6BC,EAAwBd,GAC9D,IAAO5D,EAAkE2E,EAAlE3E,eAAgBC,EAAkD0E,EAAlD1E,aAAcE,EAAoCwE,EAApCxE,eAAgBE,EAAoBsE,EAApBtE,iBAE/CmD,EAAU,IAAIoB,QAIpB,OAHApB,EAAQqB,IAAI,eAAgB,kCAC5BrB,EAAQqB,IAAI,gBAAiB/C,EAAU,sBAEvC,uCAAO,WAAOgD,GAAP,mBAAAzB,EAAA,sEAECyB,EAAS9E,KAFV,SAGuBsD,MAAM1B,EAAiB,CACzC2B,OAAQ,QACRC,UACAC,KAAMC,KAAKC,UAAUe,KAN1B,WAGOX,EAHP,QAScC,GATd,iCAUgCD,EAAQG,OAVxC,UAY2B,iBAFhB1F,EAVX,QAYeuG,QAZf,kCAae5B,EAAoB2B,EAAUzE,GAb7C,cAce,IAAI4D,MAAMzF,EAAMuG,SAd/B,cAgBe,IAAId,MAAM,wCAhBzB,yBAmBoBF,EAAQG,OAnB5B,QAmBOC,EAnBP,OAqBCW,EAAS3E,EAAe,2BACjBgE,GADgB,IAEnBvE,YAAagE,EACb/D,aAAcgE,aAAaC,QAAQ,0BAxBxC,qDA2BuB,gBAAlB,KAAMiB,QA3BX,kCA4BWN,EAAeC,EAAad,GA5BvC,gCA8BKkB,EAAS7E,EAAa,KAAM8E,UA9BjC,0DAAP,uDAoCSC,EAA+B,SAA/BA,IACT,IAAO7E,EAAkEwE,EAAlExE,eAAgBF,EAAkD0E,EAAlD1E,aAAcD,EAAoC2E,EAApC3E,eAAgBK,EAAoBsE,EAApBtE,iBAE/CmD,EAAU,IAAIoB,QAIpB,OAHApB,EAAQqB,IAAI,eAAgB,kCAC5BrB,EAAQqB,IAAI,gBAAiB/C,EAAU,sBAEvC,uCAAO,WAAOgD,GAAP,mBAAAzB,EAAA,sEAECyB,EAAS9E,KAFV,SAIuBsD,MAAM1B,EAAiB,CACzC2B,OAAQ,MACRC,YANL,WAIOO,EAJP,QAScC,GATd,iCAUyBD,EAAQG,OAVjC,UAY2B,iBAFhB1F,EAVX,QAYeuG,QAZf,wBAaS7B,EAAa,qBAbtB,UAceC,EAAoB2B,EAAUzE,GAd7C,cAee,IAAI4D,MAAMzF,EAAMuG,SAf/B,cAiBe,IAAId,MAAM,wCAjBzB,yBAqBoBF,EAAQG,OArB5B,QAqBOC,EArBP,OAuBCW,EAAS3E,EAAe,2BACjBgE,GADgB,IAEnBvE,YAAakC,EAAU,qBACvBjC,aAAcgE,aAAaC,QAAQ,0BA1BxC,qDA6BuB,gBAAlB,KAAMiB,QA7BX,kCA8BWC,IA9BX,uCAgCKF,EAAS7E,EAAa,KAAM8E,UAhCjC,kFAAP,uDAuCSE,EAAsB,SAACpF,GAChC,IAAOI,EAAgC0E,EAAhC1E,aAAcD,EAAkB2E,EAAlB3E,eAEfwD,EAAU,IAAIoB,QAGpB,OAFApB,EAAQqB,IAAI,eAAgB,oBAE5B,uCAAO,WAAOC,GAAP,SAAAzB,EAAA,6DACHyB,EAAS9E,KADN,kBAGuBsD,MH1KV,oDG0K0B,CAClCC,OAAQ,OACRC,UACA0B,eAAgB,cAChBzB,KAAMC,KAAKC,UAAU9D,KAP1B,iBAUcmE,GAVd,sBAWW,IAAIC,MAAM,uGAXrB,OAcCf,EAAa,qBACbW,aAAasB,WAAW,sBAfzB,yDAiBCL,EAAS7E,EAAa,KAAM8E,UAjB7B,kFAAP,uDAuBSK,EAAqB,SAACC,EAAkCC,GACjE,IAAOtF,EAAgD2E,EAAhD3E,eAAgBG,EAAgCwE,EAAhCxE,eAAgBF,EAAgB0E,EAAhB1E,aAEjCuD,EAAU,IAAIoB,QAGpB,OAFApB,EAAQqB,IAAI,eAAgB,oBAE5B,uCAAO,WAAOC,GAAP,iBAAAzB,EAAA,6DACHyB,EAAS9E,KADN,kBAGuBsD,MAAsB,iBAAhBgC,EH1MR,sDAEA,mDGwM8E,CAC9F/B,OAAQ,OACRC,UACA0B,eAAgB,cAChBzB,KAAMC,KAAKC,UAAU0B,KAP1B,WAGOtB,EAHP,QAUcC,GAVd,sBAWW,IAAIC,MAAM,uGAXrB,uBAaoBF,EAAQG,OAb5B,OAaOC,EAbP,OAeC5B,EAAU,oBAAqB4B,EAAKvE,aACpCiE,aAAaO,QAAQ,qBAAsBD,EAAKtE,cAEhDiF,EAAS3E,EAAegE,IAlBzB,yDAoBCW,EAAS7E,EAAa,KAAM8E,UApB7B,kFAAP,uDC9LSQ,EAA+C,SAAAC,GACxD,IAAIC,EAAiC,KACjCC,EAAgC,KAEpC,OAAO,SAAAC,GAAI,OAAI,SAACzF,GAAwB,IAAD,IAC5B4E,EAAYU,EAAZV,SAEP,OAAO5E,EAAO0F,MACV,KAAKvB,EACoB,OAAjBoB,IACAA,EAAe,IAAII,UAAU3F,EAAOnB,QAAQ+G,QAExCL,EAAaM,UAAY,SAAAC,GACO,IAAD,EAAR,SAAfA,EAAM7B,OACM,QAAZ,EAAAsB,SAAA,SAAcQ,KAAK,SAGvBnB,EAAS,CACLc,KAAM,uBACN7G,QAAS2E,KAAKwC,MAAMF,EAAM7B,UAK1C,MAEJ,KAAKG,EACW,QAAZ,EAAAmB,SAAA,SAAcU,QACdV,EAAe,KAEfX,EAAS,CACLc,KAAM,2BAEV,MAEJ,KAAKrB,EACmB,OAAhBmB,IACAA,EAAc,IAAIG,UAAU3F,EAAOnB,QAAQ+G,QAEvCJ,EAAYK,UAAY,SAAAC,GACQ,IAAD,EAAR,SAAfA,EAAM7B,OACK,QAAX,EAAAuB,SAAA,SAAaO,KAAK,SAGtBnB,EAAS,CACLc,KAAM,sBACN7G,QAAS2E,KAAKwC,MAAMF,EAAM7B,UAK1C,MAEJ,KAAKK,EACU,QAAX,EAAAkB,SAAA,SAAaS,QACbT,EAAc,KAEdZ,EAAS,CACLc,KAAM,0BAIlBD,EAAKzF,MCjEAkG,EAAc,kBAAMC,eACpBC,EAAgDC,I,uCCJvDC,EAAoB,WACtB,OACI,yBAAQC,UAAWC,IAAeC,cAAlC,UACI,sBAAKF,UAAWC,IAAeE,YAA/B,UACI,sBAAKH,UAAWC,IAAeG,KAA/B,UACI,sBAAKJ,UAAS,wBAAmBC,IAAeG,MAAhD,UACI,cAAC,aAAD,CAAYjB,KAAK,YACjB,cAAC,IAAD,CACIkB,OAAK,EAACC,GAAG,IACTC,SACI,SAAC9E,EAAO+E,GAAR,SAAwB/E,IAC6B,IAA9C+E,EAASC,SAASC,QAAQ,iBACoB,IAA9CF,EAASC,SAASC,QAAQ,iBAErCC,gBAAiBV,IAAeW,eAChCZ,UAAS,2CAAsCC,IAAeY,SAArD,YAAiEZ,IAAea,eAR7F,mFAYJ,sBAAKd,UAAS,wBAAmBC,IAAeG,MAAhD,UACI,cAAC,WAAD,CAAUjB,KAAK,YACf,cAAC,IAAD,CACIa,UAAS,2CAAsCC,IAAeY,SAArD,YAAiEZ,IAAea,eACzFH,gBAAiBV,IAAeW,eAChCN,GAAG,QAHP,6FAMR,sBAAKN,UAAS,wBAAmBC,IAAeG,MAAhD,UACI,cAAC,cAAD,CAAajB,KAAK,YAClB,cAAC,IAAD,CACIa,UAAS,2CAAsCC,IAAeY,SAArD,YAAiEZ,IAAea,eACzFH,gBAAiBV,IAAeW,eAChCN,GAAG,WAHP,mGAMR,qBAAKN,UAAWC,IAAec,YAA/B,SACI,cAAC,OAAD,UAMDC,OAAMC,KAAKlB,G,qBCtCbmB,GAAkC,SAAC,GAA8B,IAA7BC,EAA4B,EAA5BA,SACvCC,EAAUC,cAIhB,OACI,qBAAKrB,UAAWsB,KAAOC,KAAMC,QAHb,kBAAMJ,EAAQK,UAG9B,SACKN,K,oBCRPlG,GAAQM,SAASmG,eAAe,SAMzBC,GAAoB,SAAC,GAA8B,IAA7BR,EAA4B,EAA5BA,SACzBC,EAAUC,cAEhBO,qBAAU,WAEN,OADArG,SAASsG,iBAAiB,UAAWC,GAC9B,kBAAMvG,SAASwG,oBAAoB,UAAWD,OAGzD,IAEMA,EAAa,kBAAMV,EAAQK,UAEjC,OAAOO,IAASC,aAER,cAAC,GAAD,UACI,qBAAKjC,UAAWsB,KAAOC,KAAMC,QAPpB,SAACjC,GAAD,OAA2CA,EAAM2C,mBAO1D,SACI,sBAAKlC,UAAWsB,KAAOa,QAAvB,UACKhB,EACD,qBAAKiB,ICjCd,6bDiC0BpC,UAAWsB,KAAO5B,MAAO2C,IAAI,QAAQb,QAASM,WAI5E7G,K,oBE3BEqH,GAA4B,WACrC,IAAOC,EAAMC,cAAND,GAGDE,EADgB5C,GAAY,SAAA6C,GAAK,OAAIA,EAAM1K,eAA1CA,YACwB2K,MAAK,SAAAC,GAAI,OAAIA,EAAKC,MAAQN,KAEzD,OACIE,GAAcK,OAAOC,KAAKN,GAAYO,OAClC,sBAAKhD,UAAWiD,KAAad,QAA7B,UACI,mBAAGnC,UAAS,oCAA+BiD,KAAaC,OAAxD,qHACA,sBAAKlD,UAAWiD,KAAa1B,KAA7B,UACI,qBAAKc,IAAI,MAAMD,IAAKK,EAAWU,YAAanD,UAAS,eAAUiD,KAAaG,SAC5E,qBAAKpD,UAAS,qCAAgCiD,KAAarL,MAA3D,SAAoE6K,EAAW7K,OAC/E,qBAAKoI,UAAS,sCAAiCiD,KAAa7I,SAA5D,qqBACA,sBAAK4F,UAAWiD,KAAaI,YAA7B,UACI,sBAAKrD,UAAWiD,KAAaK,YAA7B,UACI,mBAAGtD,UAAU,8BAAb,kFACA,mBAAGA,UAAU,qCAAb,SAAmDyC,EAAWc,cAElE,sBAAKvD,UAAWiD,KAAaK,YAA7B,UACI,mBAAGtD,UAAU,8BAAb,oDACA,mBAAGA,UAAU,qCAAb,SAAmDyC,EAAWe,cAElE,sBAAKxD,UAAWiD,KAAaK,YAA7B,UACI,mBAAGtD,UAAU,8BAAb,8CACA,mBAAGA,UAAU,qCAAb,SAAmDyC,EAAWgB,SAElE,sBAAKzD,UAAWiD,KAAaK,YAA7B,UACI,mBAAGtD,UAAU,8BAAb,sEACA,mBAAGA,UAAU,qCAAb,SAAmDyC,EAAWiB,4BAK9E,M,oBCtCCC,GAAuB,WAChC,MAAwC9D,GAAY,SAAA6C,GAAK,OAAIA,EAAMzH,SAA5Df,EAAP,EAAOA,OAAQtC,EAAf,EAAeA,KAAMuC,EAArB,EAAqBA,OAAQC,EAA7B,EAA6BA,QAE7B,OACI,sBAAK4F,UAAW4D,KAAWzB,QAA3B,UACI,mBAAGnC,UAAS,2CAAsC4D,KAAW1J,QAA7D,SAAwEA,IACxE,mBAAG8F,UAAS,qCAAgC4D,KAAWV,OAAvD,SAAiEtL,IACjE,sBAAKoI,UAAW4D,KAAWR,MAA3B,UACI,qBAAKpD,UAAW4D,KAAWC,aAA3B,SACI,sBAAKC,MAAM,MAAMC,OAAO,MAAMC,QAAQ,cAAcC,KAAK,OAAOC,MAAM,6BAAtE,UACI,sBAAMC,SAAS,UAAUC,SAAS,UAAUC,EAAE,6VAA6VJ,KAAK,sBAAsBK,YAAY,SAClb,+BACI,iCAAgB/B,GAAG,gBAAgBgC,GAAG,IAAIC,GAAG,IAAIC,EAAE,IAAIC,cAAc,iBAAiBC,kBAAkB,6DAAxG,UACI,sBAAMC,UAAU,UAAUC,YAAY,MACtC,sBAAMC,OAAO,IAAIF,UAAU,sBAK3C,qBAAK5E,UAAW4D,KAAWmB,YAA3B,SACI,sBAAKjB,MAAM,KAAKC,OAAO,MAAMC,QAAQ,aAAaC,KAAK,OAAOC,MAAM,6BAApE,UACI,sBAAMC,SAAS,UAAUC,SAAS,UAAUC,EAAE,gUAAgUJ,KAAK,sBAAsBK,YAAY,SACrZ,+BACI,iCAAgB/B,GAAG,gBAAgBgC,GAAG,IAAIC,GAAG,IAAIC,EAAE,IAAIC,cAAc,iBAAiBC,kBAAkB,2DAAxG,UACI,sBAAMC,UAAU,UAAUC,YAAY,MACtC,sBAAMC,OAAO,IAAIF,UAAU,sBAK3C,qBAAK5E,UAAW4D,KAAWoB,YAA3B,SACI,sBAAKlB,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,MAAM,6BAAlE,UACI,sBAAMC,SAAS,UAAUC,SAAS,UAAUC,EAAE,mVAAmVJ,KAAK,sBAAsBK,YAAY,SACxa,+BACI,iCAAgB/B,GAAG,gBAAgBgC,GAAG,IAAIC,GAAG,IAAIC,EAAE,IAAIC,cAAc,iBAAiBC,kBAAkB,+DAAxG,UACI,sBAAMC,UAAU,UAAUC,YAAY,MACtC,sBAAMC,OAAO,IAAIF,UAAU,UAAUC,YAAY,kBAKjE,qBAAK7E,UAAW4D,KAAWqB,KAA3B,SACI,qBAAKnB,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,MAAM,6BAAlE,SACI,sBAAMC,SAAS,UAAUC,SAAS,UAAUC,EAAE,6XAA6XJ,KAAK,mBAI5b,mBAAGjE,UAAU,mCAAb,SAAiD7F,IACjD,mBAAG6F,UAAS,sCAAiC4D,KAAWxJ,SAAxD,SAAoEA,Q,QCnCnE8K,GAAsC,SAAC,GAAwD,IAAvD/D,EAAsD,EAAtDA,SAAUlF,EAA4C,EAA5CA,KAAMkJ,EAAsC,EAAtCA,YAC3D9G,EAAWsB,cAEV/F,EAAoBsE,EAApBtE,iBACDR,EAAegE,aAAaC,QAAQ,sBAE1C,EAAkC+H,mBAAS,CACvCC,cAAc,EACdC,UAAW,SAFf,oBAAOC,EAAP,KAAkBC,EAAlB,KAKOH,EAA2BE,EAA3BF,aAAcC,EAAaC,EAAbD,UAEfG,EAA2B,CAC7BC,cAAe,cAAC,IAAD,CAAOzJ,KAAMA,EAAM0J,OAC9B,gBAAEnF,EAAF,EAAEA,SAAF,OAAiB6E,GAAgBjM,EAAgB+H,EAAW,cAAC,IAAD,CAAUb,GAClE,CACIG,SAAU,SACVtI,MAAO,CACHyN,KAAMpF,SAMtBqF,WAAY,cAAC,IAAD,CAAO5J,KAAMA,EAAM0J,OAC3B,kBAAON,GAAgBjM,EAAgB,cAAC,IAAD,CAAUkH,GAAG,MAAQa,MAkBpE,OAdAS,qBAAU,WACY,SAAd0D,GACA5I,EAAoB2B,EAAUzE,GACzBkM,MAAK,SAAAC,GAAM,OAAIP,EAAa,CACzBH,aAAcU,EAAO/M,QACrBsM,UAAWH,OAEda,OAAM,kBAAMR,EAAa,CACtBH,cAAc,EACdC,UAAWH,SAGxB,CAAC9G,EAAUzE,EAAkBuL,EAAaG,IAExB,SAAdA,EAAuB,KAAOG,EAAgBN,I,mBChD5Cc,I,MAAuB,WAChC,IAAM5H,EAAWsB,cACXyB,EAAUC,cAEV6E,EAAUC,iBAAO,MAEvB,EAAwBf,mBAAS,IAAjC,oBAAOxN,EAAP,KAAawO,EAAb,KACA,EAA0BhB,mBAAS,IAAnC,oBAAOlM,EAAP,KAAcmN,EAAd,KAEA,EAA4CjB,mBAAyB,CACjEjG,KAAM,WACNpD,MAAO,GACPuK,KAAM,aAHV,oBAAOC,EAAP,KAAuBC,EAAvB,KA6BA,OACI,sBAAKxG,UAAWsB,KAAOa,QAAvB,UACI,qBAAKnC,UAAWsB,KAAOmF,KAAvB,SACI,cAAC,OAAD,MAEJ,mBAAGzG,UAAS,qCAAgCsB,KAAO4B,OAAnD,gFAEA,uBAAMwD,SAtBY,SAACnH,GACvBA,EAAMoH,iBAELtI,EAASM,EAAQ,CACd/G,OACAsB,QACA0N,SAAUL,EAAexK,OAC1B,iBACE+J,MAAK,SAAAC,GACF,GAAIA,aAAkBvI,MAAO,MAAM,IAAIA,MACvC4D,EAAQzF,QAAQ,CAAC8E,SAAU,SAE9BuF,OAAM,SAAAjO,GAAK,OAAI8O,QAAQC,IAAI/O,OAU5B,UACI,qBAAKiI,UAAWsB,KAAOyF,aAAvB,SACI,cAAC,QAAD,CACI5H,KAAM,OACN6H,YAAa,qBACbjL,MAAOnE,EACPqP,SAAU,SAAA1H,GAAK,OAAI6G,EAAQ7G,EAAM2H,OAAOnL,YAGhD,qBAAKiE,UAAWsB,KAAOyF,aAAvB,SACI,cAAC,QAAD,CACI5H,KAAM,QACN6H,YAAa,SACbjL,MAAO7C,EACP+N,SAAU,SAAA1H,GAAK,OAAI8G,EAAS9G,EAAM2H,OAAOnL,YAEjD,qBAAKiE,UAAWsB,KAAOyF,aAAvB,SACI,cAAC,QAAD,CACI5H,KAAMoH,EAAepH,KACrB6H,YAAa,uCACbjL,MAAOwK,EAAexK,MACtBkL,SAAU,SAAA1H,GAAK,OAAIiH,EAAkB,2BAC9BD,GAD6B,IAEhCxK,MAAOwD,EAAM2H,OAAOnL,UAExBuK,KAAMC,EAAeD,KACrBa,IAAKjB,EACLkB,YAzDD,WACfZ,EAAkB,2BACXD,GADU,IAEbpH,KAA8B,aAAxBoH,EAAepH,KAAsB,OAAS,WACpDmH,KAA8B,aAAxBC,EAAeD,KAAsB,WAAa,mBAwDpD,qBAAKtG,UAAWsB,KAAO+F,OAAvB,SACI,cAAC,SAAD,CAAQlI,KAAK,UAAUmI,KAAK,QAA5B,+HAKR,sBAAKtH,UAAWsB,KAAOiG,OAAvB,UACI,mBAAGvH,UAAS,sCAAiCsB,KAAOkG,YAApD,kIACA,cAAC,IAAD,CAAMlH,GAAG,SAASN,UAAS,2CAAsCsB,KAAOmG,aAAxE,oDC7EHC,GAAuB,WAChC,IAAMrJ,EAAWsB,IACXyB,EAAUC,cACVb,EAAWmH,cAEXzB,EAAUC,iBAAO,MAEvB,EAA0Bf,mBAAS,IAAnC,oBAAOlM,EAAP,KAAcmN,EAAd,KAEA,EAA4CjB,mBAAyB,CACjEjG,KAAM,WACNpD,MAAO,GACPuK,KAAM,aAHV,oBAAOC,EAAP,KAAuBC,EAAvB,KAiCA,OACI,sBAAKxG,UAAWsB,KAAOa,QAAvB,UACI,qBAAKnC,UAAWsB,KAAOmF,KAAvB,SACI,cAAC,OAAD,MAEJ,mBAAGzG,UAAS,qCAAgCsB,KAAO4B,OAAnD,sCAEA,uBAAMwD,SA1BE,SAACnH,GACbA,EAAMoH,iBAELtI,EAASM,EAAQ,CACdzF,QACA0N,SAAUL,EAAexK,OAC1B,kBACE+J,MAAK,SAAAC,GAAW,IAAD,MACZ,GAAIA,aAAkBvI,MAAO,MAAM,IAAIA,MAEA,kBAAnC,UAAAgD,EAASrI,aAAT,mBAAgByN,YAAhB,eAAsBnF,WAAkD,QAAnBW,EAAQ3H,SAAoB,UAAC+G,EAASrI,aAAV,aAAC,EAAgByN,MAGlGxE,EAAQvI,KAAK2H,EAASrI,MAAMyN,KAAKnF,UAFjCW,EAAQvI,KAAK,QAKpBmN,OAAM,SAAAjO,GAAK,OAAI8O,QAAQC,IAAI/O,OAU5B,UACI,qBAAKiI,UAAWsB,KAAOyF,aAAvB,SACI,cAAC,QAAD,CACI5H,KAAM,QACN6H,YAAa,SACbjL,MAAO7C,EACP+N,SAAU,SAAA1H,GAAK,OAAI8G,EAAS9G,EAAM2H,OAAOnL,YAEjD,qBAAKiE,UAAWsB,KAAOyF,aAAvB,SACI,cAAC,QAAD,CACI5H,KAAMoH,EAAepH,KACrB6H,YAAa,uCACbjL,MAAOwK,EAAexK,MACtBkL,SAAU,SAAA1H,GAAK,OAAIiH,EAAkB,2BAC9BD,GAD6B,IAEhCxK,MAAOwD,EAAM2H,OAAOnL,UAExBuK,KAAMC,EAAeD,KACrBa,IAAKjB,EACLkB,YArDD,WACfZ,EAAkB,2BACXD,GADU,IAEbpH,KAA8B,aAAxBoH,EAAepH,KAAsB,OAAS,WACpDmH,KAA8B,aAAxBC,EAAeD,KAAsB,WAAa,mBAoDpD,qBAAKtG,UAAWsB,KAAO+F,OAAvB,SACI,cAAC,SAAD,CAAQlI,KAAK,UAAUmI,KAAK,QAA5B,iDAIR,sBAAKtH,UAAS,eAAUsB,KAAOiG,QAA/B,UACI,mBAAGvH,UAAS,sCAAiCsB,KAAOkG,YAApD,0IACA,cAAC,IAAD,CAAMlH,GAAG,YAAYN,UAAS,2CAAsCsB,KAAOmG,aAA3E,6HAGJ,sBAAKzH,UAAWsB,KAAOiG,OAAvB,UACI,mBAAGvH,UAAS,sCAAiCsB,KAAOkG,YAApD,wFACA,cAAC,IAAD,CAAMlH,GAAG,mBAAmBN,UAAS,2CAAsCsB,KAAOmG,aAAlF,kICtGHG,GAAY,uCAAG,WAAO1O,GAAP,SAAA0D,EAAA,+EAEEC,MfFO,uDeEsB,CAC/CC,OAAQ,OACRC,QAAS,CACL,eAAgB,oBAEpBC,KAAMC,KAAKC,UAAU,CACjBhE,YARY,iBAYPqE,GAZO,sBAaV,IAAIC,MAAM,uGAbA,8DAgBpBqJ,QAAQC,IAAI,KAAMxI,SAhBE,iFAAH,sDCUZuJ,GAA2B,WACpC,IAAMzG,EAAUC,cAEhB,EAA0B+D,mBAAS,IAAnC,oBAAOlM,EAAP,KAAcmN,EAAd,KAgBA,OACI,sBAAKrG,UAAWsB,KAAOa,QAAvB,UACI,qBAAKnC,UAAWsB,KAAOmF,KAAvB,SACI,cAAC,OAAD,MAEJ,mBAAGzG,UAAS,qCAAgCsB,KAAO4B,OAAnD,uIAEA,uBAAMwD,SArBU,SAACnH,GACrBA,EAAMoH,iBAEFzN,GACA0O,GAAa1O,GACR4M,MAAK,SAAAC,GACF,GAAIA,aAAkBvI,MAAO,MAAM,IAAIA,MACvCJ,aAAaO,QAAQ,qBAAsB,SAC3CyD,EAAQzF,QAAQ,CAAC8E,SAAU,uBAE9BuF,OAAM,SAAAjO,GAAK,OAAI8O,QAAQC,IAAI/O,OAWhC,UACI,qBAAKiI,UAAWsB,KAAOyF,aAAvB,SACI,cAAC,QAAD,CACI5H,KAAM,QACN6H,YAAa,SACbjL,MAAO7C,EACP+N,SAAU,SAAA1H,GAAK,OAAI8G,EAAS9G,EAAM2H,OAAOnL,YAGjD,qBAAKiE,UAAWsB,KAAO+F,OAAvB,SACI,cAAC,SAAD,CAAQlI,KAAK,UAAUmI,KAAK,QAA5B,2FAIR,sBAAKtH,UAAWsB,KAAOiG,OAAvB,UACI,mBAAGvH,UAAS,sCAAiCsB,KAAOkG,YAApD,0GACA,cAAC,IAAD,CAAMlH,GAAG,SAASN,UAAS,2CAAsCsB,KAAOmG,aAAxE,mDC7CHK,GAAqB,uCAAG,+BAAAlL,EAAA,6DAAQgK,EAAR,EAAQA,SAAUzJ,EAAlB,EAAkBA,MAAlB,kBAEPN,MjBPI,6DiBOsB,CAC5CC,OAAQ,OACRC,QAAS,CACL,eAAgB,oBAEpBC,KAAMC,KAAKC,UAAU,CACjB0J,WACAzJ,YATqB,iBAahBI,GAbgB,sBAcnB,IAAIC,MAAM,uGAdS,8DAiB7BqJ,QAAQC,IAAI,KAAMxI,SAjBW,iFAAH,sDCMrByJ,GAAwB,WACjC,IAAM7B,EAAUC,iBAAO,MAEjB/E,EAAUC,cAEhB,EAA0B+D,mBAAS,IAAnC,oBAAOjI,EAAP,KAAc6K,EAAd,KAEA,EAA4C5C,mBAAyB,CACjEjG,KAAM,WACNpD,MAAO,GACPuK,KAAM,aAHV,oBAAOC,EAAP,KAAuBC,EAAvB,KAmCA,OAJA5E,qBAAU,WACN,OAAO,kBAAMxE,aAAaO,QAAQ,qBAAsB,OACzD,IAGCP,aAAaC,QAAQ,sBAChB,sBAAK2C,UAAWsB,KAAOa,QAAvB,UACG,qBAAKnC,UAAWsB,KAAOmF,KAAvB,SACI,cAAC,OAAD,MAEJ,mBAAGzG,UAAS,qCAAgCsB,KAAO4B,OAAnD,uIAEA,uBAAMwD,SA7BH,SAACnH,GACZA,EAAMoH,iBAEFJ,EAAexK,OAASoB,GACxB2K,GAAU,CACNlB,SAAUL,EAAexK,MACzBoB,UAEC2I,MAAK,SAAAC,GACF,GAAIA,aAAkBvI,MAAO,MAAM,IAAIA,MACvCJ,aAAaO,QAAQ,qBAAsB,IAC3CyD,EAAQzF,QAAQ,CAAC8E,SAAU,cAE9BuF,OAAM,SAAAjO,GAAK,OAAI8O,QAAQC,IAAI/O,OAgB5B,UACI,qBAAKiI,UAAWsB,KAAOyF,aAAvB,SACI,cAAC,QAAD,CACI5H,KAAMoH,EAAepH,KACrB6H,YAAa,iHACbjL,MAAOwK,EAAexK,MACtBkL,SAAU,SAAA1H,GAAK,OAAIiH,EAAkB,2BAC9BD,GAD6B,IAEhCxK,MAAOwD,EAAM2H,OAAOnL,UAExBuK,KAAMC,EAAeD,KACrBa,IAAKjB,EACLkB,YAjDL,WACfZ,EAAkB,2BACXD,GADU,IAEbpH,KAA8B,aAAxBoH,EAAepH,KAAsB,OAAS,WACpDmH,KAA8B,aAAxBC,EAAeD,KAAsB,WAAa,mBAgDhD,qBAAKtG,UAAWsB,KAAOyF,aAAvB,SACI,cAAC,QAAD,CACI5H,KAAM,OACN6H,YAAa,kHACbjL,MAAOoB,EACP8J,SAAU,SAAA1H,GAAK,OAAIyI,EAASzI,EAAM2H,OAAOnL,YAGjD,qBAAKiE,UAAWsB,KAAO+F,OAAvB,SACI,cAAC,SAAD,CAAQlI,KAAK,UAAUmI,KAAK,QAA5B,yEAIR,sBAAKtH,UAAWsB,KAAOiG,OAAvB,UACI,mBAAGvH,UAAS,sCAAiCsB,KAAOkG,YAApD,0GACA,cAAC,IAAD,CAAMlH,GAAG,SAASN,UAAS,2CAAsCsB,KAAOmG,aAAxE,kDAGV,cAAC,IAAD,CAAUnH,GAAG,Y,oBCvFV2H,GAAuB,WAChC,IAAOtO,EAAgBuE,EAAhBvE,aAED0E,EAAWsB,IACXyB,EAAUC,cAEV6G,EAAM,uCAAG,sBAAAtL,EAAA,sEACLyB,EAASG,EAAS,CACpBrB,MAAOC,aAAaC,QAAQ,yBAFrB,OAKX+D,EAAQzF,QAAQ,CAAC8E,SAAU,WAC3BpC,EAAS1E,KANE,2CAAH,qDASZ,OACI,sBAAKqG,UAAWsB,KAAO6G,YAAvB,UACI,qBAAKnI,UAAWsB,KAAO8G,SAAvB,SACI,cAAC,IAAD,CAAS/H,OAAK,EAACC,GAAG,WACdN,UAAS,qCAAgCsB,KAAO+G,KAAvC,YAA+C/G,KAAOgH,WAC/D3H,gBAAiBW,KAAOiH,QAF5B,0DAKJ,qBAAKvI,UAAWsB,KAAO8G,SAAvB,SACI,cAAC,IAAD,CAAS/H,OAAK,EAACC,GAAG,kBACdN,UAAS,qCAAgCsB,KAAO+G,KAAvC,YAA+C/G,KAAOgH,WAC/D3H,gBAAiBW,KAAOiH,QAF5B,qGAKJ,qBAAKvI,UAAS,UAAKsB,KAAO8G,SAAZ,YAAwB9G,KAAOkH,cAA7C,SACI,qBAAKhH,QAAS0G,EAAQlI,UAAS,qCAAgCsB,KAAO+G,KAAvC,YAA+C/G,KAAOmH,QAAtD,YAAiEnH,KAAOgH,WAAvG,8CAGJ,mBAAGtI,UAAS,sCAAiCsB,KAAOoH,YAApD,sUC9BCC,GAAsB,WAC/B,IAAMtK,EAAWsB,IACXiJ,EAAgB/I,GAAY,SAAA6C,GAAK,OAAIA,EAAMzJ,QAEjD,EAAgCmM,mBAAS,CACrCxN,KAAM,GACNsB,MAAO,GACP0N,SAAU,KAHd,oBAAOhI,EAAP,KAAiBiK,EAAjB,KA8BA,OAZAjH,qBAAU,WACDgH,EAAc3P,KAAKrB,MAASgR,EAActP,OAG3CuP,EAAY,CACRjR,KAAMgR,EAAc3P,KAAKrB,KACzBsB,MAAO0P,EAAc3P,KAAKC,MAC1B0N,SAAU,KALdvI,EAASE,OAQd,CAACF,EAAUuK,EAAc3P,KAAKrB,KAAMgR,EAAc3P,KAAKC,MAAO0P,EAActP,SAG3E,qBAAK0G,UAAWsB,KAAOwH,mBAAvB,SACI,sBAAK9I,UAAWsB,KAAOyH,eAAvB,UACI,qBAAK/I,UAAWsB,KAAO0H,aAAvB,SACI,cAAC,GAAD,MAGJ,sBAAMtC,SA/BH,SAACnH,GACZA,EAAMoH,iBAENtI,EAASL,EAAe,eAAIY,MA4BpB,SACI,sBAAKoB,UAAWsB,KAAO2H,cAAvB,UACI,qBAAKjJ,UAAWsB,KAAOyF,aAAvB,SACI,cAAC,QAAD,CACIT,KAAM,WACNnH,KAAM,OACN6H,YAAa,qBACbjL,MAAO6C,EAAShH,KAChBqP,SACI,SAAC1H,GAAD,OAAWsJ,EAAY,2BAChBjK,GADe,IAElBhH,KAAM2H,EAAM2H,OAAOnL,cAKnC,qBAAKiE,UAAWsB,KAAOyF,aAAvB,SACI,cAAC,QAAD,CACIT,KAAM,WACNnH,KAAM,OACN6H,YAAa,iCACbjL,MAAO6C,EAAS1F,MAChB+N,SACI,SAAC1H,GAAD,OAAWsJ,EAAY,2BAChBjK,GADe,IAElB1F,MAAOqG,EAAM2H,OAAOnL,cAKpC,qBAAKiE,UAAWsB,KAAOyF,aAAvB,SACI,cAAC,QAAD,CACIT,KAAM,WACNnH,KAAMP,EAASgI,SAAW,WAAa,OACvCI,YAAa,uCACbjL,MAAO6C,EAASgI,SAChBK,SACI,SAAC1H,GAAD,OAAWsJ,EAAY,2BAChBjK,GADe,IAElBgI,SAAUrH,EAAM2H,OAAOnL,cAKvC,sBAAKiE,UAAWsB,KAAO4H,eAAvB,UACI,cAAC,SAAD,CAAQ/J,KAAK,UAAUmI,KAAK,QAA5B,oEACA,cAAC,SAAD,CAAQnI,KAAK,UAAUmI,KAAK,QAAQ9F,QAvE3C,kBAAMqH,EAAY,CAC/BjR,KAAMgR,EAAc3P,KAAKrB,KACzBsB,MAAO0P,EAAc3P,KAAKC,MAC1B0N,SAAU,MAoEU,4E,qBCjGfuC,GAAuB,WAChC,OACI,mBAAGnJ,UAAS,oCAA+BsB,KAAO8H,OAAlD,kBCOKC,GAAuB,SAACC,EAAyBC,GAC1D,IAAMC,EAAgB,GAatB,OAXAF,EAAcG,SAAQ,SAAA7G,GAClB,IAAM8G,EAAQJ,EAAcK,QAAO,SAAAC,GAAO,OAAIA,IAAYhH,KAAMI,OAE3DwG,EAAK7G,MAAK,SAAAF,GAAU,OAAc,OAAVA,QAAU,IAAVA,OAAA,EAAAA,EAAYF,MAAOK,MAC5C4G,EAAK3Q,KAAK,CACN0J,GAAIK,EACJ8G,aAKLF,EAAKK,KAAI,SAAAjH,GACZ,MAAoC2G,EAAc5G,MAAK,SAAAF,GAAU,OAAIA,EAAWI,MAAQD,EAAKL,MAAtF3K,EAAP,EAAOA,KAAMkS,EAAb,EAAaA,MAAOC,EAApB,EAAoBA,aAEpB,OAAO,2BACAnH,GADP,IAEIhL,OACAkS,QACAC,qBChCCC,GAAiB,SAACV,EAAyBW,GAEpD,OADcX,EAAcO,KAAI,SAAAtH,GAAE,aAAW,OAAPA,EAAA,UAAc0H,EAAetH,MAAK,SAAAC,GAAI,OAAIA,EAAKC,MAAQN,YAAvD,aAAc,EAA8CuH,MAAQ,QAC/EI,QAAO,SAACC,EAAMC,GAAP,OAAgBD,EAAOC,IAAM,ICKtDC,GAAoB,SAACC,GAC9B,IAAMC,EAAiB,SAACC,GAAD,OAAuBA,ExBOb,GwBPa,WAAwCA,GAAcA,GAuB9FC,EAAU,IAAItO,KAAKmO,GAEnBI,EAvBkB,SAACC,EAAiBF,GACtC,IAAMG,EAAOC,KAAKC,OAAOH,EAAU,IAAIxO,KAAKsO,GAASM,WxBD1B,OwBErBC,EAAgBC,SAASL,EAAKM,WAAWC,OAAOP,EAAKM,WAAWlI,OAAS,EAAG,IAElF,OAAa,IAAT4H,EACO,6CACAA,GxBHQ,IwBGeA,ExBFd,IwBKZI,GxBPS,EwBKP,GAAN,OAAUJ,EAAV,4DAKII,EAAgB,GAAKA,ExBVZ,EwBWH,GAAN,OAAUJ,EAAV,sDAEkB,IAAlBI,EACM,GAAN,OAAUJ,EAAV,iEADJ,EAQQQ,EAAgB,IAAIjP,MAAO4O,UAAWN,GAChDY,EAAQd,EAAeE,EAAQa,YAC/BC,EAAUhB,EAAeE,EAAQe,cACjCC,EAAG,eAAWhB,EAAQiB,oBxB3BD,IwB6B3B,MAAM,GAAN,OAAUhB,EAAV,YAAqBW,EAArB,YAA8BE,EAA9B,YAAyCE,ICxChCE,GAAkB,SAACxR,GAC5B,OAAOA,GACH,IAAK,UACD,MAAO,uCAEX,IAAK,UACD,MAAO,yDAEX,QACI,MAAO,qD,oBCqBNyR,GAA4B,SAAC,GAAuC,IAAtCC,EAAqC,EAArCA,WACjCC,EAAYtJ,cACZnE,EAAWsB,IAEjB,EAA4ByF,mBAA4B,MAAxD,oBAAO2G,EAAP,KAAeC,EAAf,KAEOhU,EAAe6H,GAAY,SAAA6C,GAAK,OAAIA,EAAM1K,eAA1CA,YACDmB,EAAc0G,GAAY,SAAA6C,GAAK,OAAIA,EAAMzJ,KAAKE,eAE9CU,EAASgG,GAAY,SAAA6C,GAAK,MAAmB,QAAfmJ,EAAuBnJ,EAAM7H,UAAUhB,OAAS6I,EAAM3H,SAASlB,UAyCnG,OAvCA+H,qBAAU,WACN,GAAK/H,EAAOmJ,OAyBRgJ,EACInS,EAAO8I,MAAK,SAAAoJ,GAAM,OACdA,EAAOlJ,MAAQiJ,EAAUvJ,GAAG4I,O1BjDJ,E0BiDyCW,EAAUvJ,GAAGS,OAAS,YA1B/F,OAAO6I,GACH,IAAK,MACDxN,EAAS,CACLc,KAAMvB,EACNtF,QAAS,CACL+G,IAAK,gDAGb,MAEJ,IAAK,KAIGhB,EAHClF,EAGQ,CACLgG,KAAMrB,EACNxF,QAAS,CACL+G,IAAI,gDAAD,OAAmDhE,EAAU,qBAAgC8P,OAAO,MALtG5M,QAiB1B,CACCF,EACAxE,EACAV,EACA0S,EACAC,EAAUvJ,KAIVwJ,EACI,sBAAK/L,UAAWsB,KAAOa,QAAvB,UACI,qBAAKnC,UAAWsB,KAAO4B,MAAvB,SACI,mBAAGlD,UAAU,gCAAb,oBAAkD+L,EAAO7R,YAE7D,mBAAG8F,UAAU,kCAAb,SAAgD+L,EAAOnU,OACvD,mBAAGoI,UAAS,sCAAiCsB,KAAOnH,QAApD,SAA+DwR,GAAgBI,EAAO5R,UACtF,mBAAG6F,UAAS,qCAAgCsB,KAAOlH,SAAnD,mDACA,qBAAK4F,UAAWsB,KAAO2K,oBAAvB,SAEQ5C,GAAqB0C,EAAO/T,YAAaA,GAAa6R,KAAI,SAAAjH,GAAI,OAC1D,sBAAmB5C,UAAWsB,KAAOmB,WAArC,UACI,sBAAKzC,UAAWsB,KAAO4K,kBAAvB,UACI,qBAAK7J,IAAI,aAAaD,IAAKQ,EAAKmH,aAAc/J,UAAWsB,KAAO6K,MAChE,mBAAGnM,UAAU,8BAAb,SAA4C4C,EAAKhL,UAErD,sBAAKoI,UAAWsB,KAAO8K,iBAAvB,UACI,oBAAGpM,UAAS,wCAAmCsB,KAAO+K,MAAtD,UAA+DzJ,EAAK8G,MAApE,MAA8E9G,EAAKkH,SACnF,cAAC,eAAD,CAAc3K,KAAK,iBAPjByD,EAAKL,SAc3B,sBAAKvC,UAAWsB,KAAOiG,OAAvB,UACI,mBAAGvH,UAAS,sCAAiCsB,KAAOgL,YAApD,SAAmEjC,GAAkB0B,EAAOzB,aAC5F,sBAAKtK,UAAWsB,KAAOiL,aAAvB,UACI,mBAAGvM,UAAS,wCAAmCsB,KAAO+K,MAAtD,SAA+DrC,GAAe+B,EAAO/T,YAAaA,KAClG,cAAC,eAAD,CAAcmH,KAAK,qBAI/B,M,oBC1FCqN,GAAsB,SAAC,GAA8C,IAA7C9O,EAA4C,EAA5CA,KAA4C,IAAtC+O,kBAAsC,SACtEnC,EAAmC5M,EAAnC4M,UAAW1S,EAAwB8F,EAAxB9F,KAAMsC,EAAkBwD,EAAlBxD,OAAQC,EAAUuD,EAAVvD,OACzBnC,EAAe6H,GAAY,SAAA6C,GAAK,OAAIA,EAAM1K,eAA1CA,YAEP,OACI,sBAAKgI,UAAWsB,KAAOa,QAAvB,UACI,sBAAKnC,UAAWsB,KAAOoL,aAAvB,UACI,mBAAG1M,UAAU,gCAAb,oBAAkD9F,KAClD,mBAAG8F,UAAS,sCAAiCsB,KAAOqL,WAApD,SAAkEtC,GAAkBC,QAGxF,sBAAKtK,UAAWsB,KAAOsL,YAAvB,UACI,mBAAG5M,UAAS,qCAAgCsB,KAAOuL,eAAnD,SAAqEjV,IAEjE6U,EACM,mBAAGzM,UAAS,sCAA4C,YAAX7F,GAAwBmH,KAAOwL,UAAhE,YAAwF,SAAX3S,GAAqBmH,KAAOyL,QAArH,SAAgIpB,GAAgBxR,KAChJ,QAId,sBAAK6F,UAAWsB,KAAO0L,cAAvB,UACI,qBAAKhN,UAAWsB,KAAO2L,mBAAvB,SAEQvP,EAAK1F,YAAY6R,KAAI,SAACtH,EAAI2K,GACtB,OAAW,OAAP3K,GACI2K,E3B/BG,EALC,I2BqCAA,EAEI,sBAAclN,UAAWsB,KAAO6L,WAAYC,MAAO,CAC/CC,OAAQ3P,EAAK1F,YAAYgL,OAASkK,EAClCI,MAAM,GAAD,O3BnCZ,G2BmC6CJ,EAAjC,OAFT,UAII,qBAAKlN,UAAWsB,KAAOiM,gBAAvB,SACI,oBAAGvN,UAAU,8BAAb,cACMtC,EAAK1F,YAAYgL,OAASkK,OAGpC,qBAAK7K,IAAI,aAAarC,UAAWsB,KAAO6K,IAAKiB,MAAO,CAChDI,SAAU,YACXpL,IAAMpK,EAAY2K,MAAK,SAAAC,GAAI,OAAIA,EAAKC,MAAQN,KAAoBwH,iBAX7DxH,GAgBV,qBAAKF,IAAI,aAA8BrC,UAAWsB,KAAO6K,IAAKiB,MAAO,CACjEC,OAAQ3P,EAAK1F,YAAYgL,OAASkK,EAClCI,MAAM,GAAD,OAAe,IAAVJ,EAAc,E3BnD/B,G2BmD+DA,EAAnD,OACN9K,IAAMpK,EAAY2K,MAAK,SAAAC,GAAI,OAAIA,EAAKC,MAAQN,KAAoBwH,cAHxCxH,EAAK2K,GAUrC,UAMvB,sBAAKlN,UAAWsB,KAAOmM,YAAvB,UACI,mBAAGzN,UAAS,wCAAmCsB,KAAO+K,MAAtD,SAA+DrC,GAAetM,EAAK1F,YAAaA,KAChG,cAAC,eAAD,CAAcmH,KAAK,sB,oBC1E1BuO,GAA8B,SAAC,GAAsD,IAArDC,EAAoD,EAApDA,cAAe7T,EAAqC,EAArCA,MAAOC,EAA8B,EAA9BA,WACxDkL,EAAgB0I,EAAhB1I,KAAM8H,EAAUY,EAAVZ,OAEb,OACI,sBAAK/M,UAAWsB,KAAOsM,WAAvB,UACI,sBAAK5N,UAAWsB,KAAOuM,eAAvB,UACI,gCACI,mBAAG7N,UAAS,qCAAgCsB,KAAOwM,OAAnD,mDACA,qBAAK9N,UAAWsB,KAAOyM,aAAvB,SAEQ9I,EAAK4E,KAAI,SAAAjH,GAAI,OACT,mBAAc5C,UAAS,wCAAmCsB,KAAOsB,KAA1C,YAAkDtB,KAAO0M,YAAhF,SACKpL,GADGA,WAOxB,gCACI,mBAAG5C,UAAS,qCAAgCsB,KAAOwM,OAAnD,0DACA,qBAAK9N,UAAWsB,KAAOyM,aAAvB,SAEQhB,EAAOlD,KAAI,SAAAjH,GAAI,OACX,mBAAc5C,UAAS,wCAAmCsB,KAAOsB,MAAjE,SACKA,GADGA,cAS5B,mBAAG5C,UAAU,6BAAb,oIACA,mBAAGA,UAAS,sCAAiCsB,KAAOoI,OAApD,SAA8D5P,IAE9D,mBAAGkG,UAAU,6BAAb,6HACA,mBAAGA,UAAS,sCAAiCsB,KAAOoI,OAApD,SAA8D3P,QC9C7DkU,GAAoB,SAACpU,GAC9B,IAAMkM,EAAS,CACXd,KAAM,GACN8H,OAAQ,IAGN9H,EAAOpL,EAAO8P,QAAO,SAAA/G,GAAI,MAAoB,SAAhBA,EAAKzI,UAClC4S,EAASlT,EAAO8P,QAAO,SAAA/G,GAAI,MAAoB,YAAhBA,EAAKzI,UAEpC+T,EAAe,SAACC,EAAyBC,GAC3C,GAAID,EAAUnL,OAAS,GACnB,IAAK,IAAIqL,EAAI,EAAGA,EAAI,GAAIA,IACpBD,EAAYvV,KAAKsV,EAAUE,GAAGnU,aAGlC,IAAK,IAAImU,EAAI,EAAGA,IAAMF,EAAUnL,OAAQqL,IACpCD,EAAYvV,KAAKsV,EAAUE,GAAGnU,SAQ1C,OAHAgU,EAAajJ,EAAMc,EAAOd,MAC1BiJ,EAAanB,EAAQhH,EAAOgH,QAErBhH,G,oBCbEuI,GAAoB,WAC7B,IAAM9N,EAAWmH,cACXtJ,EAAWsB,IAEjB,EAAoCE,GAAY,SAAA6C,GAAK,OAAIA,EAAM7H,aAAxDhB,EAAP,EAAOA,OAAQC,EAAf,EAAeA,MAAOC,EAAtB,EAAsBA,WAiBtB,OAfA6H,qBAAU,WAQN,OAPAvD,EAAS,CACLc,KAAMvB,EACNtF,QAAS,CACL+G,IAAK,gDAIN,WACHhB,EAAS,CACLc,KAAMtB,OAGf,CAACQ,IAGA,qBAAK2B,UAAWsB,KAAOiN,YAAvB,SACI,qBAAKvO,UAAWsB,KAAOa,QAAvB,SAEQtI,EAAOmJ,OACH,qCACI,mBAAGhD,UAAS,oCAA+BsB,KAAO4B,OAAlD,uFACA,sBAAKlD,UAAWsB,KAAOkN,UAAvB,UACI,qBAAKxO,UAAWsB,KAAOmN,QAAvB,SAEQ5U,EAAOgQ,KAAI,SAACjH,EAAMsK,GACd,OACI,cAAC,IAAD,CAAkBlN,UAAWsB,KAAO+G,KAAM/H,GAAI,CAC1CG,SAAS,WAAD,OAAamC,EAAKC,KAC1B1K,MAAO,CACH8C,MAAOuF,IAHf,SAMI,qBAAKR,UAAWsB,KAAOoN,YAAvB,SACI,cAAC,GAAD,CAAQhR,KAAMkF,OAPXsK,QAc3B,cAAC,GAAD,CAAYS,cAAeM,GAAkBpU,GAASC,MAAOA,EAAOC,WAAYA,UAGxF,U,6BClDX4U,GAAe,WACxB,IAAMnO,EAAWmH,cACXtJ,EAAWsB,IAEXxG,EAAc0G,GAAY,SAAA6C,GAAK,OAAIA,EAAMzJ,KAAKE,eAC9CU,EAASgG,GAAY,SAAA6C,GAAK,OAAIA,EAAM3H,SAASlB,UAuBnD,OArBA+H,qBAAU,WAIFvD,EAHClF,EAGQ,CACLgG,KAAMrB,EACNxF,QAAS,CACL+G,IAAI,gDAAD,OAAmDhE,EAAU,qBAAgC8P,OAAO,MALtG5M,OASd,CAACF,EAAUlF,IAEdyI,qBAAU,WACN,OAAO,WACHvD,EAAS,CACLc,KAAMpB,OAGf,CAACM,IAGA,qBAAK2B,UAAWsB,KAAOiN,YAAvB,SACI,sBAAKvO,UAAWsB,KAAOa,QAAvB,UACI,qBAAKnC,UAAWsB,KAAO0H,aAAvB,SACI,cAAC,GAAD,MAGJ,qBAAKhJ,UAAWsB,KAAOmN,QAAvB,SAEQ,aAAI5U,GAAQ+U,UAAU/E,KAAI,SAAAjH,GAAI,OAC1B,cAAC,IAAD,CAAM5C,UAAWsB,KAAO+G,KAAqB/H,GAAI,CAC7CG,SAAS,qBAAD,OAAuBmC,EAAKC,KACpC1K,MAAO,CACH8C,MAAOuF,IAHf,SAMI,qBAAKR,UAAWsB,KAAOoN,YAAvB,SACI,cAAC,GAAD,CAAQhR,KAAMkF,EAAM6J,YAAY,OAPL7J,EAAKC,gB,iDCDrDgM,GAlCe,SAAC,GAA0B,IAAzBnR,EAAwB,EAAxBA,KAC5B,EAAwBmC,GAAY,SAAA6C,GAAK,OAAIA,EAAMhI,0BAA5CjC,EAAP,EAAOA,IAAKC,EAAZ,EAAYA,SAENoW,EAAUC,mBAAQ,WACpB,MAAI,QAAStW,GAAOA,EAAIoK,MAAQnF,EAAKmF,IhCVf,EgCYfnK,EAASiR,QAAO,SAAAC,GAAO,OAAIA,EAAQ/G,MAAQnF,EAAKmF,OAAKG,SAC7D,CAACvK,EAAKC,EAAUgF,EAAKmF,MAExB,EAAoBmM,aAAQ,CACxB7P,KAAMzB,EAAKyB,KACXyD,KAAM,CACFL,GAAI7E,EAAKmF,IACT1D,KAAMzB,EAAKyB,QAJV8P,EAAT,qBAQA,OACI,qCACI,sBAAKC,UAAQ,oBAAoB/H,IAAK8H,EAASjP,UAAWmP,KAAa1M,WAAvE,UACI,qBAAKJ,IAAI,aAAarC,UAAU,OAAOoC,IAAK1E,EAAK0F,QACjD,sBAAKpD,UAAWmP,KAAa1B,YAA7B,UACI,mBAAGzN,UAAU,0CAAb,SAAwDtC,EAAKoM,QAC7D,cAAC,eAAD,CAAc3K,KAAK,eAEvB,mBAAGa,UAAS,sCAAiCmP,KAAaC,gBAA1D,SAA6E1R,EAAK9F,UAGlFkX,EAAU,cAAC,UAAD,CAASpF,MAAOoF,EAASxH,KAAK,YAAc,S,oBC/BhE+H,GAAkC,SAAC,GAAoC,IAAnCC,EAAkC,EAAlCA,eAC/BtX,EAAe6H,GAAY,SAAA1H,GAAK,OAAIA,EAAMH,eAA1CA,YAEDwI,EAAWmH,cAEjB,OACI,oBAAI3H,UAAS,8BAAyBuP,KAAaC,MAAnD,SAEQxX,EAAY6R,KAAI,SAAAjH,GAAI,OAAIA,EAAKzD,OAASmQ,GAE9B,oBAAIG,UAAQ,aAA4BzP,UAAWuP,KAAarD,kBAAhE,SACI,cAAC,IAAD,CAAM5L,GAAI,CACNG,SAAS,gBAAD,OAAkBmC,EAAKC,KAC/B1K,MAAO,CACH8C,MAAOuF,IAEZR,UAAWuP,KAAaG,IAL3B,SAMI,cAAC,GAAD,CAAShS,KAAMkF,OAPOA,EAAKC,WAiB5C7B,OAAMC,KAAKoO,I,oBC9BpBM,GAA4B,WAC9B,MAAsBvK,mBAAS,UAA/B,oBAAOwK,EAAP,KAAYC,EAAZ,KAEMC,EAAc3J,iBAAuB,MACrC4J,EAAc5J,iBAAuB,MACrC6J,EAAgB7J,iBAAuB,MACvC8J,EAAkB9J,iBAAuB,MAEzC+J,EAAa,SAACC,GAChB,IAAMC,EAAyC,CAC3CC,SAAU,UAKd,OAFAR,EAAOM,GAEAA,GACH,IAAK,SACuB,OAAxBL,EAAYQ,SAAoBR,EAAYQ,QAAQC,eAAeH,GACnE,MACJ,IAAK,SACuB,OAAxBL,EAAYO,SAAoBP,EAAYO,QAAQC,eAAeH,GACnE,MACJ,QAC8B,OAA1BJ,EAAcM,SAAoBN,EAAcM,QAAQC,eAAeH,KA4BnF,OACI,0BAASpQ,UAAWwQ,KAAiBrO,QAArC,UACI,mBAAGnC,UAAS,oCAA+BwQ,KAAiBtN,OAA5D,mGACA,sBAAKuN,cAAY,OAAOzQ,UAAWwQ,KAAiBE,KAApD,UACI,cAAC,MAAD,CAAK3U,MAAM,SAAS4U,OAAgB,WAARf,EAAkBpO,QAAS,kBAAM0O,EAAW,WAAxE,4CACA,cAAC,MAAD,CAAKnU,MAAM,SAAS4U,OAAgB,WAARf,EAAkBpO,QAAS,kBAAM0O,EAAW,WAAxE,4CACA,cAAC,MAAD,CAAKnU,MAAM,WAAW4U,OAAgB,aAARf,EAAoBpO,QAAS,kBAAM0O,EAAW,aAA5E,2DAEJ,sBAAKT,UAAQ,mBAAmBtI,IAAK8I,EAAiBW,SA/B1C,WAChB,IAAMC,EAAgD,OAA5BZ,EAAgBK,QAAmBL,EAAgBK,QAAQQ,wBAAwBC,IAAM,EAC7GC,EAA2C,OAAxBlB,EAAYQ,QAAmBR,EAAYQ,QAAQQ,wBAAwBC,IAAM,EACpGE,EAA4C,OAAxBlB,EAAYO,QAAmBP,EAAYO,QAAQQ,wBAAwBC,IAAM,EAGrGG,EAAmBF,EAAWH,EAC9BM,EAAoBF,EAAYJ,EAChCO,GAJgD,OAA1BpB,EAAcM,QAAmBN,EAAcM,QAAQQ,wBAAwBC,IAAM,GAIvEF,EAEtCK,ElC1BmB,KkC0BWA,GlC3BZ,GkC4BlBrB,EAAO,UAGPsB,ElC9BmB,KkC8BYF,GlC/Bb,GkCgClBpB,EAAO,UAGPuB,ElClCmB,KkCkCcA,GlCnCf,GkCoClBvB,EAAO,aAYsE7P,UAAWwQ,KAAiBa,YAAzG,UACI,sBAAK5B,UAAQ,OAAOtI,IAAK2I,EAAa9P,UAAWwQ,KAAiBc,MAAlE,UACI,mBAAGtR,UAAU,6BAAb,4CACA,cAAC,GAAD,CAAcsP,eAAe,WAEjC,sBAAKG,UAAQ,SAAStI,IAAK4I,EAAa/P,UAAWwQ,KAAiBc,MAApE,UACI,mBAAGtR,UAAU,6BAAb,4CACA,cAAC,GAAD,CAAcsP,eAAe,aAEjC,sBAAKG,UAAQ,WAAWtI,IAAK6I,EAAehQ,UAAWwQ,KAAiBc,MAAxE,UACI,mBAAGtR,UAAU,6BAAb,wDACA,cAAC,GAAD,CAAcsP,eAAe,mBAOlCtO,OAAMC,KAAK0O,I,8BCCX4B,GAnE2B,SAAC,GAAoC,IAAnCrE,EAAkC,EAAlCA,MAAOtD,EAA2B,EAA3BA,QACzCvL,EAAWsB,IAEV5G,EAAoCyY,EAApCzY,iBAAkBD,EAAkB0Y,EAAlB1Y,eAElBJ,EAAYmH,GAAY,SAAA6C,GAAK,OAAIA,EAAMhI,0BAAvChC,SAEDyO,EAAMhB,iBAAuB,MAE7BsL,EAAMC,uBAAY,SAACxE,GAAD,OAAW7O,EAAStF,EAAiBL,EAASiR,QAAO,SAAC/G,EAAM1I,GAAP,OAAkBA,IAAWgT,SAAU,CAAC7O,EAAU3F,EAAUK,IAEnI4Y,EAAWD,uBAAY,cAA+B,IAA7BE,EAA4B,EAA5BA,UAAaC,EAAe,EAAfA,UAClCrI,EAAI,aAAO9Q,GAEjB8Q,EAAKoI,GAAalZ,EAASiK,MAAK,SAACC,EAAMsK,GAAP,OAAiBA,IAAU2E,KAC3DrI,EAAKqI,GAAanZ,EAASiK,MAAK,SAACC,EAAMsK,GAAP,OAAiBA,IAAU0E,KAE3DvT,EAASvF,EAAe0Q,MACzB,CAACnL,EAAU3F,EAAUI,IAExB,EAAoBkW,aAAQ,CACxB7P,KAAM,WACNyD,KAAM,CACFgP,UAAW1E,KAHV+B,EAAT,qBAOA,EAA8B6C,aAAQ,CAClCC,OAAQ,WACRC,QAAS,SAAAC,GAAO,MAAK,CACjBC,SAAUD,EAAQE,WAEtBC,KALkC,SAK7BxP,EAAaqP,GAAU,IAAD,EACjBI,EAAYzP,EAAKgP,UACjBU,EAAapF,EACbqF,EAAiB,UAAGpL,EAAImJ,eAAP,aAAG,EAAaQ,wBACjC0B,EAAeP,EAAQQ,kBACvBC,EAAeH,GAAsBA,EAAkBI,OAASJ,EAAkBxB,IAClF6B,EAAeJ,GAAgBD,GAAsBC,EAAaK,EAAIN,EAAkBxB,KAEzF5J,EAAImJ,SAAW+B,IAAcC,GAC7BD,EAAYC,GAAcM,IAAiBF,GACvCL,EAAYC,GAAcM,IAAiBF,GAIpDf,EAAS/O,EAAM,CACXiP,UAAW3E,OApBvB,oBAAQgF,EAAR,KAAQA,SA2BR,OAFAjD,GAAQ6D,EAzBR,MAyBgB3L,IAGZ,sBAAKA,IAAKA,EAAKnH,UAAS,eAAU+S,KAAaC,kBAAvB,YAA4Cd,GAAYa,KAAa7L,QAA7F,UACI,cAAC,qBAAD,CACI+L,YAAa,kBAAMxB,EAAIvE,IACvBgG,UAAWtJ,EAAQG,aACnBoJ,KAAMvJ,EAAQhS,KACdkS,MAAOF,EAAQE,MACfsJ,UAAU,IACd,cAAC,WAAD,CAAUjU,KAAK,gBC9EdkU,GAAe,uCAAG,WAAOC,GAAP,uBAAA1W,EAAA,6DACrBG,EAAU,IAAIoB,SACZC,IAAI,eAAgB,oBAC5BrB,EAAQqB,IAAI,gBAAiB/C,EAAU,sBAHZ,kBAMDwB,MpCVL,+CoCUsB,CACnCC,OAAQ,OACRC,UACAC,KAAMC,KAAKC,UAAU,CACnBlF,YAAasb,MAVI,WAMjBhW,EANiB,QAcVC,GAdU,kCAeQD,EAAQG,OAfhB,cAeb1F,EAfa,OAgBb,IAAIyF,MAAMzF,EAAMuG,SAhBH,yBAmBVhB,EAAQG,OAnBE,8EAqBD,gBAAlB,KAAMa,QArBa,wBAsBnB7B,EAAa,qBAtBM,oBAyBOI,MAAMzB,EAAkB,CAC1C0B,OAAQ,OACRC,QAAS,CACL,eAAgB,kCAEpBC,KAAMC,KAAKC,UAAU,CAACC,MAAOC,aAAaC,QAAQ,0BA9BvC,YAyBTC,EAzBS,QAiCFC,GAjCE,uBAkCL,IAAIC,MAAM,uGAlCL,yBAqCIF,EAAQG,OArCZ,eAqCTC,EArCS,OAuCf5B,EAAU,oBAAqB4B,EAAKvE,aACpCiE,aAAaO,QAAQ,qBAAsBD,EAAKtE,cAxCjC,UA0CFia,GAAgBC,GA1Cd,4EA4CfzM,QAAQC,IAAI,KAAMxI,SA5CH,iIAAH,sD,oBCQfiV,GAAwB,WACjC,IAAM/S,EAAWmH,cACXvG,EAAUC,cACVhD,EAAWsB,IAEjB,EAAwBE,GAAY,SAAA6C,GAAK,OAAIA,EAAMhI,0BAA5CjC,EAAP,EAAOA,IAAKC,EAAZ,EAAYA,SAEZ,EAAwC0M,mBAAS,CAC7C+N,KAAM,kFACN9Z,WAAW,IAFf,oBAAOma,EAAP,KAAwBC,EAAxB,KAKMC,EAAYhC,sBAAW,sBAAC,8BAAA9U,EAAA,0DACtBkG,OAAOC,KAAKtK,GAAKuK,OADK,wBAEtB,UAAI3H,EAAU,4BAAd,aAAI,EAAgC2H,SAChCyQ,EAAa,CACTN,KAAM,4EACN9Z,WAAW,IAInBgF,EAAS,CACLc,KAAM,uBAGViC,EAAQvI,KAAK,CACT4H,SAAU,eACVtI,MAAO,CACH8C,MAAOuF,KAhBO,kBAqBoB6S,GAAgB,CACjD5a,EAAoBoK,KAD4B,oBAE9CnK,EAASmR,KAAI,SAAAjH,GAAI,OAAIA,EAAKC,QAFoB,CAGhDpK,EAAoBoK,OAxBP,aAqBZD,EArBY,kBA2BEpF,OA3BF,uBA4BR,IAAIA,MA5BI,QA+Be,iBAA7BmW,OAAOnT,SAASC,SAChBpC,EAAS,CACLc,KAAM,mBACN7G,QAAS,CACL4B,OAAM,OAAE0I,QAAF,IAAEA,OAAF,EAAEA,EAAMgR,MAAM1Z,OACpBtC,KAAI,OAAEgL,QAAF,IAAEA,OAAF,EAAEA,EAAMhL,QAGgB,MAA7B+b,OAAOnT,SAASC,WACvBpC,EAAS,CACLc,KAAM,mBACN7G,QAAS,CACL4B,OAAM,OAAE0I,QAAF,IAAEA,OAAF,EAAEA,EAAMgR,MAAM1Z,OACpBtC,KAAI,OAAEgL,QAAF,IAAEA,OAAF,EAAEA,EAAMhL,QAIpBwJ,EAAQvI,KAAK,CACT4H,SAAU,eACVtI,MAAO,CACH8C,MAAOuF,MAKnBiT,EAAa,CACTN,KAAM,kFACN9Z,WAAW,IA1DG,kDA6DlBwN,QAAQC,IAAR,MA7DkB,0DAgE3B,CAACrO,EAAKC,EAAU0I,EAASZ,EAAUnC,IAOtC,OALAuD,qBAAU,kBAAM,kBAAM6R,EAAa,CAC/BN,KAAM,kFACN9Z,WAAW,OACX,IAGA,mCACI,cAAC,SAAD,CACImI,QAAUgS,EAAgBna,UAAwB,aAAZqa,EACtCvU,KAAK,UACLmI,KAAK,QAHT,SAKakM,EAAgBna,UACb,gCACI,uBAAM2G,UAAWsB,KAAOuS,QAAxB,UACI,sBAAM7T,UAAWsB,KAAOqR,SACxB,sBAAM3S,UAAWsB,KAAOyP,SAE5B,sBAAM/Q,UAAWsB,KAAOwS,QAAxB,SAAkCN,EAAgBL,UAN7BK,EAAgBL,U,oBC5E/DY,I,OAA4B,WAC9B,IAAM1V,EAAWsB,IAEVhH,EAAwB6Y,EAAxB7Y,QAASC,EAAe4Y,EAAf5Y,YAETd,EAAc+H,GAAY,SAAA6C,GAAK,OAAIA,EAAM1K,eAAzCF,WACP,EAAwB+H,GAAY,SAAA6C,GAAK,OAAIA,EAAMhI,0BAA5CjC,EAAP,EAAOA,IAAKC,EAAZ,EAAYA,SACLV,EAAe6H,GAAY,SAAA6C,GAAK,OAAIA,EAAM1K,eAA1CA,YAEDgc,EAAYjF,mBAAQ,WACtB,IAAMhJ,EAAmB,GAQzB,MANI,UAAWtN,GACXsN,EAAOlN,KtC9BW,EsC8BNJ,EAAIqR,OAA0B,GAG9C/D,EAAOlN,KAAKH,EAASwR,QAAO,SAACC,EAAMmG,GAAP,OAAmBnG,EAAOmG,EAAQxG,QAAO,IAAM,GAEpE/D,EAAOmE,QAAO,SAACC,EAAMC,GAAP,OAAgBD,EAAOC,IAAM,KACnD,CAAC3R,EAAKC,IAET,EAAoBoZ,aAAQ,CACxBC,OAAQ,CAAC,MAAO,OAAQ,SACxBK,KAFwB,SAEnBxP,GACD,OAAOA,EAAKzD,MACR,IAAK,MACDd,EAAS1F,EAAQX,EAAY2K,MAAK,SAAAF,GAAU,OAAIA,EAAWI,MAAQD,EAAKL,QACxE,MAEJ,IAAK,OAIL,IAAK,QACDlE,EAASzF,EAAYZ,EAAY2K,MAAK,SAAAF,GAAU,OAAIA,EAAWI,MAAQD,EAAKL,QAC5E,MAEJ,QACI,WAjBPuQ,EAAT,qBAsBA,OACKhb,EA8EG,KA7EA,0BAASkI,UAAWiU,KAAiB9R,QAArC,UAEQ,qBAAKsN,UAAQ,cAActI,IAAK2L,EAAS9S,UAAWiU,KAAiBvF,YAArE,SAEQ5L,OAAOC,KAAKtK,GAAKuK,QAAUtK,EAASsK,OAChC,qCAEQF,OAAOC,KAAKtK,GAAKuK,OACb,qBAAKhD,UAAU,YAAf,SACI,sBAAKA,UAAS,eAAUiU,KAAiBxR,YAAzC,UACI,cAAC,qBAAD,CACIyQ,UAAW,iBAAkBza,EAAMA,EAAIsR,aAAe,GACtDoJ,KACK,gCACG,8BAAM,SAAU1a,EAAMA,EAAIb,KAAO,KACjC,gEAGRkS,MAAO,UAAWrR,EAAMA,EAAIqR,MAAQ,EACpCsJ,UAAU,EACVjU,KAAK,QACT,cAAC,WAAD,CAAUA,KAAK,iBAGvB,KAGJzG,EAASsK,OACL,cAACkR,GAAA,EAAD,CAAaC,QAASC,KAAtB,SACI,qBAAK3E,UAAQ,cAAczP,UAAWiU,KAAiBI,uBAAvD,SAEQ3b,EAASmR,KAAI,SAACD,EAASsD,GAAV,OACT,cAAC,GAAD,CAA8CtD,QAASA,EAASsD,MAAOA,GAAvE,UAAuBtD,EAAQ/G,KAA/B,OAAqCqK,WAKrD,KAGJpK,OAAOC,KAAKtK,GAAKuK,OACb,qBAAKhD,UAAU,YAAf,SACI,sBAAKA,UAAS,eAAUiU,KAAiBxR,YAAzC,UACI,cAAC,qBAAD,CACIyQ,UAAW,iBAAkBza,EAAMA,EAAIsR,aAAe,GACtDoJ,KACK,gCACG,8BAAM,SAAU1a,EAAMA,EAAIb,KAAO,KACjC,0DAGRkS,MAAO,UAAWrR,EAAMA,EAAIqR,MAAQ,EACpCsJ,UAAU,EACVjU,KAAK,WACT,cAAC,WAAD,CAAUA,KAAK,iBAGvB,QAIZ,qBAAKa,UAAWiU,KAAiBK,aAAjC,SACI,mBAAGtU,UAAU,8BAAb,2NAOpB,sBAAKA,UAAS,eAAUiU,KAAiBM,eAAzC,UACI,sBAAKvU,UAAWiU,KAAiBO,YAAjC,UACI,mBAAGxU,UAAS,wCAAmCiU,KAAiBQ,UAAhE,SAA6ET,IAC7E,cAAC,eAAD,CAAc7U,KAAK,eAEvB,cAAC,GAAD,YAOL6B,OAAMC,KAAK8S,I,qBChJbW,GAAiC,WAC1C,OACI,qBAAK1U,UAAWsB,KAAOa,QAAvB,SACI,eAAC+R,GAAA,EAAD,CAAaC,QAASC,KAAtB,UACI,cAAC,GAAD,IACA,cAAC,GAAD,U,oBCyHDO,GAzGK,WAClB,IAAMnU,EAAWmH,cACXtJ,EAAWsB,IACXyB,EAAUC,cAEVuT,EAAwCpU,EAASrI,OAASqI,EAASrI,MAAM8C,MAU/E,MARuB,QAAnBmG,EAAQ3H,SACV+G,EAASrI,MAAQ,IAGnByJ,qBAAU,WACRvD,ErCkBqC,WACrC,IAAOjG,EAA8Eyc,EAA9Ezc,uBAAwBF,EAAsD2c,EAAtD3c,yBAA0BK,EAA4Bsc,EAA5Btc,yBAEzD,8CAAO,WAAO8F,GAAP,mBAAAzB,EAAA,6DACHyB,EAASnG,KADN,kBAGuB2E,MHlEV,qDG+Db,WAGOS,EAHP,QAIcC,GAJd,sBAKW,IAAIC,MAAM,uGALrB,uBAOsBF,EAAQG,OAP9B,gBAOQC,EAPR,EAOQA,KACPW,EAAS9F,EAAyBmF,IARnC,kDAUCW,EAASjG,EAAuB,KAAMkG,UAVvC,0DAAP,sDqCrBSwW,MACR,CAACzW,IAGF,qCACE,cAAC,GAAD,IACA,sBAAM2B,UAAW+U,KAASxG,YAA1B,SACE,eAAC,IAAD,CAAQ/N,SAAUoU,GAAmBpU,EAArC,UACE,cAAC,IAAD,CAAOH,OAAK,EAACpE,KAAK,IAAlB,SACE,cAAC,GAAD,MAGF,cAAC,IAAD,CAAOoE,OAAK,EAACpE,KAAK,mBAAlB,SACE,qBAAK+D,UAAW+U,KAASC,WAAzB,SACE,cAAC,GAAD,QAIJ,cAAC,IAAD,CAAO3U,OAAK,EAACpE,KAAK,QAAlB,SACE,cAAC,GAAD,MAEF,cAAC,IAAD,CAAOoE,OAAK,EAACpE,KAAK,YAAlB,SACE,qBAAK+D,UAAW+U,KAASC,WAAzB,SACE,cAAC,GAAD,CAAWnJ,WAAW,YAI1B,cAAC,GAAD,CAAgBxL,OAAK,EAACpE,KAAK,SAASkJ,YAAY,aAAhD,SACE,cAAC,GAAD,MAEF,cAAC,GAAD,CAAgB9E,OAAK,EAACpE,KAAK,YAAYkJ,YAAY,aAAnD,SACE,cAAC,GAAD,MAEF,cAAC,GAAD,CAAgB9E,OAAK,EAACpE,KAAK,mBAAmBkJ,YAAY,aAA1D,SACE,cAAC,GAAD,MAEF,cAAC,GAAD,CAAgB9E,OAAK,EAACpE,KAAK,kBAAkBkJ,YAAY,aAAzD,SACE,cAAC,GAAD,MAGF,cAAC,GAAD,CAAgB9E,OAAK,EAACpE,KAAK,WAAWkJ,YAAY,gBAAlD,SACE,cAAC,GAAD,MAEF,cAAC,GAAD,CAAgB9E,OAAK,EAACpE,KAAK,kBAAkBkJ,YAAY,gBAAzD,SACE,cAAC,GAAD,MAEF,cAAC,GAAD,CAAgB9E,OAAK,EAACpE,KAAK,sBAAsBkJ,YAAY,gBAA7D,SACE,qBAAKnF,UAAW+U,KAASC,WAAzB,SACE,cAAC,GAAD,CAAWnJ,WAAW,WAI1B,cAAC,IAAD,UACE,cAAC,GAAD,WAKJ+I,GAEE,mCACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOvU,OAAK,EAACpE,KAAK,mBAAlB,SACE,cAAC,GAAD,UACE,cAAC,GAAD,QAIJ,cAAC,IAAD,CAAOoE,OAAK,EAACpE,KAAK,YAAlB,SACE,cAAC,GAAD,UACE,cAAC,GAAD,CAAW4P,WAAW,YAI1B,cAAC,GAAD,CAAgBxL,OAAK,EAACpE,KAAK,eAAekJ,YAAY,gBAAtD,SACE,cAAC,GAAD,UACE,cAAC,GAAD,QAIJ,cAAC,GAAD,CAAgB9E,OAAK,EAACpE,KAAK,sBAAsBkJ,YAAY,gBAA7D,SACE,cAAC,GAAD,UACE,cAAC,GAAD,CAAW0G,WAAW,oBC9GzBoJ,I,OAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,8BAAqBrP,MAAK,YAAkD,IAA/CsP,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,QCMDxS,GAAQ+S,YAAe,CAClCjd,UACAkd,WAAY,SAAAC,GAAoB,OAAIA,IAAuBC,OAAO9W,MAKpEkD,IAAS2D,OACP,cAAC,IAAMkQ,WAAP,UACE,cAAC,IAAD,CAAUnT,MAAOA,GAAjB,SACE,cAAC,IAAD,UACE,cAAC,GAAD,UAINnH,SAASmG,eAAe,SAG1BuT,M,mBChCAzd,EAAOC,QAAU,CAAC,QAAU,oCAAoC,MAAQ,kCAAkC,MAAQ,kCAAkC,KAAO,iCAAiC,QAAU,oCAAoC,YAAc,wCAAwC,YAAc,wCAAwC,KAAO,mC,mBCA7VD,EAAOC,QAAU,CAAC,WAAa,gCAAgC,eAAiB,oCAAoC,MAAQ,2BAA2B,aAAe,kCAAkC,MAAQ,2BAA2B,KAAO,0BAA0B,WAAa,gCAAgC,aAAe,oC,mBCAxUD,EAAOC,QAAU,CAAC,QAAU,+BAA+B,OAAS,8BAA8B,MAAQ,6BAA6B,MAAQ,6BAA6B,aAAe,oCAAoC,OAAS,8BAA8B,YAAc,mCAAmC,MAAQ,6BAA6B,YAAc,mCAAmC,MAAQ,6BAA6B,KAAO,4BAA4B,QAAU,iC,mBCA/dD,EAAOC,QAAU,CAAC,uBAAyB,mDAAmD,YAAc,wCAAwC,QAAU,oCAAoC,YAAc,wCAAwC,WAAa,uCAAuC,SAAW,qCAAqC,cAAgB,0CAA0C,aAAe,2C,mBCAraD,EAAOC,QAAU,CAAC,YAAc,gCAAgC,QAAU,4BAA4B,MAAQ,0BAA0B,UAAY,8BAA8B,QAAU,4BAA4B,KAAO,yBAAyB,YAAc,kC,mBCAtQD,EAAOC,QAAU,CAAC,YAAc,wCAAwC,QAAU,oCAAoC,MAAQ,kCAAkC,KAAO,iCAAiC,MAAQ,oC,mBCAhND,EAAOC,QAAU,CAAC,YAAc,mCAAmC,QAAU,+BAA+B,aAAe,oCAAoC,QAAU,+BAA+B,KAAO,4BAA4B,YAAc,qC,kBCAzPD,EAAOC,QAAU,CAAC,mBAAqB,wCAAwC,eAAiB,oCAAoC,cAAgB,mCAAmC,QAAU,6BAA6B,KAAO,0BAA0B,MAAQ,2BAA2B,aAAe,kCAAkC,OAAS,4BAA4B,OAAS,4BAA4B,WAAa,gCAAgC,YAAc,iCAAiC,aAAe,kCAAkC,eAAiB,sC,wCCA3jBD,EAAOC,QAAU,CAAC,QAAU,gCAAgC,IAAM,4BAA4B,aAAa,mCAAmC,OAAS,+BAA+B,gBAAgB,wC,mBCAtMD,EAAOC,QAAU,CAAC,YAAc,yBAAyB,WAAa,0B,mBCAtED,EAAOC,QAAU,CAAC,KAAO,oBAAoB,QAAU,uBAAuB,MAAQ,uB,mBCAtFD,EAAOC,QAAU,CAAC,WAAa,4BAA4B,YAAc,6BAA6B,eAAiB,kC,mBCAvHD,EAAOC,QAAU,CAAC,KAAO,4BAA4B,kBAAoB,yCAAyC,IAAM,6B,mBCAxHD,EAAOC,QAAU,CAAC,kBAAoB,0CAA0C,OAAS,kC","file":"static/js/main.478d5196.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"modal-overlay_main__W3MSO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"empty\":\"empty-page_empty__2licM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"ingredients-constructor_wrapper___Fcan\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"headerWrapper\":\"app-header_headerWrapper__yuQce\",\"wrapperMenu\":\"app-header_wrapperMenu__1ftww\",\"flex\":\"app-header_flex__1l_Uh\",\"darkTextColor\":\"app-header_darkTextColor__-2bvL\",\"lightTextColor\":\"app-header_lightTextColor__22iM1\",\"logoWrapper\":\"app-header_logoWrapper__1Pgs2\",\"feedLink\":\"app-header_feedLink__3RI4I\",\"constrLink\":\"app-header_constrLink__3fKVr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"menuProfile\":\"profile-links_menuProfile__TAoMl\",\"itemMenu\":\"profile-links_itemMenu__1SiZB\",\"footerMenu\":\"profile-links_footerMenu__1FadQ\",\"lastItemMenu\":\"profile-links_lastItemMenu__29XGy\",\"link\":\"profile-links_link__3pRBI\",\"unchecked\":\"profile-links_unchecked__2Hf2X\",\"checked\":\"profile-links_checked__3v5u6\",\"exitBtn\":\"profile-links_exitBtn__1LrAI\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"burger_wrapper__2Hg6e\",\"titleWrapper\":\"burger_titleWrapper__21ga7\",\"titleTime\":\"burger_titleTime__Z3oyj\",\"textWrapper\":\"burger_textWrapper__3qyqm\",\"captionBurger\":\"burger_captionBurger__2RqB4\",\"cancelled\":\"burger_cancelled__1qTOJ\",\"inWork\":\"burger_inWork__1v4jf\",\"burgerWrapper\":\"burger_burgerWrapper__1lX3Q\",\"img\":\"burger_img__1K7en\",\"costWrapper\":\"burger_costWrapper__25mZd\",\"cost\":\"burger_cost__3gKOC\",\"ingredientsWrapper\":\"burger_ingredientsWrapper__3DCPw\",\"ingredientCount\":\"burger_ingredientCount__3qWTY\",\"imgWrapper\":\"burger_imgWrapper__3YqMG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"order-info_wrapper__3wabG\",\"title\":\"order-info_title__yGOsc\",\"status\":\"order-info_status__cb0nO\",\"details\":\"order-info_details__2-_5C\",\"orderDetailsWrapper\":\"order-info_orderDetailsWrapper__2tQq5\",\"footer\":\"order-info_footer__gSoQb\",\"footerText\":\"order-info_footerText__3x-GR\",\"countWrapper\":\"order-info_countWrapper__1IbKz\",\"ingredient\":\"order-info_ingredient__pdaAB\",\"cost\":\"order-info_cost__2Vt-P\",\"countCostWrapper\":\"order-info_countCostWrapper__3qnD5\",\"ingredientWrapper\":\"order-info_ingredientWrapper__3Nsf6\",\"img\":\"order-info_img__3-IXP\"};","import {createSlice} from '@reduxjs/toolkit';\r\n\r\nimport {IIngredientsState, IIngredient} from '../../interfaces';\r\nimport {ISliceAction} from '../actions/index';\r\n\r\nconst ingredientsInitialState: IIngredientsState = {\r\n    blockedAll: true,\r\n    error: '',\r\n    ingredients: []\r\n};\r\n\r\nconst slice = createSlice({\r\n    name: 'ingredients',\r\n    initialState: ingredientsInitialState,\r\n    reducers: {\r\n        setAllIngredientsRequest(state) {\r\n            state.blockedAll = true;\r\n        },\r\n        setAllIngredientsError(state, actions: ISliceAction<string>) {\r\n            state.ingredients = [];\r\n            state.error = actions.payload;\r\n        },\r\n        setAllIngredientsSuccess(state, actions: ISliceAction<IIngredient[]>) {\r\n            state.blockedAll = false;\r\n            state.ingredients = actions.payload;\r\n        }\r\n    }\r\n});\r\n\r\nexport const {reducer, actions} = slice;\r\n","import {createSlice} from '@reduxjs/toolkit';\r\n\r\nimport {IConstructorState, IIngredient} from '../../interfaces';\r\nimport {ISliceAction} from '../actions/index';\r\n\r\nconst constructorInitialState: IConstructorState = {\r\n    bun: {},\r\n    fillings: []\r\n};\r\n\r\nconst slice = createSlice({\r\n    name: 'constructor',\r\n    initialState: constructorInitialState,\r\n    reducers: {\r\n        setBuns(state, actions: ISliceAction<IIngredient>) {\r\n            state.bun = actions.payload;\r\n        },\r\n        setFillings(state, actions: ISliceAction<IIngredient>) {\r\n            state.fillings.push(actions.payload);\r\n        },\r\n        updateFillings(state, actions: ISliceAction<IIngredient[]>) {\r\n            state.fillings = actions.payload;\r\n        },\r\n        deleteIngredient(state, actions: ISliceAction<IIngredient[]>) {\r\n            state.fillings = actions.payload;\r\n        }\r\n    }\r\n});\r\n\r\nexport const {reducer, actions} = slice;\r\n","import {createSlice} from '@reduxjs/toolkit';\r\n\r\nimport {\r\n    IUserState,\r\n    TUpdatedToken,\r\n    TUserSuccess,\r\n    TUserError\r\n} from '../../interfaces';\r\n\r\nimport {ISliceAction} from '../actions/index';\r\n\r\nconst userInitialState: IUserState = {\r\n    success: false,\r\n    user: {\r\n        email: '',\r\n        name: ''\r\n    },\r\n    accessToken: '',\r\n    refreshToken: '',\r\n    error: '',\r\n    isBlocked: false,\r\n    isExit: false\r\n};\r\n\r\nconst slice = createSlice({\r\n    name: 'user',\r\n    initialState: userInitialState,\r\n    reducers: {\r\n        setUserRequest(state) {\r\n            state.isBlocked = true;\r\n            state.isExit = false;\r\n        },\r\n        setUserError(state, action: ISliceAction<TUserError>) {\r\n            state.success = action.payload.success;\r\n            state.error = action.payload.error;\r\n            state.user.email = '';\r\n            state.user.name = '';\r\n            state.accessToken = '';\r\n            state.refreshToken = '';\r\n            state.isBlocked = false;\r\n            state.isExit = false;\r\n        },\r\n        setUserSuccess(state, action: ISliceAction<TUserSuccess>) {\r\n            state.success = action.payload.success;\r\n            state.user = action.payload.user;\r\n            state.accessToken = action.payload.accessToken;\r\n            state.refreshToken = action.payload.refreshToken;\r\n            state.error = '';\r\n            state.isBlocked = false;\r\n            state.isExit = false;\r\n        },\r\n        setUserClear(state) {\r\n            state.success = true;\r\n            state.user.email = '';\r\n            state.user.name = '';\r\n            state.accessToken = '';\r\n            state.refreshToken = '';\r\n            state.error = '';\r\n            state.isBlocked = false;\r\n            state.isExit = true;\r\n        },\r\n        setUpdatedTokens(state, action: ISliceAction<TUpdatedToken>) {\r\n            state.accessToken = action.payload.accessToken;\r\n        }\r\n    }\r\n});\r\n\r\nexport const {reducer, actions} = slice;\r\n","import {createSlice} from '@reduxjs/toolkit';\r\n\r\nimport {IOrderTape} from '../../interfaces';\r\nimport {ISliceAction} from '../actions/index';\r\n\r\nconst initialState: IOrderTape = {\r\n    orders: [],\r\n    total: 0,\r\n    totalToday: 0\r\n};\r\n\r\nconst slice = createSlice({\r\n    name: 'order-tape',\r\n    initialState: initialState,\r\n    reducers: {\r\n        setOrders(state, action: ISliceAction<IOrderTape>) {\r\n            state.orders = action.payload.orders;\r\n            state.total = action.payload.total;\r\n            state.totalToday = action.payload.totalToday;\r\n        },\r\n        clearOrders(state) {\r\n            state.orders = [];\r\n            state.total = 0;\r\n            state.totalToday = 0;\r\n        }\r\n    }\r\n});\r\n\r\nexport const {reducer, actions} = slice;\r\n","import {createSlice} from '@reduxjs/toolkit';\r\n\r\nimport {IMyOrdersState} from '../../interfaces';\r\nimport {ISliceAction} from '../actions/index';\r\n\r\nconst initialState: IMyOrdersState = {\r\n    orders: []\r\n};\r\n\r\nconst slice = createSlice({\r\n    name: 'my-orders',\r\n    initialState: initialState,\r\n    reducers: {\r\n        setOrders(state, action: ISliceAction<IMyOrdersState>) {\r\n            state.orders = action.payload.orders;\r\n        },\r\n        clearOrders(state) {\r\n            state.orders = [];\r\n        }\r\n    }\r\n});\r\n\r\nexport const {reducer, actions} = slice;\r\n","import {createSlice} from '@reduxjs/toolkit';\r\n\r\nimport {IModalState, IBaseModalState} from '../../interfaces';\r\nimport {ISliceAction} from '../actions/index';\r\n\r\nconst initialState: IModalState = {\r\n    number: null,\r\n    name: null,\r\n    status: '',\r\n    details: ''\r\n};\r\n\r\nconst slice = createSlice({\r\n    name: 'modal',\r\n    initialState: initialState,\r\n    reducers: {\r\n        setStartInfo(state) {\r\n            state.number = null;\r\n            state.name = ' ';\r\n            state.status = '   ';\r\n            state.details = '    ';\r\n        },\r\n        setEndInfo(state, action: ISliceAction<IBaseModalState>) {\r\n            state.number = action.payload.number;\r\n            state.name = action.payload.name;\r\n            state.status = ' ';\r\n            state.details = ' ';\r\n        }\r\n    }\r\n});\r\n\r\nexport const {reducer, actions} = slice;\r\n","import {combineReducers} from 'redux';\r\n\r\nimport {reducer as ingredientsReducer} from '../slices/ingredients';\r\nimport {reducer as constructorReducer} from '../slices/constructor';\r\nimport {reducer as userReducer} from '../slices/user';\r\nimport {reducer as orderTapeReducer} from '../slices/order-tape';\r\nimport {reducer as myOrdersReducer} from '../slices/my-orders';\r\nimport {reducer as modalReducer} from '../slices/modal';\r\n\r\nexport const rootReducer = combineReducers({\r\n    ingredients: ingredientsReducer,\r\n    constructorIngredients: constructorReducer,\r\n    user: userReducer,\r\n    orderTape: orderTapeReducer,\r\n    myOrders: myOrdersReducer,\r\n    modal: modalReducer\r\n});\r\n\r\nexport type TRootState = ReturnType<typeof rootReducer>;\r\n","export const URL_DATA = 'https://norma.nomoreparties.space/api/ingredients';\r\nexport const URL_ORDER = 'https://norma.nomoreparties.space/api/orders';\r\nexport const URL_RECOVERY_PASSWORD = 'https://norma.nomoreparties.space/api/password-reset';\r\nexport const URL_REGISTRATION = 'https://norma.nomoreparties.space/api/auth/register';\r\nexport const URL_RESET_PASSWORD = 'https://norma.nomoreparties.space/api/password-reset/reset';\r\nexport const URL_AUTORIZATION = 'https://norma.nomoreparties.space/api/auth/login';\r\nexport const URL_EXIT = 'https://norma.nomoreparties.space/api/auth/logout';\r\nexport const URL_UPDATE_USER = 'https://norma.nomoreparties.space/api/auth/user';\r\nexport const URL_UPDATE_TOKEN = 'https://norma.nomoreparties.space/api/auth/token';\r\n\r\nexport const MAX_BUNS_COUNT = 2;\r\nexport const MINUTES_IN_HOUR = 60;\r\nexport const MILLISECONDS_IN_DAY = 86400000;\r\nexport const LAST_VISIBLE_INGREDIENTS = 5;\r\nexport const FIVE_DAYS = 5;\r\nexport const ELEVEN_DAYS = 11;\r\nexport const FIFTEEN_DAYS = 15;\r\nexport const WITHOUT_ZERO_MAX_TIME = 10;\r\nexport const MAX_VISIBLE_INGREDIENTS = 6;\r\nexport const RIGHT_INGREDIENT_POSITION = 15;\r\nexport const SYMBOL_COUNT_START_ID_IN_URL = 2;\r\nexport const LOW_PARENT_TOP = 0;\r\nexport const HIGH_PARENT_TOP = 100;\r\n","interface ISetCookieOptions {\r\n  path?: string;\r\n  expires?: Date | string | number;\r\n}\r\n\r\nexport const getCookie = (name: string): string | undefined => {\r\n  let matches = document.cookie.match(new RegExp(\r\n    \"(?:^|; )\" + name.replace(/([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, '\\\\$1') + \"=([^;]*)\"\r\n  ));\r\n  \r\n  return matches ? decodeURIComponent(matches[1]) : undefined;\r\n}\r\n    \r\nexport const setCookie = (name: string, value: string, options: ISetCookieOptions = {}) => {\r\n  options = {\r\n    path: '/',\r\n    ...options\r\n  };\r\n\r\n  if (options.expires instanceof Date) {\r\n    options.expires = options.expires.toUTCString();\r\n  }\r\n\r\n  let updatedCookie = encodeURIComponent(name) + \"=\" + encodeURIComponent(value);\r\n\r\n  for (let optionKey in options) {\r\n    updatedCookie += \"; \" + optionKey;\r\n    let optionValue = options[optionKey as 'path' | 'expires'];\r\n    if (!optionValue) {\r\n      updatedCookie += \"=\" + optionValue;\r\n    }\r\n  }\r\n\r\n  document.cookie = updatedCookie;\r\n}\r\n    \r\nexport const deleteCookie = (name: string): void => {\r\n  setCookie(name, '', { expires: -1 });\r\n}\r\n","import {URL_UPDATE_TOKEN} from '../constants';\r\n\r\nimport {setCookie} from './cookie-helper';\r\n\r\ninterface IResult {\r\n    accessToken: string;\r\n    refreshToken: string;\r\n    success: boolean;\r\n}\r\n\r\nexport const refreshTokenUpdater = async (dispatcher: Function, action: Function): Promise<IResult> => {\r\n    try {\r\n        const request = await fetch(URL_UPDATE_TOKEN, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json;charset=utf-8'\r\n            },\r\n            body: JSON.stringify({token: localStorage.getItem('burgerRefreshToken')})\r\n        });\r\n\r\n        if (!request.ok) {\r\n            throw new Error('  .');\r\n        }\r\n        \r\n        const data: IResult = await request.json();\r\n\r\n        setCookie('burgerAccessToken', data.accessToken);\r\n        localStorage.setItem('burgerRefreshToken', data.refreshToken);\r\n\r\n        dispatcher(action(data));\r\n\r\n        return data;\r\n    } catch (error) {\r\n        throw new Error();\r\n    }\r\n}\r\n","import {\r\n    URL_DATA,\r\n    URL_REGISTRATION,\r\n    URL_AUTORIZATION,\r\n    URL_EXIT,\r\n    URL_UPDATE_USER\r\n} from '../constants';\r\n\r\nimport {actions as ingredientsActions} from '../slices/ingredients';\r\nimport {actions as userActions} from '../slices/user';\r\nimport {refreshTokenUpdater} from '../utils/refresh-token-updater';\r\nimport {setCookie, getCookie, deleteCookie} from '../utils/cookie-helper';\r\n\r\nimport {TDispatch} from '../../index';\r\nimport {TRootState} from '../reducers/index';\r\n\r\nimport {ThunkAction} from 'redux-thunk';\r\nimport {Action, ActionCreator} from 'redux';\r\n\r\nimport type {\r\n    IUserData,\r\n    IUserLogin,\r\n    IExit    \r\n} from '../../interfaces';\r\n\r\nexport const WS_CONNECT_ORDER_TAPE: 'WS_CONNECT_ORDER_TAPE' = 'WS_CONNECT_ORDER_TAPE';\r\nexport const WS_DISCONNECT_ORDER_TAPE: 'WS_DISCONNECT_ORDER_TAPE' = 'WS_DISCONNECT_ORDER_TAPE';\r\nexport const WS_CONNECT_USER_ORDERS: 'WS_CONNECT_USER_ORDERS' = 'WS_CONNECT_USER_ORDERS';\r\nexport const WS_DISCONNECT_USER_ORDERS: 'WS_DISCONNECT_USER_ORDERS' = 'WS_DISCONNECT_USER_ORDERS';\r\n\r\ninterface IPayload {\r\n    url: string;\r\n}\r\n\r\ninterface IWsConnectOrderTape {\r\n    readonly type: typeof WS_CONNECT_ORDER_TAPE;\r\n    readonly payload: IPayload;\r\n}\r\n\r\ninterface IWsDisconnectOrderTape {\r\n    readonly type: typeof WS_DISCONNECT_ORDER_TAPE;\r\n}\r\n\r\ninterface IWsConnectUserOrders {\r\n    readonly type: typeof WS_CONNECT_USER_ORDERS;\r\n    readonly payload: IPayload;\r\n}\r\n\r\ninterface IWsDisconnectUserOrders {\r\n    readonly type: typeof WS_DISCONNECT_USER_ORDERS;\r\n}\r\n\r\nexport type TWsActions = IWsConnectOrderTape | IWsDisconnectOrderTape | IWsConnectUserOrders | IWsDisconnectUserOrders;\r\n\r\nexport interface ISliceAction<U> {\r\n    readonly payload: U;\r\n}\r\n\r\nexport type TAppThunk<ReturnType = void> = ActionCreator<ThunkAction<ReturnType, TRootState, unknown, Action<string>>>; \r\n\r\nexport const getIngredients: TAppThunk = () => {\r\n    const {setAllIngredientsError, setAllIngredientsRequest, setAllIngredientsSuccess} = ingredientsActions;\r\n\r\n    return async (dispatch: TDispatch) => {\r\n        dispatch(setAllIngredientsRequest());\r\n        try {\r\n            const request = await fetch(URL_DATA);\r\n            if (!request.ok) {\r\n                throw new Error('  .');\r\n            }\r\n            const {data} = await request.json();\r\n            dispatch(setAllIngredientsSuccess(data));\r\n        } catch (error) {\r\n            dispatch(setAllIngredientsError(error.message))\r\n        }\r\n    };\r\n}\r\n\r\nexport const updateUserData: TAppThunk = (newUserData: IUserData, token?: string) => {\r\n    const {setUserRequest, setUserError, setUserSuccess, setUpdatedTokens} = userActions;\r\n\r\n    const headers = new Headers();\r\n    headers.set('Content-Type', 'application/json;charset=utf-8');\r\n    headers.set('authorization', getCookie('burgerAccessToken') as string);\r\n\r\n    return async (dispatch: TDispatch) => {\r\n        try {\r\n            dispatch(setUserRequest());\r\n            const request = await fetch(URL_UPDATE_USER, {\r\n                method: 'PATCH',\r\n                headers,\r\n                body: JSON.stringify(newUserData)\r\n            });\r\n\r\n            if (!request.ok) {\r\n                const error: Error = await request.json();\r\n\r\n                if (error.message === 'jwt expired') {\r\n                    await refreshTokenUpdater(dispatch, setUpdatedTokens);\r\n                    throw new Error(error.message);\r\n                } else {\r\n                    throw new Error('');\r\n                }\r\n            }\r\n            const data = await request.json();\r\n\r\n            dispatch(setUserSuccess({\r\n                ...data,\r\n                accessToken: token,\r\n                refreshToken: localStorage.getItem('burgerRefreshToken')\r\n            }));\r\n        } catch(error) {\r\n            if (error.message === 'jwt expired') {\r\n                await updateUserData(newUserData, token);\r\n            } else {\r\n                dispatch(setUserError(error.message));\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport const setUserFromServer: TAppThunk = () => {\r\n    const {setUserSuccess, setUserError, setUserRequest, setUpdatedTokens} = userActions;\r\n\r\n    const headers = new Headers();\r\n    headers.set('Content-Type', 'application/json;charset=utf-8');\r\n    headers.set('authorization', getCookie('burgerAccessToken') as string);\r\n\r\n    return async (dispatch: TDispatch) => {\r\n        try {\r\n            dispatch(setUserRequest());\r\n\r\n            const request = await fetch(URL_UPDATE_USER, {\r\n                method: 'GET',\r\n                headers\r\n            });\r\n\r\n            if (!request.ok) {\r\n                const error = await request.json();\r\n\r\n                if (error.message === 'jwt expired') {\r\n                    deleteCookie('burgerAccessToken');\r\n                    await refreshTokenUpdater(dispatch, setUpdatedTokens);\r\n                    throw new Error(error.message);\r\n                } else {\r\n                    throw new Error('');\r\n                }\r\n            }\r\n\r\n            const data = await request.json();\r\n\r\n            dispatch(setUserSuccess({\r\n                ...data,\r\n                accessToken: getCookie('burgerAccessToken'),\r\n                refreshToken: localStorage.getItem('burgerRefreshToken')\r\n            }));\r\n        } catch(error) {\r\n            if (error.message === 'jwt expired') {\r\n                await setUserFromServer();\r\n            } else {\r\n                dispatch(setUserError(error.message));\r\n                return error;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport const exitUser: TAppThunk = (refreshToken: IExit) => {\r\n    const {setUserError, setUserRequest} = userActions;\r\n\r\n    const headers = new Headers();\r\n    headers.set('Content-Type', 'application/json');\r\n\r\n    return async (dispatch: TDispatch) => {\r\n        dispatch(setUserRequest());\r\n        try {\r\n            const request = await fetch(URL_EXIT, {\r\n                method: 'POST',\r\n                headers,\r\n                referrerPolicy: 'no-referrer',\r\n                body: JSON.stringify(refreshToken)\r\n            });\r\n\r\n            if (!request.ok) {\r\n                throw new Error('  .');\r\n            }\r\n\r\n            deleteCookie('burgerAccessToken');\r\n            localStorage.removeItem('burgerRefreshToken');\r\n        } catch (error) {\r\n            dispatch(setUserError(error.message));\r\n            return error;\r\n        }\r\n    }\r\n}\r\n\r\nexport const setUser: TAppThunk = (userData: IUserLogin | IUserData, typeRequest: string) => {\r\n    const {setUserRequest, setUserSuccess, setUserError} = userActions;\r\n\r\n    const headers = new Headers();\r\n    headers.set('Content-Type', 'application/json');\r\n\r\n    return async (dispatch: TDispatch) => {\r\n        dispatch(setUserRequest());\r\n        try {\r\n            const request = await fetch(typeRequest === 'registration' ? URL_REGISTRATION : URL_AUTORIZATION, {\r\n                method: 'POST',\r\n                headers,\r\n                referrerPolicy: 'no-referrer',\r\n                body: JSON.stringify(userData)\r\n            });\r\n\r\n            if (!request.ok) {\r\n                throw new Error('  .');\r\n            }\r\n            const data = await request.json();\r\n\r\n            setCookie('burgerAccessToken', data.accessToken);\r\n            localStorage.setItem('burgerRefreshToken', data.refreshToken);\r\n            \r\n            dispatch(setUserSuccess(data));\r\n        } catch (error) {\r\n            dispatch(setUserError(error.message));\r\n            return error;\r\n        }\r\n    }\r\n}\r\n","import {Middleware} from 'redux';\r\n\r\nimport {\r\n    WS_CONNECT_ORDER_TAPE,\r\n    WS_DISCONNECT_ORDER_TAPE,\r\n    WS_CONNECT_USER_ORDERS,\r\n    WS_DISCONNECT_USER_ORDERS,\r\n    TWsActions\r\n} from '../actions/index';\r\n\r\nimport {TRootState} from '../reducers/index';\r\n\r\nexport const socketMiddleware: Middleware<{}, TRootState> = storeApi => {\r\n    let wssAllOrders: WebSocket | null = null;\r\n    let wssMyOrders: WebSocket | null = null;\r\n\r\n    return next => (action: TWsActions) => {\r\n        const {dispatch} = storeApi;\r\n\r\n        switch(action.type) {\r\n            case WS_CONNECT_ORDER_TAPE:\r\n                if (wssAllOrders === null) {\r\n                    wssAllOrders = new WebSocket(action.payload.url);\r\n                    if (wssAllOrders) {\r\n                        wssAllOrders.onmessage = event => {\r\n                            if (event.data === 'ping') {\r\n                                wssAllOrders?.send('pong');\r\n                            }\r\n            \r\n                            dispatch({\r\n                                type: 'order-tape/setOrders',\r\n                                payload: JSON.parse(event.data)\r\n                            });\r\n                        };\r\n                    }\r\n                }\r\n                break;\r\n            \r\n            case WS_DISCONNECT_ORDER_TAPE:\r\n                wssAllOrders?.close();\r\n                wssAllOrders = null;\r\n                \r\n                dispatch({\r\n                    type: 'order-tape/clearOrders'\r\n                });\r\n                break;\r\n    \r\n            case WS_CONNECT_USER_ORDERS:\r\n                if (wssMyOrders === null) {\r\n                    wssMyOrders = new WebSocket(action.payload.url);\r\n                    if (wssMyOrders) {\r\n                        wssMyOrders.onmessage = event => {\r\n                            if (event.data === 'ping') {\r\n                                wssMyOrders?.send('pong');\r\n                            }\r\n    \r\n                            dispatch({\r\n                                type: 'my-orders/setOrders',\r\n                                payload: JSON.parse(event.data)\r\n                            });\r\n                        };\r\n                    }\r\n                }\r\n                break;\r\n    \r\n            case WS_DISCONNECT_USER_ORDERS:\r\n                wssMyOrders?.close();\r\n                wssMyOrders = null;\r\n                \r\n                dispatch({\r\n                    type: 'my-orders/clearOrders'\r\n                });\r\n                break;\r\n        }\r\n        next(action);\r\n    }\r\n};\r\n","import {\r\n    TypedUseSelectorHook,\r\n    useDispatch as dispatchHook,\r\n    useSelector as selectorHook\r\n} from 'react-redux';\r\n\r\nimport {TDispatch} from '../../index';\r\nimport {TRootState} from '../reducers/index';\r\n  \r\nexport const useDispatch = () => dispatchHook<TDispatch>();\r\nexport const useSelector: TypedUseSelectorHook<TRootState> = selectorHook;\r\n","import React, {FC, ReactElement} from 'react';\r\nimport {NavLink} from 'react-router-dom';\r\n\r\nimport {Logo, BurgerIcon, ListIcon, ProfileIcon} from '@ya.praktikum/react-developer-burger-ui-components';\r\nimport appHeaderStyle from './app-header.module.css';\r\n\r\nconst AppHeader: FC<{}> = (): ReactElement => {\r\n    return (\r\n        <header className={appHeaderStyle.headerWrapper}>\r\n            <div className={appHeaderStyle.wrapperMenu}>\r\n                <div className={appHeaderStyle.flex}>\r\n                    <div className={`mt-2 mb-2 p-2 ${appHeaderStyle.flex}`}>\r\n                        <BurgerIcon type=\"primary\"/>\r\n                        <NavLink\r\n                            exact to=\"/\"\r\n                            isActive={\r\n                                (match, location) => !!(match\r\n                                    || location.pathname.indexOf('ingredients') !== -1\r\n                                    || location.pathname.indexOf('start-order') !== -1)\r\n                            }\r\n                            activeClassName={appHeaderStyle.lightTextColor}\r\n                            className={`text text_type_main-default ml-1 ${appHeaderStyle.feedLink} ${appHeaderStyle.darkTextColor}`}>\r\n                            \r\n                        </NavLink>\r\n                    </div>\r\n                    <div className={`mt-2 mb-2 p-2 ${appHeaderStyle.flex}`}>\r\n                        <ListIcon type=\"primary\"/>\r\n                        <NavLink\r\n                            className={`text text_type_main-default ml-1 ${appHeaderStyle.feedLink} ${appHeaderStyle.darkTextColor}`}\r\n                            activeClassName={appHeaderStyle.lightTextColor}\r\n                            to=\"/feed\"> </NavLink>\r\n                    </div>\r\n                </div>\r\n                <div className={`mt-2 mb-2 p-2 ${appHeaderStyle.flex}`}>\r\n                    <ProfileIcon type=\"primary\"/>\r\n                    <NavLink\r\n                        className={`text text_type_main-default ml-1 ${appHeaderStyle.feedLink} ${appHeaderStyle.darkTextColor}`}\r\n                        activeClassName={appHeaderStyle.lightTextColor}\r\n                        to=\"/profile\"> </NavLink>\r\n                </div>\r\n            </div>\r\n            <div className={appHeaderStyle.logoWrapper}>\r\n                <Logo/>\r\n            </div>\r\n        </header>\r\n    );\r\n}\r\n\r\nexport default React.memo(AppHeader);\r\n","import {FC, ReactElement, ReactNode} from 'react';\r\n\r\nimport {useHistory} from 'react-router-dom';\r\n\r\nimport styles from './modal-overlay.module.css';\r\n\r\ninterface IModalOverlay {\r\n    children: ReactNode;\r\n}\r\n\r\nexport const ModalOverlay: FC<IModalOverlay> = ({children}): ReactElement => {\r\n    const history = useHistory();\r\n\r\n    const mainHandler = () => history.goBack();\r\n\r\n    return (\r\n        <div className={styles.main} onClick={mainHandler}>\r\n            {children}\r\n        </div>\r\n    );\r\n}\r\n","import {useEffect, FC, ReactElement, ReactNode, SyntheticEvent} from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\nimport {ModalOverlay} from './modal-overlay/modal-overlay';\r\n\r\nimport close from '../../images/close.png';\r\nimport styles from './modal.module.css';\r\n\r\nconst modal = document.getElementById('modal');\r\n\r\ninterface IModal {\r\n    children: ReactNode;\r\n}\r\n\r\nexport const Modal: FC<IModal> = ({children}): ReactElement => {\r\n    const history = useHistory();\r\n\r\n    useEffect(() => {\r\n        document.addEventListener('keydown', closeModal);\r\n        return () => document.removeEventListener('keydown', closeModal);    \r\n    });\r\n\r\n    const onModalClick = (event: SyntheticEvent<HTMLDivElement>) => event.stopPropagation();\r\n\r\n    const closeModal = () => history.goBack();\r\n\r\n    return ReactDOM.createPortal(\r\n        (\r\n            <ModalOverlay>\r\n                <div className={styles.main} onClick={onModalClick}>\r\n                    <div className={styles.wrapper}>\r\n                        {children}\r\n                        <img src={close} className={styles.close} alt=\"close\" onClick={closeModal}/>\r\n                    </div>\r\n                </div>\r\n            </ModalOverlay>\r\n        ), modal as HTMLElement);\r\n}\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADPSURBVHgBlZTbDcMgDEUxUQdgg6ySyTNK2ACF9q8Cl1ukKiU8jH9i2c6RsS+Q969DJQvhvRljrJow59y6LI8dvmaO6cPfABLzEF7B0DGGjZntDOwfwhaMX+I8/eH9k3HUHgw51KAW/9xqJbAhRAIbQagG03rZiSgVksU2ES9nUm6YWp1dYTnahjRBd1jCdCAwrTpGpKt+tVY1urnOJIPQWZ6Z6GgtsZUL6F6n3orFopWIbQgTK7YDo9pMRs9JTbSU3yM5pAUjtInEDKSEwf8AUWh+6yealnMAAAAASUVORK5CYII=\"","import {FC, ReactElement} from 'react';\r\nimport {useParams} from 'react-router-dom';\r\nimport {useSelector} from '../../services/utils/modified-react-hooks';\r\n\r\nimport detailsStyle from './ingredient-details.module.css';\r\n\r\ninterface IParams {\r\n    id: string;\r\n}\r\n\r\nexport const IngredientDetails: FC<{}> = (): ReactElement | null => {\r\n    const {id} = useParams() as IParams;\r\n\r\n    const {ingredients} = useSelector(store => store.ingredients);\r\n    const ingredient = ingredients.find(item => item._id === id);\r\n\r\n    return (\r\n        ingredient && Object.keys(ingredient).length ? (\r\n            <div className={detailsStyle.wrapper}>\r\n                <p className={`text text_type_main-large ${detailsStyle.title}`}> </p>    \r\n                <div className={detailsStyle.main}>\r\n                    <img alt=\"bun\" src={ingredient.image_large} className={`mb-2 ${detailsStyle.image}`}/>\r\n                    <div className={`text text_type_main-medium ${detailsStyle.name}`}>{ingredient.name}</div>\r\n                    <div className={`text text_type_main-default ${detailsStyle.details}`}>        ,     .</div>\r\n                    <div className={detailsStyle.infoWrapper}>\r\n                        <div className={detailsStyle.infoElement}>\r\n                            <p className=\"text text_type_main-default\">, </p>\r\n                            <p className=\"text text_type_digits-default pt-1\">{ingredient.calories}</p>\r\n                        </div>\r\n                        <div className={detailsStyle.infoElement}>\r\n                            <p className=\"text text_type_main-default\">, </p>\r\n                            <p className=\"text text_type_digits-default pt-1\">{ingredient.proteins}</p>\r\n                        </div>\r\n                        <div className={detailsStyle.infoElement}>\r\n                            <p className=\"text text_type_main-default\">, </p>\r\n                            <p className=\"text text_type_digits-default pt-1\">{ingredient.fat}</p>\r\n                        </div>\r\n                        <div className={detailsStyle.infoElement}>\r\n                            <p className=\"text text_type_main-default\">, </p>\r\n                            <p className=\"text text_type_digits-default pt-1\">{ingredient.carbohydrates}</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        ) : null\r\n    );\r\n}\r\n","import {FC, ReactElement} from 'react';\r\n\r\nimport {useSelector} from '../../services/utils/modified-react-hooks';\r\n\r\nimport orderStyle from './order-details.module.css';\r\n\r\nexport const OrderDetails: FC<{}> = (): ReactElement => {\r\n    const {number, name, status, details} = useSelector(store => store.modal);\r\n\r\n    return (\r\n        <div className={orderStyle.wrapper}>\r\n            <p className={`text text_type_digits-large mb-4 ${orderStyle.number}`}>{number}</p>\r\n            <p className={`text text_type_main-medium ${orderStyle.title}`}>{name}</p>\r\n            <div className={orderStyle.image}>\r\n                <div className={orderStyle.vektorSecond}>\r\n                    <svg width=\"107\" height=\"100\" viewBox=\"0 0 107 100\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                        <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M103.944 38.453C108.019 45.5983 108.019 54.4017 103.944 61.547L88.5996 88.453C84.5247 95.5983 76.994 100 68.8442 100H38.1558C30.006 100 22.4753 95.5983 18.4004 88.453L3.05617 61.547C-1.01872 54.4017 -1.01872 45.5983 3.05617 38.453L18.4004 11.547C22.4753 4.40169 30.006 0 38.1558 0L68.8442 0C76.994 0 84.5247 4.40169 88.5996 11.547L103.944 38.453Z\" fill=\"url(#paint0_radial)\" fillOpacity=\"0.25\"/>\r\n                        <defs>\r\n                            <radialGradient id=\"paint0_radial\" cx=\"0\" cy=\"0\" r=\"1\" gradientUnits=\"userSpaceOnUse\" gradientTransform=\"translate(53.5 50) rotate(-43.0632) scale(73.2274 55.0025)\">\r\n                                <stop stopColor=\"#801AB3\" stopOpacity=\"0\"/>\r\n                                <stop offset=\"1\" stopColor=\"#4C4CFF\"/>\r\n                            </radialGradient>\r\n                        </defs>\r\n                    </svg>\r\n                </div>\r\n                <div className={orderStyle.vektorThird}>\r\n                    <svg width=\"98\" height=\"102\" viewBox=\"0 0 98 102\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                        <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M4.36637 37.3873C-1.45546 45.5044 -1.45545 56.4957 4.36637 64.6127L24.3336 92.4518C30.1554 100.569 40.4748 103.965 49.8947 100.865L82.2023 90.2313C91.6223 87.1309 98 78.2387 98 68.2055V33.7945C98 23.7612 91.6222 14.8691 82.2023 11.7687L49.8947 1.13508C40.4748 -1.96536 30.1554 1.43114 24.3336 9.54819L4.36637 37.3873Z\" fill=\"url(#paint0_radial)\" fillOpacity=\"0.25\"/>\r\n                        <defs>\r\n                            <radialGradient id=\"paint0_radial\" cx=\"0\" cy=\"0\" r=\"1\" gradientUnits=\"userSpaceOnUse\" gradientTransform=\"translate(49 51) rotate(-46.1458) scale(70.7248 53.2019)\">\r\n                                <stop stopColor=\"#801AB3\" stopOpacity=\"0\"/>\r\n                                <stop offset=\"1\" stopColor=\"#4C4CFF\"/>\r\n                            </radialGradient>\r\n                        </defs>\r\n                    </svg>\r\n                </div>\r\n                <div className={orderStyle.vektorFirst}>\r\n                    <svg width=\"68\" height=\"66\" viewBox=\"0 0 68 66\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                        <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M24.9249 2.91091C30.3362 -0.970307 37.6638 -0.970302 43.0751 2.91092L61.6345 16.2224C67.0459 20.1036 69.3102 26.9832 67.2433 33.2632L60.1542 54.8016C58.0873 61.0815 52.1592 65.3333 45.4703 65.3333H22.5296C15.8408 65.3333 9.91274 61.0815 7.84578 54.8016L0.756717 33.2632C-1.31024 26.9832 0.954096 20.1036 6.36546 16.2224L24.9249 2.91091Z\" fill=\"url(#paint0_radial)\" fillOpacity=\"0.25\"/>\r\n                        <defs>\r\n                            <radialGradient id=\"paint0_radial\" cx=\"0\" cy=\"0\" r=\"1\" gradientUnits=\"userSpaceOnUse\" gradientTransform=\"translate(34 32.6667) rotate(136.146) scale(47.1499 35.4679)\">\r\n                                <stop stopColor=\"#801AB3\" stopOpacity=\"0\"/>\r\n                                <stop offset=\"1\" stopColor=\"#4C4CFF\" stopOpacity=\"0.5\"/>\r\n                            </radialGradient>\r\n                        </defs>\r\n                    </svg>\r\n                </div>\r\n                <div className={orderStyle.done}>\r\n                    <svg width=\"40\" height=\"28\" viewBox=\"0 0 40 28\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                        <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M39.3122 0.595853C40.1999 1.4172 40.2327 2.78057 39.3852 3.64103L16.0519 27.3333C15.6272 27.7646 15.0371 28.0059 14.422 27.9999C13.8069 27.9939 13.222 27.741 12.8063 27.3016L0.584115 14.3785C-0.245201 13.5016 -0.184084 12.1392 0.720625 11.3354C1.62533 10.5316 3.03104 10.5908 3.86035 11.4677L14.4773 22.6934L36.1703 0.666671C37.0177 -0.193786 38.4244 -0.225493 39.3122 0.595853Z\" fill=\"#F2F2F3\"/>\r\n                    </svg>\r\n                </div>\r\n            </div>\r\n            <p className=\"text text_type_main-default mb-1\">{status}</p>\r\n            <p className={`text text_type_main-default ${orderStyle.details}`}>{details}</p>\r\n        </div>\r\n    );\r\n}\r\n","import {ReactNode, useEffect, useState, FC, ReactElement} from 'react';\r\nimport {useDispatch} from 'react-redux';\r\nimport {Route, Redirect} from 'react-router-dom';\r\n\r\nimport {actions as userActions} from '../../services/slices/user';\r\nimport {refreshTokenUpdater} from '../../services/utils/refresh-token-updater';\r\n\r\ninterface IProtectedRoute {\r\n    children: ReactNode;\r\n    path: string;\r\n    protectType: 'nonAuthorized' | 'authorized';\r\n    exact?: boolean;\r\n}\r\n\r\ninterface IRoutes {\r\n    nonAuthorized: JSX.Element;\r\n    authorized: JSX.Element;\r\n}\r\n\r\nexport const ProtectedRoute: FC<IProtectedRoute> = ({children, path, protectType}): ReactElement | null => {\r\n    const dispatch = useDispatch();\r\n\r\n    const {setUpdatedTokens} = userActions;\r\n    const refreshToken = localStorage.getItem('burgerRefreshToken');\r\n\r\n    const [routeData, setRouteData] = useState({\r\n        isTokenValid: false,\r\n        routeType: 'none'\r\n    });\r\n\r\n    const {isTokenValid, routeType} = routeData;\r\n\r\n    const protectedRoutes: IRoutes = {\r\n        nonAuthorized: <Route path={path} render={\r\n            ({location}) => (isTokenValid || refreshToken) ? children : <Redirect to={\r\n                {\r\n                    pathname: '/login',\r\n                    state: {\r\n                        from: location\r\n                    } \r\n                }\r\n            }/>\r\n        }/>,\r\n\r\n        authorized: <Route path={path} render={\r\n            () => (isTokenValid || refreshToken) ? <Redirect to=\"/\"/> : children\r\n        }/>\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (routeType === 'none') {\r\n            refreshTokenUpdater(dispatch, setUpdatedTokens)\r\n                .then(result => setRouteData({\r\n                    isTokenValid: result.success,\r\n                    routeType: protectType\r\n                }))\r\n                .catch(() => setRouteData({\r\n                    isTokenValid: false,\r\n                    routeType: protectType\r\n                }))\r\n        }\r\n    }, [dispatch, setUpdatedTokens, protectType, routeType]);\r\n\r\n    return routeType === 'none' ? null : protectedRoutes[protectType];\r\n}\r\n","import {useState, useRef, FC, ReactElement, SyntheticEvent} from 'react';\r\nimport {useDispatch} from 'react-redux';\r\nimport {useHistory, Link} from 'react-router-dom';\r\n\r\nimport {setUser} from '../services/actions/index';\r\n\r\nimport {Logo, Input, Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport {IPasswordState} from '../interfaces';\r\n\r\nimport styles from './input-pages.module.css';\r\n\r\n//    \r\nimport './input-pages.css';\r\n\r\nexport const Registration: FC<{}> = (): ReactElement => {\r\n    const dispatch = useDispatch();\r\n    const history = useHistory();\r\n\r\n    const passRef = useRef(null);\r\n\r\n    const [name, setName] = useState('');\r\n    const [email, setEmail] = useState('');\r\n\r\n    const [passwordConfig, setPasswordConfig] = useState<IPasswordState>({\r\n        type: 'password',\r\n        value: '',\r\n        icon: 'ShowIcon'\r\n    });\r\n\r\n    const onEyeClick = () => {\r\n        setPasswordConfig({\r\n            ...passwordConfig,\r\n            type: passwordConfig.type === 'password' ? 'text' : 'password',\r\n            icon: passwordConfig.icon === 'ShowIcon' ? 'HideIcon' : 'ShowIcon'\r\n        });\r\n    };\r\n\r\n    const registrationStart = (event: SyntheticEvent<HTMLFormElement>) => {\r\n        event.preventDefault();\r\n        \r\n        (dispatch(setUser({\r\n            name,\r\n            email,\r\n            password: passwordConfig.value\r\n        }, 'registration')) as unknown as Promise<Error>)\r\n            .then(result => {\r\n                if (result instanceof Error) throw new Error(); \r\n                history.replace({pathname: '/'})\r\n            })\r\n            .catch(error => console.log(error));\r\n    };\r\n\r\n    return (\r\n        <div className={styles.wrapper}>\r\n            <div className={styles.logo}>\r\n                <Logo/>\r\n            </div>   \r\n            <p className={`text text_type_main-medium ${styles.title}`}></p>\r\n\r\n            <form onSubmit={registrationStart}>\r\n                <div className={styles.inputWrapper}>\r\n                    <Input\r\n                        type={'text'}\r\n                        placeholder={''}\r\n                        value={name}\r\n                        onChange={event => setName(event.target.value)}\r\n                        />\r\n                </div>\r\n                <div className={styles.inputWrapper}>\r\n                    <Input\r\n                        type={'email'}\r\n                        placeholder={'E-mail'}\r\n                        value={email}\r\n                        onChange={event => setEmail(event.target.value)}/>\r\n                </div>\r\n                <div className={styles.inputWrapper}>\r\n                    <Input\r\n                        type={passwordConfig.type}\r\n                        placeholder={''}\r\n                        value={passwordConfig.value}\r\n                        onChange={event => setPasswordConfig({\r\n                            ...passwordConfig,\r\n                            value: event.target.value\r\n                        })}\r\n                        icon={passwordConfig.icon}\r\n                        ref={passRef}\r\n                        onIconClick={onEyeClick}/>\r\n                </div>\r\n\r\n                <div className={styles.button}>\r\n                    <Button type=\"primary\" size=\"large\"></Button>\r\n                </div>\r\n            </form>\r\n            \r\n            \r\n            <div className={styles.footer}>\r\n                <p className={`text text_type_main-default ${styles.footerInfo}`}> ?</p>\r\n                <Link to=\"/login\" className={`text text_type_main-default ml-2 ${styles.footerEnter}`}></Link>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import {useState, useRef, FC, ReactElement, SyntheticEvent} from 'react';\r\nimport {Link, useHistory, useLocation} from 'react-router-dom';\r\n\r\nimport {useDispatch} from '../services/utils/modified-react-hooks';\r\nimport {setUser} from '../services/actions/index';\r\n\r\nimport {Logo, Input, Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport {IPasswordState} from '../interfaces';\r\n\r\nimport styles from './input-pages.module.css';\r\n\r\n//    \r\nimport './input-pages.css';\r\n\r\ninterface ILocation {\r\n    from: {\r\n        pathname: string;\r\n    }\r\n}\r\n\r\nexport const Autorization: FC<{}> = (): ReactElement => {\r\n    const dispatch = useDispatch();\r\n    const history = useHistory();\r\n    const location = useLocation<ILocation>();\r\n\r\n    const passRef = useRef(null);\r\n\r\n    const [email, setEmail] = useState('');\r\n\r\n    const [passwordConfig, setPasswordConfig] = useState<IPasswordState>({\r\n        type: 'password',\r\n        value: '',\r\n        icon: 'ShowIcon'\r\n    });\r\n\r\n    const onEyeClick = () => {\r\n        setPasswordConfig({\r\n            ...passwordConfig,\r\n            type: passwordConfig.type === 'password' ? 'text' : 'password',\r\n            icon: passwordConfig.icon === 'ShowIcon' ? 'HideIcon' : 'ShowIcon'\r\n        });\r\n    };\r\n\r\n    const onLogin = (event: SyntheticEvent<HTMLFormElement>) => {\r\n        event.preventDefault();\r\n\r\n        (dispatch(setUser({\r\n            email, \r\n            password: passwordConfig.value \r\n        }, 'authorization')) as unknown as Promise<Error>)\r\n            .then(result => {\r\n                if (result instanceof Error) throw new Error();\r\n\r\n                if (location.state?.from?.pathname === '/start-order' || history.action === 'POP' || !location.state?.from) {\r\n                    history.push('/');\r\n                } else {\r\n                    history.push(location.state.from.pathname);\r\n                }                \r\n            })\r\n            .catch(error => console.log(error));\r\n    }\r\n\r\n    return (\r\n        <div className={styles.wrapper}>\r\n            <div className={styles.logo}>\r\n                <Logo/>\r\n            </div>   \r\n            <p className={`text text_type_main-medium ${styles.title}`}></p>\r\n\r\n            <form onSubmit={onLogin}>\r\n                <div className={styles.inputWrapper}>\r\n                    <Input\r\n                        type={'email'}\r\n                        placeholder={'E-mail'}\r\n                        value={email}\r\n                        onChange={event => setEmail(event.target.value)}/>\r\n                </div>\r\n                <div className={styles.inputWrapper}>\r\n                    <Input\r\n                        type={passwordConfig.type}\r\n                        placeholder={''}\r\n                        value={passwordConfig.value}\r\n                        onChange={event => setPasswordConfig({\r\n                            ...passwordConfig,\r\n                            value: event.target.value\r\n                        })}\r\n                        icon={passwordConfig.icon}\r\n                        ref={passRef}\r\n                        onIconClick={onEyeClick}/>\r\n                </div>\r\n\r\n                <div className={styles.button}>\r\n                    <Button type=\"primary\" size=\"large\"></Button>\r\n                </div>\r\n            </form>\r\n\r\n            <div className={`mb-4 ${styles.footer}`}>\r\n                <p className={`text text_type_main-default ${styles.footerInfo}`}>   ?</p>\r\n                <Link to=\"/register\" className={`text text_type_main-default ml-2 ${styles.footerEnter}`}></Link>\r\n            </div>\r\n\r\n            <div className={styles.footer}>\r\n                <p className={`text text_type_main-default ${styles.footerInfo}`}> ?</p>\r\n                <Link to=\"/forgot-password\" className={`text text_type_main-default ml-2 ${styles.footerEnter}`}> </Link>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import {URL_RECOVERY_PASSWORD} from '../constants';\r\n\r\nexport const recoveryPass = async (email: string): Promise<Error | undefined> => {\r\n    try {\r\n        const request = await fetch(URL_RECOVERY_PASSWORD, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                email\r\n            })\r\n        });\r\n\r\n        if (!request.ok) {\r\n            throw new Error('  .');\r\n        }\r\n    } catch (error) {\r\n        console.log(error.message);\r\n        return error;\r\n    }\r\n}\r\n","import {useState, FC, ReactElement, SyntheticEvent} from 'react';\r\nimport {Link, useHistory} from 'react-router-dom';\r\n\r\nimport {recoveryPass} from '../services/utils/recovery-pass';\r\n\r\nimport {Logo, Input, Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport styles from './input-pages.module.css';\r\n\r\n//    \r\nimport './input-pages.css';\r\n\r\nexport const RecoveryPassword: FC<{}> = (): ReactElement => {\r\n    const history = useHistory();\r\n\r\n    const [email, setEmail] = useState('');\r\n\r\n    const onRecoveryClick = (event: SyntheticEvent<HTMLFormElement>) => {\r\n        event.preventDefault();\r\n        \r\n        if (email) {\r\n            recoveryPass(email)\r\n                .then(result => {\r\n                    if (result instanceof Error) throw new Error();\r\n                    localStorage.setItem('allowResetPassword', 'allow');\r\n                    history.replace({pathname: '/reset-password'});\r\n                })\r\n                .catch(error => console.log(error));\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={styles.wrapper}>\r\n            <div className={styles.logo}>\r\n                <Logo/>\r\n            </div>   \r\n            <p className={`text text_type_main-medium ${styles.title}`}> </p>\r\n\r\n            <form onSubmit={onRecoveryClick}>\r\n                <div className={styles.inputWrapper}>\r\n                    <Input\r\n                        type={'email'}\r\n                        placeholder={'E-mail'}\r\n                        value={email}\r\n                        onChange={event => setEmail(event.target.value)}/>\r\n                </div>\r\n\r\n                <div className={styles.button}>\r\n                    <Button type=\"primary\" size=\"large\"></Button>\r\n                </div>\r\n            </form>\r\n            \r\n            <div className={styles.footer}>\r\n                <p className={`text text_type_main-default ${styles.footerInfo}`}> ?</p>\r\n                <Link to=\"/login\" className={`text text_type_main-default ml-2 ${styles.footerEnter}`}></Link>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import {URL_RESET_PASSWORD} from '../constants';\r\n\r\ninterface IData {\r\n    password: string;\r\n    token: string;\r\n}\r\n\r\ntype TResetPass = (params: IData) => Promise<Error | undefined>;\r\n\r\nexport const resetPass: TResetPass = async ({password, token}) => {\r\n    try {\r\n        const request = await fetch(URL_RESET_PASSWORD, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                password,\r\n                token\r\n            })\r\n        });\r\n\r\n        if (!request.ok) {\r\n            throw new Error('  .');\r\n        }\r\n    } catch (error) {\r\n        console.log(error.message);\r\n        return error;\r\n    }\r\n}\r\n","import {useState, useRef, useEffect, FC, ReactElement, SyntheticEvent} from 'react';\r\nimport {Link, useHistory, Redirect} from 'react-router-dom';\r\n\r\nimport {resetPass} from '../services/utils/reset-pass';\r\n\r\nimport {Logo, Input, Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport {IPasswordState} from '../interfaces';\r\n\r\nimport styles from './input-pages.module.css';\r\n\r\n//    \r\nimport './input-pages.css';\r\nimport { isCompositeComponent } from 'react-dom/test-utils';\r\n\r\nexport const ResetPassword: FC<{}> = (): ReactElement => {\r\n    const passRef = useRef(null);\r\n\r\n    const history = useHistory();\r\n\r\n    const [token, setToken] = useState('');\r\n\r\n    const [passwordConfig, setPasswordConfig] = useState<IPasswordState>({\r\n        type: 'password',\r\n        value: '',\r\n        icon: 'ShowIcon'\r\n    });\r\n\r\n    const onEyeClick = () => {\r\n        setPasswordConfig({\r\n            ...passwordConfig,\r\n            type: passwordConfig.type === 'password' ? 'text' : 'password',\r\n            icon: passwordConfig.icon === 'ShowIcon' ? 'HideIcon' : 'ShowIcon'\r\n        });\r\n    };\r\n\r\n    const onSave = (event: SyntheticEvent<HTMLFormElement>) => {\r\n        event.preventDefault();\r\n        \r\n        if (passwordConfig.value && token) {\r\n            resetPass({\r\n                password: passwordConfig.value,\r\n                token\r\n            })\r\n                .then(result => {\r\n                    if (result instanceof Error) throw new Error();\r\n                    localStorage.setItem('allowResetPassword', '');\r\n                    history.replace({pathname: '/login'});\r\n                })\r\n                .catch(error => console.log(error));\r\n        } \r\n    }\r\n\r\n    useEffect(() => {\r\n        return () => localStorage.setItem('allowResetPassword', '');\r\n    }, []);\r\n\r\n    return (\r\n        localStorage.getItem('allowResetPassword') ?\r\n            (<div className={styles.wrapper}>\r\n                <div className={styles.logo}>\r\n                    <Logo/>\r\n                </div>   \r\n                <p className={`text text_type_main-medium ${styles.title}`}> </p>\r\n\r\n                <form onSubmit={onSave}>\r\n                    <div className={styles.inputWrapper}>\r\n                        <Input\r\n                            type={passwordConfig.type}\r\n                            placeholder={'  '}\r\n                            value={passwordConfig.value}\r\n                            onChange={event => setPasswordConfig({\r\n                                ...passwordConfig,\r\n                                value: event.target.value\r\n                            })}\r\n                            icon={passwordConfig.icon}\r\n                            ref={passRef}\r\n                            onIconClick={onEyeClick}/>\r\n                    </div>\r\n\r\n                    <div className={styles.inputWrapper}>\r\n                        <Input\r\n                            type={'text'}\r\n                            placeholder={'   '}\r\n                            value={token}\r\n                            onChange={event => setToken(event.target.value)}/>\r\n                    </div>\r\n\r\n                    <div className={styles.button}>\r\n                        <Button type=\"primary\" size=\"large\"></Button>\r\n                    </div>\r\n                </form>\r\n                \r\n                <div className={styles.footer}>\r\n                    <p className={`text text_type_main-default ${styles.footerInfo}`}> ?</p>\r\n                    <Link to=\"/login\" className={`text text_type_main-default ml-2 ${styles.footerEnter}`}></Link>\r\n                </div>\r\n            </div>) \r\n        : <Redirect to=\"/login\"/>\r\n    );\r\n}\r\n","import {FC, ReactElement} from 'react';\r\nimport {useDispatch} from '../../services/utils/modified-react-hooks';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\nimport {exitUser} from '../../services/actions/index';\r\nimport {actions as userActions} from '../../services/slices/user';\r\n\r\nimport {NavLink} from 'react-router-dom';\r\n\r\nimport styles from './profile-links.module.css';\r\n\r\nexport const ProfileLinks: FC<{}> = (): ReactElement => {\r\n    const {setUserClear} = userActions;\r\n\r\n    const dispatch = useDispatch();\r\n    const history = useHistory();\r\n\r\n    const onExit = async () => {\r\n        await dispatch(exitUser({\r\n            token: localStorage.getItem('burgerRefreshToken') as string\r\n        }));\r\n\r\n        history.replace({pathname: '/login'});\r\n        dispatch(setUserClear());\r\n    };\r\n\r\n    return (\r\n        <div className={styles.menuProfile}>\r\n            <div className={styles.itemMenu}>\r\n                <NavLink exact to=\"/profile\"\r\n                    className={`text text_type_main-medium ${styles.link} ${styles.unchecked}`}\r\n                    activeClassName={styles.checked}>\r\n                </NavLink>\r\n            </div>\r\n            <div className={styles.itemMenu}>\r\n                <NavLink exact to=\"/profile/orders\"\r\n                    className={`text text_type_main-medium ${styles.link} ${styles.unchecked}`}\r\n                    activeClassName={styles.checked}> \r\n                </NavLink>\r\n            </div>\r\n            <div className={`${styles.itemMenu} ${styles.lastItemMenu}`}>\r\n                <div onClick={onExit} className={`text text_type_main-medium ${styles.link} ${styles.exitBtn} ${styles.unchecked}`}></div>\r\n            </div>\r\n\r\n            <p className={`text text_type_main-default ${styles.footerMenu}`}>        </p>\r\n        </div>\r\n    );\r\n}\r\n","import {useState, useEffect, FC, ReactElement, SyntheticEvent} from 'react';\r\nimport {useSelector, useDispatch} from '../services/utils/modified-react-hooks';\r\n\r\nimport {updateUserData, setUserFromServer} from '../services/actions/index';\r\n\r\nimport {ProfileLinks} from '../components/profile-links/profile-links';\r\n\r\nimport {Input, Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport styles from './input-pages.module.css';\r\n\r\n//    \r\nimport './input-pages.css';\r\n\r\nexport const UserProfile: FC<{}> = (): ReactElement => {\r\n    const dispatch = useDispatch();\r\n    const storeUserData = useSelector(store => store.user);\r\n\r\n    const [userData, setUserData] = useState({\r\n        name: '',\r\n        email: '',\r\n        password: ''\r\n    });\r\n\r\n    const onSave = (event: SyntheticEvent<HTMLFormElement>) => {\r\n        event.preventDefault();\r\n\r\n        dispatch(updateUserData({...userData}));\r\n    }\r\n\r\n    const onCancel = () => setUserData({\r\n        name: storeUserData.user.name as string,\r\n        email: storeUserData.user.email,\r\n        password: ''\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (!storeUserData.user.name && !storeUserData.isExit) {\r\n            dispatch(setUserFromServer());\r\n        } else {\r\n            setUserData({\r\n                name: storeUserData.user.name as string,\r\n                email: storeUserData.user.email,\r\n                password: ''\r\n            });\r\n        }\r\n    }, [dispatch, storeUserData.user.name, storeUserData.user.email, storeUserData.isExit]);\r\n\r\n    return (\r\n        <div className={styles.mainProfileWrapper}>\r\n            <div className={styles.profileWrapper}>\r\n                <div className={styles.linksWrapper}>\r\n                    <ProfileLinks/>\r\n                </div>\r\n                \r\n                <form onSubmit={onSave}>\r\n                    <div className={styles.inputsWrapper}>\r\n                        <div className={styles.inputWrapper}>\r\n                            <Input\r\n                                icon={'EditIcon'}\r\n                                type={'text'}\r\n                                placeholder={''}\r\n                                value={userData.name}\r\n                                onChange={\r\n                                    (event) => setUserData({\r\n                                        ...userData,\r\n                                        name: event.target.value\r\n                                    })\r\n                                }/>\r\n                        </div>\r\n\r\n                        <div className={styles.inputWrapper}>\r\n                            <Input\r\n                                icon={'EditIcon'}\r\n                                type={'text'}\r\n                                placeholder={''}\r\n                                value={userData.email}\r\n                                onChange={\r\n                                    (event) => setUserData({\r\n                                        ...userData,\r\n                                        email: event.target.value\r\n                                    })\r\n                                }/>\r\n                        </div>\r\n\r\n                        <div className={styles.inputWrapper}>\r\n                            <Input\r\n                                icon={'EditIcon'}\r\n                                type={userData.password ? 'password' : 'text'}\r\n                                placeholder={''}\r\n                                value={userData.password}\r\n                                onChange={\r\n                                    (event) => setUserData({\r\n                                        ...userData,\r\n                                        password: event.target.value\r\n                                    })\r\n                                }/>\r\n                        </div>\r\n\r\n                        <div className={styles.buttonsWrapper}>\r\n                            <Button type=\"primary\" size=\"large\"></Button>\r\n                            <Button type=\"primary\" size=\"large\" onClick={onCancel}></Button>\r\n                        </div>\r\n                    </div>\r\n                </form>   \r\n            </div>\r\n        </div> \r\n    );\r\n}\r\n","import {FC, ReactElement} from 'react';\r\n\r\nimport styles from './empty-page.module.css';\r\n\r\nexport const EmptyPage404: FC<{}> = (): ReactElement => {\r\n    return (\r\n        <p className={`text text_type_main-large ${styles.empty}`}>404</p>\r\n    );\r\n}\r\n","import {IIngredient} from '../../interfaces';\r\n\r\ninterface ITemp {\r\n    id: string;\r\n    count: number;\r\n}\r\n\r\ninterface IResult extends ITemp {\r\n    name: string;\r\n    price: number;\r\n    image_mobile: string;\r\n}\r\n\r\nexport const getBurgerIngredients = (ingredientIds: string[], allIngedients: IIngredient[]): IResult[] => {\r\n    const temp: ITemp[] = [];\r\n\r\n    ingredientIds.forEach(item => {\r\n        const count = ingredientIds.filter(element => element === item).length;\r\n\r\n        if (!temp.find(ingredient => ingredient?.id === item)) {\r\n            temp.push({\r\n                id: item,\r\n                count\r\n            });\r\n        }\r\n    });\r\n\r\n    return temp.map(item => {\r\n        const {name, price, image_mobile} = allIngedients.find(ingredient => ingredient._id === item.id) as IIngredient;\r\n\r\n        return {\r\n            ...item,\r\n            name,\r\n            price,\r\n            image_mobile\r\n        }\r\n    });\r\n}\r\n","import {IIngredient} from '../../interfaces';\r\n\r\nexport const getBurgerPrice = (ingredientIds: string[], allIngredients: IIngredient[]): number => {\r\n    const costs = ingredientIds.map(id => id !== null ? allIngredients.find(item => item._id === id)?.price : null);\r\n    return (costs as number[]).reduce((prev, curr) => prev + curr, 0);\r\n}\r\n","import {\r\n    MINUTES_IN_HOUR,\r\n    MILLISECONDS_IN_DAY,\r\n    FIVE_DAYS,\r\n    ELEVEN_DAYS,\r\n    FIFTEEN_DAYS,\r\n    WITHOUT_ZERO_MAX_TIME\r\n} from '../../services/constants';\r\n\r\nexport const getStrDataCreated = (createdAt: string): string => {\r\n    const checkForZeroes = (timeCount: number) => timeCount < WITHOUT_ZERO_MAX_TIME ? `0${timeCount}` : timeCount;\r\n\r\n    const getDaysInterval = (nowDate: number, agoDate: Date) => {\r\n        const days = Math.round((nowDate - new Date(agoDate).getTime()) / MILLISECONDS_IN_DAY);\r\n        const lastDaySymbol = parseInt(days.toString().substr(days.toString().length - 1, 1));\r\n\r\n        if (days === 0) {\r\n            return '';\r\n        } else if (days >= ELEVEN_DAYS && days < FIFTEEN_DAYS) {\r\n            return `${days}  `;\r\n        } else {\r\n            if (lastDaySymbol >= FIVE_DAYS) {\r\n                return `${days}  `;\r\n            }\r\n            if (lastDaySymbol > 1 && lastDaySymbol < FIVE_DAYS) {\r\n                return `${days}  `;\r\n            }\r\n            if (lastDaySymbol === 1) {\r\n                return `${days}  `;\r\n            }\r\n        }\r\n    };\r\n\r\n    const agoDate = new Date(createdAt);\r\n\r\n    const daysAgo = getDaysInterval(new Date().getTime(), agoDate);\r\n    const hours = checkForZeroes(agoDate.getHours());\r\n    const minutes = checkForZeroes(agoDate.getMinutes());\r\n    const gmt = `i-GMT${agoDate.getTimezoneOffset() / MINUTES_IN_HOUR}`;\r\n\r\n    return `${daysAgo} ${hours}:${minutes} ${gmt}`;\r\n}\r\n","export const getBurgerStatus = (status: string): '' | '' | '' => {\r\n    switch(status) {\r\n        case 'created':\r\n            return '';\r\n\r\n        case 'pending':\r\n            return '';\r\n\r\n        default:\r\n            return '';\r\n    }\r\n};\r\n","import {useEffect, useState, FC, ReactElement} from 'react';\r\nimport {useSelector, useDispatch} from '../services/utils/modified-react-hooks';\r\nimport {useParams} from 'react-router-dom';\r\n\r\nimport {CurrencyIcon} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport {SYMBOL_COUNT_START_ID_IN_URL} from '../services/constants';\r\nimport {getBurgerIngredients} from '../services/utils/get-burger-ingredients';\r\nimport {getBurgerPrice} from '../services/utils/get-burger-price';\r\nimport {getStrDataCreated} from '../services/utils/get-str-data-created';\r\nimport {getBurgerStatus} from '../services/utils/get-burger-status';\r\nimport {\r\n    WS_CONNECT_ORDER_TAPE,\r\n    WS_CONNECT_USER_ORDERS,\r\n    setUserFromServer\r\n} from '../services/actions/index';\r\nimport {getCookie} from '../services/utils/cookie-helper';\r\n\r\nimport {IOrderItem} from '../interfaces';\r\n\r\nimport styles from './order-info.module.css';\r\n\r\ninterface IOrderInfo {\r\n    showOrders: 'my' | 'all';\r\n}\r\n\r\ninterface IParams {\r\n    id: string;\r\n}\r\n\r\nexport const OrderInfo: FC<IOrderInfo> = ({showOrders}): ReactElement | null => {\r\n    const urlParams = useParams<IParams>();\r\n    const dispatch = useDispatch();\r\n    \r\n    const [burger, setBurger] = useState<IOrderItem | null>(null);\r\n\r\n    const {ingredients} = useSelector(store => store.ingredients);\r\n    const accessToken = useSelector(store => store.user.accessToken);\r\n\r\n    const orders = useSelector(store => showOrders === 'all' ? store.orderTape.orders : store.myOrders.orders);\r\n    \r\n    useEffect(() => {\r\n        if (!orders.length) {\r\n            switch(showOrders) {\r\n                case 'all':\r\n                    dispatch({\r\n                        type: WS_CONNECT_ORDER_TAPE,\r\n                        payload: {\r\n                            url: 'wss://norma.nomoreparties.space/orders/all'\r\n                        }\r\n                    });\r\n                    break;\r\n\r\n                case 'my':\r\n                    if (!accessToken) {\r\n                        dispatch(setUserFromServer());\r\n                    } else {\r\n                        dispatch({\r\n                            type: WS_CONNECT_USER_ORDERS,\r\n                            payload: {\r\n                                url: `wss://norma.nomoreparties.space/orders?token=${(getCookie('burgerAccessToken') as string).substr(7)}`\r\n                            }\r\n                        });\r\n                    }\r\n                    break;\r\n            }\r\n        } else {\r\n            setBurger(\r\n                orders.find(burger =>\r\n                    burger._id === urlParams.id.substr(SYMBOL_COUNT_START_ID_IN_URL, urlParams.id.length - 1)) as IOrderItem\r\n            );\r\n        }\r\n    }, [\r\n        dispatch,\r\n        orders,\r\n        accessToken,\r\n        showOrders,\r\n        urlParams.id\r\n    ]);\r\n\r\n    return (\r\n        burger ? (\r\n            <div className={styles.wrapper}>\r\n                <div className={styles.title}>\r\n                    <p className=\"text text_type_digits-default\">{`#${burger.number}`}</p>\r\n                </div>\r\n                <p className=\"text text_type_main-medium mb-2\">{burger.name}</p>\r\n                <p className={`text text_type_main-default ${styles.status}`}>{getBurgerStatus(burger.status)}</p>\r\n                <p className={`text text_type_main-medium ${styles.details}`}>:</p>\r\n                <div className={styles.orderDetailsWrapper}>\r\n                    {\r\n                        getBurgerIngredients(burger.ingredients, ingredients).map(item => (\r\n                            <div key={item.id} className={styles.ingredient}>\r\n                                <div className={styles.ingredientWrapper}>\r\n                                    <img alt=\"ingredient\" src={item.image_mobile} className={styles.img}/>\r\n                                    <p className=\"text text_type_main-default\">{item.name}</p>\r\n                                </div>\r\n                                <div className={styles.countCostWrapper}>\r\n                                    <p className={`text text_type_digits-default ${styles.cost}`}>{item.count} x {item.price}</p>\r\n                                    <CurrencyIcon type=\"primary\"/>\r\n                                </div>\r\n                            </div>\r\n                        ))\r\n                    }\r\n                </div>\r\n\r\n                <div className={styles.footer}>\r\n                    <p className={`text text_type_main-default ${styles.footerText}`}>{getStrDataCreated(burger.createdAt)}</p>\r\n                    <div className={styles.countWrapper}>\r\n                        <p className={`text text_type_digits-default ${styles.cost}`}>{getBurgerPrice(burger.ingredients, ingredients)}</p>\r\n                        <CurrencyIcon type=\"primary\"/>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        ) : null\r\n    );\r\n}\r\n","import {FC, ReactElement} from 'react';\r\nimport {useSelector} from '../../services/utils/modified-react-hooks';\r\n\r\nimport {getBurgerStatus} from '../../services/utils/get-burger-status';\r\nimport {getStrDataCreated} from '../../services/utils/get-str-data-created';\r\nimport {getBurgerPrice} from '../../services/utils/get-burger-price';\r\n\r\nimport {CurrencyIcon} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport {IIngredient, IOrderItem} from '../../interfaces';\r\n\r\nimport {\r\n    LAST_VISIBLE_INGREDIENTS,\r\n    MAX_VISIBLE_INGREDIENTS,\r\n    RIGHT_INGREDIENT_POSITION\r\n} from '../../services/constants';\r\n\r\nimport styles from './burger.module.css';\r\n\r\ninterface IBurger {\r\n    needStatus?: boolean;\r\n    data: IOrderItem;\r\n}\r\n\r\nexport const Burger: FC<IBurger> = ({data, needStatus = false}): ReactElement => {\r\n    const {createdAt, name, number, status} = data;\r\n    const {ingredients} = useSelector(store => store.ingredients);\r\n\r\n    return (\r\n        <div className={styles.wrapper}>\r\n            <div className={styles.titleWrapper}>\r\n                <p className=\"text text_type_digits-default\">{`#${number}`}</p>\r\n                <p className={`text text_type_main-default ${styles.titleTime}`}>{getStrDataCreated(createdAt)}</p>\r\n            </div>\r\n\r\n            <div className={styles.textWrapper}>\r\n                <p className={`text text_type_main-medium ${styles.captionBurger}`}>{name}</p>\r\n                {\r\n                    needStatus\r\n                        ? <p className={`text text_type_main-default ${status === 'pending' && styles.cancelled} ${status === 'done' && styles.inWork}`}>{getBurgerStatus(status)}</p>\r\n                        : null\r\n                }\r\n            </div>\r\n                \r\n            <div className={styles.burgerWrapper}>\r\n                <div className={styles.ingredientsWrapper}>\r\n                    {\r\n                        data.ingredients.map((id, index) => {\r\n                            if (id !== null) {\r\n                                if (index < MAX_VISIBLE_INGREDIENTS) {\r\n                                    if (index === LAST_VISIBLE_INGREDIENTS) {\r\n                                        return (\r\n                                            <div key={id} className={styles.imgWrapper} style={{\r\n                                                zIndex: data.ingredients.length - index,\r\n                                                right: `${RIGHT_INGREDIENT_POSITION * index}px`\r\n                                            }}>\r\n                                                <div className={styles.ingredientCount}>\r\n                                                    <p className=\"text text_type_main-default\">\r\n                                                        +{data.ingredients.length - index}\r\n                                                    </p>\r\n                                                </div>\r\n                                                <img alt=\"ingredient\" className={styles.img} style={{\r\n                                                    position: 'absolute'\r\n                                                }} src={(ingredients.find(item => item._id === id) as IIngredient).image_mobile}/>\r\n                                            </div>\r\n                                        )\r\n                                    } else {\r\n                                        return (\r\n                                            <img alt=\"ingredient\" key={id + index} className={styles.img} style={{\r\n                                                zIndex: data.ingredients.length - index,\r\n                                                right: `${index === 0 ? 0 : RIGHT_INGREDIENT_POSITION * index}px`\r\n                                            }} src={(ingredients.find(item => item._id === id) as IIngredient).image_mobile}/>\r\n                                        );\r\n                                    }\r\n                                } else {\r\n                                    return null;\r\n                                }\r\n                            } else {\r\n                                return null;\r\n                            }\r\n                        })\r\n                    }\r\n                </div>\r\n\r\n                <div className={styles.costWrapper}>\r\n                    <p className={`text text_type_digits-default ${styles.cost}`}>{getBurgerPrice(data.ingredients, ingredients)}</p>\r\n                    <CurrencyIcon type=\"primary\" />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import {FC, ReactElement} from 'react';\r\n\r\nimport {IStatusNumbers} from '../../interfaces';\r\n\r\nimport styles from './order-total.module.css';\r\n\r\ninterface IOrderTotal {\r\n    total: number;\r\n    totalToday: number;\r\n    statusNumbers: IStatusNumbers;\r\n}\r\n\r\nexport const OrderTotal: FC<IOrderTotal> = ({statusNumbers, total, totalToday}): ReactElement => {\r\n    const {done, inWork} = statusNumbers;\r\n\r\n    return (\r\n        <div className={styles.orderTotal}>\r\n            <div className={styles.numbersWrapper}>\r\n                <div>\r\n                    <p className={`text text_type_main-medium ${styles.ready}`}>:</p>    \r\n                    <div className={styles.itemsWrapper}>\r\n                        {\r\n                            done.map(item =>\r\n                                <p key={item} className={`text text_type_digits-default ${styles.item} ${styles.readyColor}`}>\r\n                                    {item}\r\n                                </p>\r\n                            )\r\n                        }\r\n                    </div>\r\n                </div>\r\n                <div>\r\n                    <p className={`text text_type_main-medium ${styles.ready}`}> :</p>\r\n                    <div className={styles.itemsWrapper}>\r\n                        {\r\n                            inWork.map(item =>\r\n                                <p key={item} className={`text text_type_digits-default ${styles.item}`}>\r\n                                    {item}\r\n                                </p>\r\n                            )\r\n                        }\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <p className=\"text text_type_main-medium\">   :</p>\r\n            <p className={`text text_type_digits-large ${styles.count}`}>{total}</p>\r\n\r\n            <p className=\"text text_type_main-medium\">  :</p>\r\n            <p className={`text text_type_digits-large ${styles.count}`}>{totalToday}</p>\r\n        </div>\r\n    );\r\n}\r\n","import {IStatusNumbers, IOrderItem} from '../../interfaces';\r\n\r\nexport const getOrdersStatuses = (orders: IOrderItem[]): IStatusNumbers => {\r\n    const result = {\r\n        done: [],\r\n        inWork: []\r\n    };\r\n    \r\n    const done = orders.filter(item => item.status === 'done');\r\n    const inWork = orders.filter(item => item.status === 'pending');\r\n\r\n    const setMaxLength = (dataArray: IOrderItem[], resultArray: number[]): void => {\r\n        if (dataArray.length > 10) {\r\n            for (let i = 0; i < 10; i++) {\r\n                resultArray.push(dataArray[i].number);\r\n            }\r\n        } else {\r\n            for (let i = 0; i !== dataArray.length; i++) {\r\n                resultArray.push(dataArray[i].number);\r\n            }\r\n        }\r\n    }\r\n\r\n    setMaxLength(done, result.done);\r\n    setMaxLength(inWork, result.inWork);\r\n\r\n    return result;\r\n};\r\n","import {useEffect, FC, ReactElement} from 'react';\r\n\r\nimport {Link, useLocation} from 'react-router-dom';\r\nimport {useSelector, useDispatch} from '../services/utils/modified-react-hooks';\r\n\r\nimport {Burger} from '../components/burger/burger';\r\nimport {OrderTotal} from '../components/order-total/order-total';\r\nimport {getOrdersStatuses} from '../services/utils/get-orders-statuses';\r\n\r\nimport {WS_CONNECT_ORDER_TAPE, WS_DISCONNECT_ORDER_TAPE} from '../services/actions/index';\r\n\r\nimport styles from './order-tape.module.css';\r\n\r\nexport const OrderTape: FC<{}> = (): ReactElement => {\r\n    const location = useLocation();\r\n    const dispatch = useDispatch();\r\n\r\n    const {orders, total, totalToday} = useSelector(store => store.orderTape);\r\n\r\n    useEffect(() => {\r\n        dispatch({\r\n            type: WS_CONNECT_ORDER_TAPE,\r\n            payload: {\r\n                url: 'wss://norma.nomoreparties.space/orders/all'\r\n            }\r\n        });\r\n\r\n        return () => {\r\n            dispatch({\r\n                type: WS_DISCONNECT_ORDER_TAPE\r\n            });\r\n        };\r\n    }, [dispatch]);\r\n\r\n    return (\r\n        <div className={styles.mainWrapper}>\r\n            <div className={styles.wrapper}>\r\n                {\r\n                    orders.length ? (\r\n                        <>\r\n                            <p className={`text text_type_main-large ${styles.title}`}> </p>\r\n                            <div className={styles.mainBlock}>\r\n                                <div className={styles.burgers}>\r\n                                    {\r\n                                        orders.map((item, index) => {\r\n                                            return (\r\n                                                <Link key={index} className={styles.link} to={{\r\n                                                    pathname: `/feed/id${item._id}`,\r\n                                                    state: {\r\n                                                        modal: location\r\n                                                    }\r\n                                                }}>\r\n                                                    <div className={styles.itemWrapper}>\r\n                                                        <Burger data={item}/>\r\n                                                    </div>\r\n                                                </Link>\r\n                                            );\r\n                                        }) \r\n                                    }\r\n                                </div>\r\n                                <OrderTotal statusNumbers={getOrdersStatuses(orders)} total={total} totalToday={totalToday}/>\r\n                            </div>\r\n                        </>\r\n                    ) : null\r\n                }\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import {Link, useLocation} from 'react-router-dom';\r\nimport {useEffect, FC, ReactElement} from 'react';\r\nimport {useDispatch, useSelector} from '../services/utils/modified-react-hooks';\r\n\r\nimport {ProfileLinks} from '../components/profile-links/profile-links';\r\nimport {Burger} from '../components/burger/burger';\r\n\r\nimport {WS_CONNECT_USER_ORDERS, WS_DISCONNECT_USER_ORDERS} from '../services/actions/index';\r\nimport {getCookie} from '../services/utils/cookie-helper';\r\nimport {setUserFromServer} from '../services/actions/index';\r\n\r\nimport styles from './order-history.module.css';\r\n\r\nexport const OrderHistory = () => {\r\n    const location = useLocation();\r\n    const dispatch = useDispatch();\r\n    \r\n    const accessToken = useSelector(store => store.user.accessToken);\r\n    const orders = useSelector(store => store.myOrders.orders);\r\n\r\n    useEffect(() => {\r\n        if (!accessToken) {\r\n            dispatch(setUserFromServer());\r\n        } else {\r\n            dispatch({\r\n                type: WS_CONNECT_USER_ORDERS,\r\n                payload: {\r\n                    url: `wss://norma.nomoreparties.space/orders?token=${(getCookie('burgerAccessToken') as string).substr(7)}`\r\n                }\r\n            });\r\n        }\r\n    }, [dispatch, accessToken]);\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            dispatch({\r\n                type: WS_DISCONNECT_USER_ORDERS\r\n            })\r\n        }\r\n    }, [dispatch]);\r\n\r\n    return (\r\n        <div className={styles.mainWrapper}>\r\n            <div className={styles.wrapper}>\r\n                <div className={styles.linksWrapper}>\r\n                    <ProfileLinks/>\r\n                </div>\r\n\r\n                <div className={styles.burgers}>\r\n                    {\r\n                        [...orders].reverse().map(item => (\r\n                            <Link className={styles.link} key={item._id} to={{\r\n                                pathname: `/profile/orders/id${item._id}`,\r\n                                state: {\r\n                                    modal: location\r\n                                }\r\n                            }}>\r\n                                <div className={styles.itemWrapper}>\r\n                                    <Burger data={item} needStatus={true}/>\r\n                                </div>\r\n                            </Link>\r\n                        ))\r\n                    }\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import {useMemo, FC, ReactElement} from 'react';\r\nimport {useSelector} from '../../../services/utils/modified-react-hooks';\r\nimport {useDrag} from 'react-dnd';\r\n\r\nimport {MAX_BUNS_COUNT} from '../../../services/constants';\r\n\r\nimport {CurrencyIcon, Counter} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport {IIngredient} from '../../../interfaces';\r\n\r\nimport productStyle from './product.module.css';\r\n\r\ninterface IProduct {\r\n    data: IIngredient;\r\n}\r\n\r\nconst Product: FC<IProduct> = ({data}): ReactElement => {\r\n    const {bun, fillings} = useSelector(store => store.constructorIngredients);\r\n    \r\n    const counter = useMemo(() => {\r\n        if ('_id' in bun && bun._id === data._id) return MAX_BUNS_COUNT;\r\n\r\n        return fillings.filter(element => element._id === data._id).length;\r\n    }, [bun, fillings, data._id]);\r\n\r\n    const [, dragRef] = useDrag({\r\n        type: data.type,\r\n        item: {\r\n            id: data._id,\r\n            type: data.type\r\n        }\r\n    });\r\n\r\n    return (\r\n        <>\r\n            <div data-qa=\"product-component\" ref={dragRef} className={productStyle.ingredient}>\r\n                <img alt=\"ingredient\" className=\"mb-1\" src={data.image}/>\r\n                <div className={productStyle.costWrapper}>\r\n                    <p className=\"text text_type_digits-default mr-1 mb-1\">{data.price}</p>\r\n                    <CurrencyIcon type=\"primary\"/>\r\n                </div>\r\n                <p className={`text text_type_main-default ${productStyle.nameIngredient}`}>{data.name}</p>\r\n            </div>\r\n            {\r\n                counter ? <Counter count={counter} size=\"default\"/> : null\r\n            }\r\n        </>\r\n    );\r\n}\r\n\r\nexport default Product;\r\n","import React, {FC, ReactElement} from 'react';\r\n\r\nimport {useSelector} from '../../../services/utils/modified-react-hooks';\r\nimport {Link, useLocation} from 'react-router-dom';\r\n\r\nimport Product from '../product/product';\r\n\r\nimport productGroup from './product-group.module.css';\r\n\r\ninterface IProductGroup {\r\n    ingredientType: 'bun' | 'sauce' | 'main';\r\n}\r\n\r\nconst ProductGroup: FC<IProductGroup> = ({ingredientType}): ReactElement => {\r\n    const {ingredients} = useSelector(state => state.ingredients);\r\n\r\n    const location = useLocation();\r\n\r\n    return (\r\n        <ul className={`pt-3 pb-3 pr-1 pl-2 ${productGroup.info}`}>\r\n            {\r\n                ingredients.map(item => item.type === ingredientType && \r\n                    (\r\n                        <li data-cy=\"ingredient\" key={item._id} className={productGroup.ingredientWrapper}>\r\n                            <Link to={{\r\n                                pathname: `/ingredients/${item._id}`,\r\n                                state: {\r\n                                    modal: location\r\n                                }\r\n                            }} className={productGroup.btn}>\r\n                                <Product data={item}/>\r\n                            </Link>\r\n                        </li>\r\n                    )\r\n                )\r\n            }\r\n        </ul>\r\n    );\r\n}\r\n\r\nexport default React.memo(ProductGroup);\r\n","import React, {useState, useRef, FC, ReactElement} from 'react';\r\n\r\nimport {Tab} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport ProductGroup from './product-group/product-group';\r\n\r\nimport {LOW_PARENT_TOP, HIGH_PARENT_TOP} from '../../services/constants';\r\n\r\nimport ingredientsStyle from './burger-ingredients.module.css';\r\n\r\nconst BurgerIngredients: FC<{}> = (): ReactElement => {\r\n    const [tab, setTab] = useState('breads');\r\n\r\n    const breadsGroup = useRef<HTMLDivElement>(null);\r\n    const saucesGroup = useRef<HTMLDivElement>(null);\r\n    const fillingsGroup = useRef<HTMLDivElement>(null);\r\n    const ingredientBlock = useRef<HTMLDivElement>(null);\r\n\r\n    const onTabClick = (currentTab: 'breads' | 'sauces' | 'fillings'): void => {\r\n        const scrollParameter: ScrollIntoViewOptions = {\r\n            behavior: 'smooth'\r\n        };\r\n\r\n        setTab(currentTab);\r\n\r\n        switch(currentTab) {\r\n            case 'breads':\r\n                breadsGroup.current !== null && breadsGroup.current.scrollIntoView(scrollParameter);\r\n                break;\r\n            case 'sauces':\r\n                saucesGroup.current !== null && saucesGroup.current.scrollIntoView(scrollParameter);\r\n                break;\r\n            default:\r\n                fillingsGroup.current !== null && fillingsGroup.current.scrollIntoView(scrollParameter);\r\n                break;\r\n        }\r\n    };\r\n\r\n    const onScrollTab = (): void => {\r\n        const parentTop: number = ingredientBlock.current !== null ? ingredientBlock.current.getBoundingClientRect().top : 0;\r\n        const breadTop: number = breadsGroup.current !== null ? breadsGroup.current.getBoundingClientRect().top : 0;\r\n        const saucesTop: number = saucesGroup.current !== null ? saucesGroup.current.getBoundingClientRect().top : 0;\r\n        const fillingsTop: number = fillingsGroup.current !== null ? fillingsGroup.current.getBoundingClientRect().top : 0;\r\n\r\n        const breadPos: number = breadTop - parentTop;\r\n        const saucesPos: number = saucesTop - parentTop;\r\n        const fillingsPos: number = fillingsTop - parentTop;\r\n\r\n        if (breadPos < HIGH_PARENT_TOP && breadPos >= LOW_PARENT_TOP) {\r\n            setTab('breads');\r\n        }\r\n\r\n        if (saucesPos < HIGH_PARENT_TOP && saucesTop >= LOW_PARENT_TOP) {\r\n            setTab('sauces');\r\n        }\r\n\r\n        if (fillingsPos < HIGH_PARENT_TOP && fillingsPos >= LOW_PARENT_TOP) {\r\n            setTab('fillings');\r\n        }\r\n    }\r\n\r\n    return (\r\n        <section className={ingredientsStyle.wrapper}>\r\n            <p className={`text text_type_main-large ${ingredientsStyle.title}`}> </p>\r\n            <div data-testid=\"tabs\" className={ingredientsStyle.tabs}>\r\n                <Tab value=\"breads\" active={tab === 'breads'} onClick={() => onTabClick('breads')}></Tab>\r\n                <Tab value=\"sauces\" active={tab === 'sauces'} onClick={() => onTabClick('sauces')}></Tab>\r\n                <Tab value=\"fillings\" active={tab === 'fillings'} onClick={() => onTabClick('fillings')}></Tab>\r\n            </div>\r\n            <div data-cy=\"ingredients-list\" ref={ingredientBlock} onScroll={onScrollTab} className={ingredientsStyle.menuWrapper}>\r\n                <div data-cy=\"buns\" ref={breadsGroup} className={ingredientsStyle.block}>\r\n                    <p className=\"text text_type_main-medium\"></p>\r\n                    <ProductGroup ingredientType=\"bun\"/>\r\n                </div>\r\n                <div data-cy=\"sauces\" ref={saucesGroup} className={ingredientsStyle.block}>\r\n                    <p className=\"text text_type_main-medium\"></p>\r\n                    <ProductGroup ingredientType=\"sauce\"/>\r\n                </div>\r\n                <div data-cy=\"fillings\" ref={fillingsGroup} className={ingredientsStyle.block}>\r\n                    <p className=\"text text_type_main-medium\"></p>\r\n                    <ProductGroup ingredientType=\"main\"/>\r\n                </div>\r\n            </div>\r\n        </section>\r\n    );\r\n}\r\n\r\nexport default React.memo(BurgerIngredients);\r\n","import {useRef, useCallback, FC, ReactElement} from 'react';\r\nimport {useDispatch, useSelector} from '../../../services/utils/modified-react-hooks';\r\nimport {useDrag, useDrop} from 'react-dnd';\r\n\r\nimport {actions as constructorActions} from '../../../services/slices/constructor';\r\n\r\nimport {ConstructorElement, DragIcon} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport {IIngredient} from '../../../interfaces';\r\n\r\nimport fillingStyle from './burger-filling.module.css';\r\n\r\ninterface IBurgerFilling {\r\n    element: IIngredient;\r\n    index: number;\r\n}\r\n\r\ninterface IDrop {\r\n    indexDrag: number;\r\n}\r\n\r\nconst BurgerFilling: FC<IBurgerFilling> = ({index, element}): ReactElement => {\r\n    const dispatch = useDispatch();\r\n\r\n    const {deleteIngredient, updateFillings} = constructorActions;\r\n\r\n    const {fillings} = useSelector(store => store.constructorIngredients);\r\n    \r\n    const ref = useRef<HTMLDivElement>(null);\r\n\r\n    const del = useCallback((index) => dispatch(deleteIngredient(fillings.filter((item, number) => number !== index))), [dispatch, fillings, deleteIngredient]);\r\n\r\n    const moveCard = useCallback(({indexDrag}, {indexDrop}) => {\r\n        const temp = [...fillings];\r\n\r\n        temp[indexDrag] = fillings.find((item, index) => index === indexDrop) as IIngredient;\r\n        temp[indexDrop] = fillings.find((item, index) => index === indexDrag) as IIngredient;\r\n\r\n        dispatch(updateFillings(temp));\r\n    }, [dispatch, fillings, updateFillings]);\r\n\r\n    const [, dragRef] = useDrag({\r\n        type: 'fillings',\r\n        item: {\r\n            indexDrag: index\r\n        }\r\n    });\r\n\r\n    const [{isTarget}, dropRef] = useDrop({\r\n        accept: 'fillings',\r\n        collect: monitor => ({\r\n            isTarget: monitor.isOver()\r\n        }),\r\n        drop(item: IDrop, monitor) {\r\n            const dragIndex = item.indexDrag;\r\n            const hoverIndex = index;\r\n            const hoverBoundingRect = ref.current?.getBoundingClientRect();\r\n            const clientOffset = monitor.getClientOffset();\r\n            const hoverMiddleY = hoverBoundingRect && (hoverBoundingRect.bottom - hoverBoundingRect.top);\r\n            const hoverClientY = clientOffset && hoverBoundingRect && (clientOffset.y - hoverBoundingRect.top);\r\n            \r\n            if (!ref.current || dragIndex === hoverIndex ||\r\n                (dragIndex < hoverIndex && hoverClientY === hoverMiddleY) ||\r\n                    (dragIndex > hoverIndex && hoverClientY === hoverMiddleY)) {\r\n                return;\r\n            }\r\n\r\n            moveCard(item, {\r\n                indexDrop: index\r\n            });\r\n        }\r\n    });\r\n\r\n    dragRef(dropRef(ref));\r\n\r\n    return (\r\n        <div ref={ref} className={`mb-2 ${fillingStyle.fillingIngredient} ${isTarget && fillingStyle.target}`}>\r\n            <ConstructorElement\r\n                handleClose={() => del(index)}\r\n                thumbnail={element.image_mobile}\r\n                text={element.name}\r\n                price={element.price}\r\n                isLocked={false}/>\r\n            <DragIcon type=\"primary\"/>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default BurgerFilling;\r\n","import {URL_ORDER, URL_UPDATE_TOKEN} from '../constants';\r\nimport {getCookie, deleteCookie, setCookie} from './cookie-helper';\r\n\r\nimport {IItem} from '../../interfaces';\r\n\r\nexport const getOrderDetails = async (iDs: string[]): Promise<IItem | undefined> => {\r\n    const headers = new Headers();\r\n    headers.set('Content-Type', 'application/json');\r\n    headers.set('authorization', getCookie('burgerAccessToken') as string);\r\n\r\n    try {\r\n        const request = await fetch(URL_ORDER, {\r\n            method: 'POST',\r\n            headers,\r\n            body: JSON.stringify({\r\n              ingredients: iDs\r\n            })\r\n        });\r\n    \r\n        if (!request.ok) {\r\n            const error: Error = await request.json();\r\n            throw new Error(error.message);\r\n        }\r\n\r\n        return await request.json();\r\n    } catch (error) {\r\n        if (error.message === 'jwt expired') {\r\n            deleteCookie('burgerAccessToken');\r\n                \r\n            try {\r\n                const request = await fetch(URL_UPDATE_TOKEN, {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/json;charset=utf-8'\r\n                    },\r\n                    body: JSON.stringify({token: localStorage.getItem('burgerRefreshToken')})\r\n                });\r\n        \r\n                if (!request.ok) {\r\n                    throw new Error('  .');\r\n                }\r\n                \r\n                const data = await request.json();\r\n        \r\n                setCookie('burgerAccessToken', data.accessToken);\r\n                localStorage.setItem('burgerRefreshToken', data.refreshToken);\r\n                \r\n                return await getOrderDetails(iDs);\r\n            } catch (error) {\r\n                console.log(error.message);\r\n            }\r\n        } else {\r\n            return error;\r\n        }\r\n    }\r\n}\r\n","import {useCallback, useState, useEffect, FC, ReactElement} from 'react';\r\nimport {useLocation, useHistory} from 'react-router-dom';\r\nimport {useDispatch, useSelector} from '../../../services/utils/modified-react-hooks';\r\n\r\nimport {getOrderDetails} from '../../../services/utils/get-order-details';\r\nimport {getCookie} from '../../../services/utils/cookie-helper';\r\n\r\nimport {Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport {IOrderItem, IItem, IIngredient} from '../../../interfaces';\r\n\r\nimport styles from './confirm-button.module.css';\r\n\r\nexport const ConfirmButton: FC<{}> = (): ReactElement => {\r\n    const location = useLocation();\r\n    const history = useHistory();\r\n    const dispatch = useDispatch();\r\n\r\n    const {bun, fillings} = useSelector(store => store.constructorIngredients);\r\n\r\n    const [buttonAvailible, setAvailible] = useState({\r\n        text: ' ',\r\n        isBlocked: false\r\n    });\r\n\r\n    const openModal = useCallback(async () => {\r\n        if (Object.keys(bun).length) {\r\n            if (getCookie('burgerAccessToken')?.length) {\r\n                setAvailible({\r\n                    text: ' ',\r\n                    isBlocked: true\r\n                });\r\n            }\r\n\r\n            dispatch({\r\n                type: 'modal/setStartInfo'\r\n            });\r\n\r\n            history.push({\r\n                pathname: '/start-order',\r\n                state: {\r\n                    modal: location\r\n                }\r\n            });\r\n\r\n            try {\r\n                const item: IItem | undefined = await getOrderDetails([\r\n                    (bun as IIngredient)._id as string,\r\n                    ...fillings.map(item => item._id),\r\n                    (bun as IIngredient)._id as string\r\n                ]);\r\n\r\n                if (item instanceof Error) {\r\n                    throw new Error();\r\n                }\r\n\r\n                if (window.location.pathname === '/start-order') {\r\n                    dispatch({\r\n                        type: 'modal/setEndInfo',\r\n                        payload: {\r\n                            number: item?.order.number,\r\n                            name: item?.name\r\n                        }\r\n                    });\r\n                } else if (window.location.pathname === '/') {\r\n                    dispatch({\r\n                        type: 'modal/setEndInfo',\r\n                        payload: {\r\n                            number: item?.order.number,\r\n                            name: item?.name\r\n                        }\r\n                    });\r\n\r\n                    history.push({\r\n                        pathname: '/start-order',\r\n                        state: {\r\n                            modal: location\r\n                        }\r\n                    });\r\n                }\r\n\r\n                setAvailible({\r\n                    text: ' ',\r\n                    isBlocked: false\r\n                });\r\n            } catch (error) {\r\n                console.log(error);\r\n            }\r\n        }\r\n    }, [bun, fillings, history, location, dispatch]);\r\n\r\n    useEffect(() => () => setAvailible({\r\n        text: ' ',\r\n        isBlocked: false\r\n    }), []);\r\n\r\n    return (\r\n        <>\r\n            <Button\r\n                onClick={!buttonAvailible.isBlocked ? openModal : () => {}}\r\n                type=\"primary\"\r\n                size=\"large\">\r\n                    {\r\n                        !buttonAvailible.isBlocked ? buttonAvailible.text : (\r\n                            <div>\r\n                                <span className={styles.spinner}>\r\n                                    <span className={styles.bottom}></span>\r\n                                    <span className={styles.top}></span>\r\n                                </span>\r\n                                <span className={styles.loading}>{buttonAvailible.text}</span>\r\n                            </div>\r\n                        )\r\n                    }\r\n            </Button>\r\n        </>\r\n    );\r\n}\r\n","import React, {useMemo, FC, ReactElement} from 'react';\r\nimport {useSelector, useDispatch} from '../../services/utils/modified-react-hooks';\r\nimport {useDrop, DndProvider} from 'react-dnd';\r\nimport {HTML5Backend} from 'react-dnd-html5-backend';\r\n\r\nimport {MAX_BUNS_COUNT} from '../../services/constants';\r\n\r\nimport {actions as constructorActions} from '../../services/slices/constructor';\r\n\r\nimport BurgerFilling from './burger-filling/burger-filling';\r\n\r\nimport {ConfirmButton} from './confirm-button/confirm-button';\r\n\r\nimport {ConstructorElement, DragIcon, CurrencyIcon} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport {IIngredient} from '../../interfaces';\r\n\r\nimport constructorStyle from './burger-constructor.module.css';\r\n\r\n// css- -    ConstructorElement -    -    UI-\r\nimport './burger-constructor.css';\r\n\r\ninterface IDropItem {\r\n    id: string;\r\n    type: 'bun' | 'main' | 'sauce';\r\n}\r\n\r\nconst BurgerConstructor: FC<{}> = (): ReactElement | null => {\r\n    const dispatch = useDispatch();\r\n\r\n    const {setBuns, setFillings} = constructorActions;\r\n\r\n    const {blockedAll} = useSelector(store => store.ingredients);\r\n    const {bun, fillings} = useSelector(store => store.constructorIngredients);\r\n    const {ingredients} = useSelector(store => store.ingredients);\r\n\r\n    const totalCost = useMemo(() => {\r\n        const result: number[] = [];\r\n\r\n        if ('price' in bun) {\r\n            result.push(bun.price * MAX_BUNS_COUNT || 0);\r\n        }\r\n        \r\n        result.push(fillings.reduce((prev, current) => prev + current.price, 0) || 0);\r\n\r\n        return result.reduce((prev, curr) => prev + curr, 0);\r\n    }, [bun, fillings]);\r\n\r\n    const [, dropRef] = useDrop({\r\n        accept: ['bun', 'main', 'sauce'],\r\n        drop(item: IDropItem) {\r\n            switch(item.type) {\r\n                case 'bun':\r\n                    dispatch(setBuns(ingredients.find(ingredient => ingredient._id === item.id) as IIngredient));\r\n                    break;\r\n\r\n                case 'main':\r\n                    dispatch(setFillings(ingredients.find(ingredient => ingredient._id === item.id) as IIngredient));\r\n                    break;\r\n\r\n                case 'sauce':\r\n                    dispatch(setFillings(ingredients.find(ingredient => ingredient._id === item.id) as IIngredient));\r\n                    break;\r\n\r\n                default:\r\n                    return;\r\n            }\r\n        }\r\n    });\r\n    \r\n    return (\r\n        !blockedAll ? (\r\n            <section className={constructorStyle.wrapper}>\r\n                {\r\n                    <div data-cy=\"constructor\" ref={dropRef} className={constructorStyle.itemWrapper}>\r\n                        {\r\n                            Object.keys(bun).length || fillings.length ? (\r\n                                <>\r\n                                    {\r\n                                        Object.keys(bun).length ? (\r\n                                            <div className=\"mb-2 mr-1\">\r\n                                                <div className={`mb-2 ${constructorStyle.ingredient}`}>\r\n                                                    <ConstructorElement \r\n                                                        thumbnail={'image_mobile' in bun ? bun.image_mobile : ''}\r\n                                                        text={\r\n                                                            (<div>\r\n                                                                <div>{'name' in bun ? bun.name : ''}</div>\r\n                                                                <div>()</div>\r\n                                                            </div>) as unknown as string\r\n                                                        }\r\n                                                        price={'price' in bun ? bun.price : 0}\r\n                                                        isLocked={true}\r\n                                                        type=\"top\"/>\r\n                                                    <DragIcon type=\"primary\"/>\r\n                                                </div>\r\n                                            </div>\r\n                                        ) : null\r\n                                    }\r\n                                    {\r\n                                        fillings.length ? (\r\n                                            <DndProvider backend={HTML5Backend}>\r\n                                                <div data-cy=\"filling-arr\" className={constructorStyle.mainIngredientsWrapper}>\r\n                                                    {\r\n                                                        fillings.map((element, index) =>\r\n                                                            <BurgerFilling key={`${element._id}${index}`} element={element} index={index}/>\r\n                                                        )  \r\n                                                    }\r\n                                                </div>\r\n                                            </DndProvider>\r\n                                        ) : null\r\n                                    }\r\n                                    {\r\n                                        Object.keys(bun).length ? (\r\n                                            <div className=\"mt-2 mr-1\">\r\n                                                <div className={`mb-2 ${constructorStyle.ingredient}`}>\r\n                                                    <ConstructorElement \r\n                                                        thumbnail={'image_mobile' in bun ? bun.image_mobile : ''}\r\n                                                        text={\r\n                                                            (<div>\r\n                                                                <div>{'name' in bun ? bun.name : ''}</div>\r\n                                                                <div>()</div>\r\n                                                            </div>) as unknown as string\r\n                                                        }\r\n                                                        price={'price' in bun ? bun.price : 0}\r\n                                                        isLocked={true}\r\n                                                        type=\"bottom\"/>\r\n                                                    <DragIcon type=\"primary\"/>\r\n                                                </div>\r\n                                            </div>\r\n                                        ) : null\r\n                                    }\r\n                                </>\r\n                            ) : (\r\n                                <div className={constructorStyle.emptyWrapper}>\r\n                                    <p className=\"text text_type_main-default\">   </p>\r\n                                </div>\r\n                            )\r\n                        }\r\n                    </div>\r\n                }\r\n\r\n                <div className={`mr-2 ${constructorStyle.footerWrapper}`}>\r\n                    <div className={constructorStyle.summWrapper}>\r\n                        <p className={`text text_type_digits-default ${constructorStyle.summText}`}>{totalCost}</p>\r\n                        <CurrencyIcon type=\"primary\"/>\r\n                    </div>\r\n                    <ConfirmButton/>\r\n                </div>\r\n            </section>\r\n        ) : null\r\n    );\r\n}\r\n\r\nexport default React.memo(BurgerConstructor);\r\n","import {FC, ReactElement} from 'react';\r\nimport {DndProvider} from 'react-dnd';\r\nimport {HTML5Backend} from 'react-dnd-html5-backend';\r\n\r\nimport BurgerIngredients from '../components/burger-ingredients/burger-ingredients';\r\nimport BurgerContructor from '../components/burger-constructor/burger-constructor';\r\n\r\nimport styles from './ingredients-constructor.module.css';\r\n\r\nexport const IngredientsConstructor: FC<{}> = (): ReactElement => {\r\n    return (\r\n        <div className={styles.wrapper}>\r\n            <DndProvider backend={HTML5Backend}>\r\n                <BurgerIngredients/>\r\n                <BurgerContructor/>\r\n            </DndProvider>\r\n        </div>\r\n    );\r\n}\r\n","import {useEffect, FC, ReactElement} from 'react';\r\nimport {useDispatch} from '../../services/utils/modified-react-hooks';\r\nimport {Route, Switch, useLocation, useHistory} from 'react-router-dom';\r\n\r\nimport {getIngredients} from '../../services/actions/index';\r\n\r\nimport AppHeader from '../app-header/app-header';\r\nimport {Modal} from '../modal/modal';\r\nimport {IngredientDetails} from '../ingredient-details/ingredient-details';\r\nimport {OrderDetails} from '../order-details/order-details';\r\nimport {ProtectedRoute} from '../protected-route/protected-route';\r\n\r\nimport {\r\n  Registration,\r\n  Autorization,\r\n  RecoveryPassword,\r\n  ResetPassword,\r\n  UserProfile,\r\n  EmptyPage404,\r\n  OrderTape,\r\n  OrderHistory,\r\n  OrderInfo,\r\n  IngredientsConstructor\r\n} from '../../pages';\r\n\r\nimport {Location} from 'history';\r\nimport {ILocationState} from '../../interfaces';\r\n\r\nimport appStyle from './app.module.css';\r\n\r\nconst App: FC<{}> = (): ReactElement => {\r\n  const location = useLocation<ILocationState>();\r\n  const dispatch = useDispatch();\r\n  const history = useHistory();\r\n\r\n  const modalBackground: Location | undefined = location.state && location.state.modal;\r\n\r\n  if (history.action === 'POP') {\r\n    location.state = {};\r\n  }\r\n\r\n  useEffect(() => {\r\n    dispatch(getIngredients())\r\n  }, [dispatch]);\r\n\r\n  return (\r\n    <>\r\n      <AppHeader/>\r\n      <main className={appStyle.mainWrapper}>\r\n        <Switch location={modalBackground || location}>\r\n          <Route exact path=\"/\">\r\n            <IngredientsConstructor/>\r\n          </Route>\r\n\r\n          <Route exact path=\"/ingredients/:id\">\r\n            <div className={appStyle.appWrapper}>\r\n              <IngredientDetails/>\r\n            </div>\r\n          </Route>\r\n\r\n          <Route exact path=\"/feed\">\r\n            <OrderTape/>\r\n          </Route>\r\n          <Route exact path=\"/feed/:id\">\r\n            <div className={appStyle.appWrapper}>\r\n              <OrderInfo showOrders=\"all\"/>\r\n            </div>\r\n          </Route>\r\n\r\n          <ProtectedRoute exact path=\"/login\" protectType=\"authorized\">\r\n            <Autorization/>\r\n          </ProtectedRoute>\r\n          <ProtectedRoute exact path=\"/register\" protectType=\"authorized\">\r\n            <Registration/>\r\n          </ProtectedRoute>\r\n          <ProtectedRoute exact path=\"/forgot-password\" protectType=\"authorized\">\r\n            <RecoveryPassword/>\r\n          </ProtectedRoute>\r\n          <ProtectedRoute exact path=\"/reset-password\" protectType=\"authorized\">\r\n            <ResetPassword/>\r\n          </ProtectedRoute>\r\n\r\n          <ProtectedRoute exact path=\"/profile\" protectType=\"nonAuthorized\">\r\n            <UserProfile/>\r\n          </ProtectedRoute>\r\n          <ProtectedRoute exact path=\"/profile/orders\" protectType=\"nonAuthorized\">\r\n            <OrderHistory/>\r\n          </ProtectedRoute>\r\n          <ProtectedRoute exact path=\"/profile/orders/:id\" protectType=\"nonAuthorized\">\r\n            <div className={appStyle.appWrapper}>\r\n              <OrderInfo showOrders=\"my\"/>\r\n            </div>\r\n          </ProtectedRoute>\r\n\r\n          <Route>\r\n            <EmptyPage404/>\r\n          </Route>\r\n        </Switch>\r\n      </main>\r\n      {\r\n        modalBackground && \r\n        (\r\n          <>\r\n            <Switch>\r\n              <Route exact path=\"/ingredients/:id\">\r\n                <Modal>\r\n                  <IngredientDetails/>\r\n                </Modal>\r\n              </Route>\r\n\r\n              <Route exact path=\"/feed/:id\">\r\n                <Modal>\r\n                  <OrderInfo showOrders=\"all\"/>\r\n                </Modal>\r\n              </Route>\r\n\r\n              <ProtectedRoute exact path=\"/start-order\" protectType=\"nonAuthorized\">\r\n                <Modal>\r\n                  <OrderDetails/>\r\n                </Modal>\r\n              </ProtectedRoute>\r\n\r\n              <ProtectedRoute exact path=\"/profile/orders/:id\" protectType=\"nonAuthorized\">\r\n                <Modal>\r\n                  <OrderInfo showOrders=\"my\"/>\r\n                </Modal>\r\n              </ProtectedRoute>\r\n            </Switch>\r\n          </>\r\n        )\r\n      }\r\n    </>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport {BrowserRouter as Router} from 'react-router-dom';\r\nimport {Provider} from 'react-redux';\r\nimport {configureStore} from '@reduxjs/toolkit';\r\nimport {rootReducer as reducer} from './services/reducers';\r\n\r\nimport {socketMiddleware} from './services/middlewares/socket-middleware';\r\n\r\nimport App from './components/app/app';\r\n\r\nimport './index.css';\r\n\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nexport const store = configureStore({\r\n  reducer,\r\n  middleware: getDefaultMiddleware => getDefaultMiddleware().concat(socketMiddleware)\r\n});\r\n\r\nexport type TDispatch = typeof store.dispatch;\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <Router>\r\n        <App/>\r\n      </Router>\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\nreportWebVitals();\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"ingredient-details_wrapper__1NyXJ\",\"title\":\"ingredient-details_title__30kE2\",\"image\":\"ingredient-details_image__2wYzY\",\"main\":\"ingredient-details_main__234jU\",\"details\":\"ingredient-details_details__3ttKf\",\"infoWrapper\":\"ingredient-details_infoWrapper__10jIK\",\"infoElement\":\"ingredient-details_infoElement__39Q81\",\"name\":\"ingredient-details_name__3h--x\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"orderTotal\":\"order-total_orderTotal__1Grrk\",\"numbersWrapper\":\"order-total_numbersWrapper__1rmsx\",\"ready\":\"order-total_ready__1RDwO\",\"readyWrapper\":\"order-total_readyWrapper__3krQx\",\"count\":\"order-total_count__1l3Qd\",\"item\":\"order-total_item__1GdH0\",\"readyColor\":\"order-total_readyColor__v5b1F\",\"itemsWrapper\":\"order-total_itemsWrapper__2ktld\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"order-details_wrapper__3gdMA\",\"number\":\"order-details_number__3YC3y\",\"title\":\"order-details_title__nmqhw\",\"image\":\"order-details_image__1mL34\",\"vektorSecond\":\"order-details_vektorSecond__2bpJn\",\"second\":\"order-details_second__23kGO\",\"vektorThird\":\"order-details_vektorThird__3fUvl\",\"third\":\"order-details_third__2orof\",\"vektorFirst\":\"order-details_vektorFirst__6H40P\",\"first\":\"order-details_first__4-Mz5\",\"done\":\"order-details_done__3Thj6\",\"details\":\"order-details_details__2ek3B\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"mainIngredientsWrapper\":\"burger-constructor_mainIngredientsWrapper__2X1ME\",\"summWrapper\":\"burger-constructor_summWrapper__1yd4m\",\"wrapper\":\"burger-constructor_wrapper__1-RHH\",\"itemWrapper\":\"burger-constructor_itemWrapper__20Qnb\",\"ingredient\":\"burger-constructor_ingredient__sbrMl\",\"summText\":\"burger-constructor_summText__4mE7w\",\"footerWrapper\":\"burger-constructor_footerWrapper__1XJiC\",\"emptyWrapper\":\"burger-constructor_emptyWrapper__Vhmyz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"mainWrapper\":\"order-tape_mainWrapper__VhPGQ\",\"wrapper\":\"order-tape_wrapper__3w-So\",\"title\":\"order-tape_title__emiF-\",\"mainBlock\":\"order-tape_mainBlock__qh7-U\",\"burgers\":\"order-tape_burgers__2r66y\",\"link\":\"order-tape_link__24UNb\",\"itemWrapper\":\"order-tape_itemWrapper__yW7JX\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"menuWrapper\":\"burger-ingredients_menuWrapper__3T6t2\",\"wrapper\":\"burger-ingredients_wrapper__TmxwH\",\"title\":\"burger-ingredients_title__aTorW\",\"tabs\":\"burger-ingredients_tabs__3ropk\",\"block\":\"burger-ingredients_block__3YWMR\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"mainWrapper\":\"order-history_mainWrapper__wr8Ci\",\"wrapper\":\"order-history_wrapper__3fSu_\",\"linksWrapper\":\"order-history_linksWrapper__23U-r\",\"burgers\":\"order-history_burgers__3vFpR\",\"link\":\"order-history_link__ZmWjg\",\"itemWrapper\":\"order-history_itemWrapper__YVb6S\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"mainProfileWrapper\":\"input-pages_mainProfileWrapper__-kB81\",\"profileWrapper\":\"input-pages_profileWrapper__2t2Xa\",\"inputsWrapper\":\"input-pages_inputsWrapper__2XW4_\",\"wrapper\":\"input-pages_wrapper__3Ib6G\",\"logo\":\"input-pages_logo__2xa4z\",\"title\":\"input-pages_title__338Jt\",\"inputWrapper\":\"input-pages_inputWrapper__3FLvL\",\"button\":\"input-pages_button__3MWAJ\",\"footer\":\"input-pages_footer__bcZPn\",\"footerInfo\":\"input-pages_footerInfo__YFHEq\",\"footerEnter\":\"input-pages_footerEnter__2yox4\",\"linksWrapper\":\"input-pages_linksWrapper__2Caer\",\"buttonsWrapper\":\"input-pages_buttonsWrapper__2j8yh\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"spinner\":\"confirm-button_spinner__nQJ9t\",\"top\":\"confirm-button_top__3rMoy\",\"top-cricle\":\"confirm-button_top-cricle__biM2v\",\"bottom\":\"confirm-button_bottom__1qK_C\",\"bottom-cricle\":\"confirm-button_bottom-cricle__1KW7c\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"mainWrapper\":\"app_mainWrapper__2G668\",\"appWrapper\":\"app_appWrapper__ltgTe\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"modal_main__3VkQe\",\"wrapper\":\"modal_wrapper__3Pq05\",\"close\":\"modal_close__1kHae\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ingredient\":\"product_ingredient__3SvI9\",\"costWrapper\":\"product_costWrapper__3Ptp5\",\"nameIngredient\":\"product_nameIngredient__PbbqW\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"info\":\"product-group_info__3kqOg\",\"ingredientWrapper\":\"product-group_ingredientWrapper__2iHXM\",\"btn\":\"product-group_btn__2nUyt\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"fillingIngredient\":\"burger-filling_fillingIngredient__GzD_k\",\"target\":\"burger-filling_target__20Znu\"};"],"sourceRoot":""}